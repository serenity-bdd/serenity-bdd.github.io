"use strict";(globalThis.webpackChunkserenity_users_guide=globalThis.webpackChunkserenity_users_guide||[]).push([[53],{6485(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"playwright/playwright_step_libraries","title":"Step Libraries","description":"Step Libraries are the bridge between your tests and Page Objects. They provide Serenity\'s rich reporting capabilities through @Step annotations while keeping your tests clean and readable.","source":"@site/docs/playwright/step-libraries.md","sourceDirName":"playwright","slug":"/playwright/playwright_step_libraries","permalink":"/docs/playwright/playwright_step_libraries","draft":false,"unlisted":false,"editUrl":"https://github.com/serenity-bdd/serenity-bdd.github.io/blob/master/docs/playwright/step-libraries.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"playwright_step_libraries","title":"Step Libraries","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Screenplay Pattern with Playwright","permalink":"/docs/playwright/playwright_screenplay"},"next":{"title":"Configuration","permalink":"/docs/playwright/playwright_configuration"}}');var r=t(4848),s=t(8453);const i={id:"playwright_step_libraries",title:"Step Libraries",sidebar_position:4},c="Step Libraries with Playwright",l={},o=[{value:"The Three-Layer Architecture",id:"the-three-layer-architecture",level:2},{value:"Creating Step Libraries",id:"creating-step-libraries",level:2},{value:"Basic Structure",id:"basic-structure",level:3},{value:"Using Step Libraries in Tests",id:"using-step-libraries-in-tests",level:3},{value:"The @Step Annotation",id:"the-step-annotation",level:2},{value:"Step Descriptions",id:"step-descriptions",level:3},{value:"Nested Steps",id:"nested-steps",level:3},{value:"Page-Aware Steps",id:"page-aware-steps",level:2},{value:"Screenshot Capture",id:"screenshot-capture",level:2},{value:"Automatic Screenshots",id:"automatic-screenshots",level:3},{value:"Manual Screenshots",id:"manual-screenshots",level:3},{value:"Organizing Step Libraries",id:"organizing-step-libraries",level:2},{value:"By Feature Area",id:"by-feature-area",level:3},{value:"By User Journey",id:"by-user-journey",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Keep Steps Focused",id:"1-keep-steps-focused",level:3},{value:"2. Use Business Language",id:"2-use-business-language",level:3},{value:"3. Handle State Carefully",id:"3-handle-state-carefully",level:3},{value:"4. Make Assertions Clear",id:"4-make-assertions-clear",level:3},{value:"5. Compose Higher-Level Steps",id:"5-compose-higher-level-steps",level:3}];function p(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"step-libraries-with-playwright",children:"Step Libraries with Playwright"})}),"\n",(0,r.jsxs)(n.p,{children:["Step Libraries are the bridge between your tests and Page Objects. They provide Serenity's rich reporting capabilities through ",(0,r.jsx)(n.code,{children:"@Step"})," annotations while keeping your tests clean and readable."]}),"\n",(0,r.jsx)(n.h2,{id:"the-three-layer-architecture",children:"The Three-Layer Architecture"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Test Class\n    \u2502  Uses @Steps to inject step libraries\n    \u2502  Focuses on business scenarios\n    \u25bc\nStep Library\n    \u2502  @Step methods appear in reports\n    \u2502  Orchestrates Page Object actions\n    \u25bc\nPage Object\n       Encapsulates locators\n       Handles page interactions\n"})}),"\n",(0,r.jsx)(n.h2,{id:"creating-step-libraries",children:"Creating Step Libraries"}),"\n",(0,r.jsx)(n.h3,{id:"basic-structure",children:"Basic Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public class ShoppingCartSteps {\n\n    private ShoppingCartPage cartPage;\n\n    // Initialize Page Object when needed\n    private void ensurePageObject(Page page) {\n        if (cartPage == null) {\n            cartPage = new ShoppingCartPage(page);\n        }\n    }\n\n    @Step("Add product \'{1}\' to cart")\n    public void addProductToCart(Page page, String productName) {\n        ensurePageObject(page);\n        cartPage.addProduct(productName);\n    }\n\n    @Step("Verify cart contains {1} items")\n    public void verifyCartItemCount(Page page, int expectedCount) {\n        ensurePageObject(page);\n        assertThat(cartPage.getItemCount())\n            .as("Cart item count")\n            .isEqualTo(expectedCount);\n    }\n\n    @Step("Proceed to checkout")\n    public void proceedToCheckout(Page page) {\n        ensurePageObject(page);\n        cartPage.clickCheckout();\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"using-step-libraries-in-tests",children:"Using Step Libraries in Tests"}),"\n",(0,r.jsxs)(n.p,{children:["Inject step libraries using the ",(0,r.jsx)(n.code,{children:"@Steps"})," annotation:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@ExtendWith(SerenityJUnit5Extension.class)\nclass ShoppingTest {\n\n    @Steps\n    ShoppingCartSteps cart;\n\n    @Steps\n    ProductSteps products;\n\n    @Steps\n    CheckoutSteps checkout;\n\n    private Page page;\n\n    @Test\n    void shouldCompleteAPurchase() {\n        products.browseCategory(page, "Electronics");\n        products.selectProduct(page, "Laptop Pro");\n        cart.addProductToCart(page, "Laptop Pro");\n        cart.verifyCartItemCount(page, 1);\n        cart.proceedToCheckout(page);\n        checkout.completeOrder(page);\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"the-step-annotation",children:"The @Step Annotation"}),"\n",(0,r.jsx)(n.h3,{id:"step-descriptions",children:"Step Descriptions"}),"\n",(0,r.jsx)(n.p,{children:"Use parameter placeholders in step descriptions:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Step("Search for \'{1}\'")\npublic void searchFor(Page page, String term) { ... }\n\n@Step("Add {1} units of \'{2}\' to cart")\npublic void addToCart(Page page, int quantity, String product) { ... }\n\n@Step("Verify total is ${1}")\npublic void verifyTotal(Page page, BigDecimal expectedTotal) { ... }\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Parameter indices are zero-based: ",(0,r.jsx)(n.code,{children:"{0}"})," is the first parameter, ",(0,r.jsx)(n.code,{children:"{1}"})," is the second, etc."]}),"\n",(0,r.jsx)(n.h3,{id:"nested-steps",children:"Nested Steps"}),"\n",(0,r.jsx)(n.p,{children:"Steps can call other steps for hierarchical reporting:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Step("Complete checkout with credit card")\npublic void completeCheckoutWithCreditCard(Page page, CreditCard card) {\n    enterBillingAddress(page, card.getBillingAddress());\n    enterCardDetails(page, card);\n    submitPayment(page);\n}\n\n@Step("Enter billing address")\npublic void enterBillingAddress(Page page, Address address) {\n    checkoutPage.enterAddress(address);\n}\n\n@Step("Enter card details")\npublic void enterCardDetails(Page page, CreditCard card) {\n    checkoutPage.enterCardNumber(card.getNumber());\n    checkoutPage.enterExpiry(card.getExpiry());\n    checkoutPage.enterCvv(card.getCvv());\n}\n\n@Step("Submit payment")\npublic void submitPayment(Page page) {\n    checkoutPage.clickPay();\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"page-aware-steps",children:"Page-Aware Steps"}),"\n",(0,r.jsxs)(n.p,{children:["For cleaner step signatures, use ",(0,r.jsx)(n.code,{children:"PlaywrightSerenity.getCurrentPage()"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public class NavigationSteps {\n\n    @Step("Navigate to {0}")\n    public void navigateTo(String url) {\n        Page page = PlaywrightSerenity.getCurrentPage();\n        page.navigate(url);\n    }\n\n    @Step("Refresh the page")\n    public void refreshPage() {\n        PlaywrightSerenity.getCurrentPage().reload();\n    }\n\n    @Step("Go back")\n    public void goBack() {\n        PlaywrightSerenity.getCurrentPage().goBack();\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Usage in tests:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Test\nvoid shouldNavigateBetweenPages() {\n    // No need to pass page parameter\n    navigation.navigateTo("https://example.com");\n    navigation.refreshPage();\n    navigation.goBack();\n}\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"caution",children:(0,r.jsxs)(n.p,{children:["When using ",(0,r.jsx)(n.code,{children:"getCurrentPage()"}),", ensure you've registered the page with ",(0,r.jsx)(n.code,{children:"PlaywrightSerenity.registerPage(page)"})," before calling any steps."]})}),"\n",(0,r.jsx)(n.h2,{id:"screenshot-capture",children:"Screenshot Capture"}),"\n",(0,r.jsx)(n.h3,{id:"automatic-screenshots",children:"Automatic Screenshots"}),"\n",(0,r.jsxs)(n.p,{children:["Screenshots are captured automatically after each ",(0,r.jsx)(n.code,{children:"@Step"})," method completes. This is handled by the ",(0,r.jsx)(n.code,{children:"PlaywrightStepListener"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"manual-screenshots",children:"Manual Screenshots"}),"\n",(0,r.jsx)(n.p,{children:"Trigger additional screenshots at specific points:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Step("Capture current state")\npublic void captureCurrentState(Page page) {\n    // Do some actions\n    performComplexAction(page);\n\n    // Capture a screenshot manually\n    PlaywrightSerenity.takeScreenshot();\n\n    // Continue with more actions\n    performAnotherAction(page);\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"organizing-step-libraries",children:"Organizing Step Libraries"}),"\n",(0,r.jsx)(n.h3,{id:"by-feature-area",children:"By Feature Area"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"steps/\n\u251c\u2500\u2500 authentication/\n\u2502   \u251c\u2500\u2500 LoginSteps.java\n\u2502   \u2514\u2500\u2500 RegistrationSteps.java\n\u251c\u2500\u2500 shopping/\n\u2502   \u251c\u2500\u2500 ProductSteps.java\n\u2502   \u251c\u2500\u2500 CartSteps.java\n\u2502   \u2514\u2500\u2500 CheckoutSteps.java\n\u2514\u2500\u2500 account/\n    \u251c\u2500\u2500 ProfileSteps.java\n    \u2514\u2500\u2500 OrderHistorySteps.java\n"})}),"\n",(0,r.jsx)(n.h3,{id:"by-user-journey",children:"By User Journey"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"steps/\n\u251c\u2500\u2500 BuyerSteps.java      // All steps for a buyer persona\n\u251c\u2500\u2500 SellerSteps.java     // All steps for a seller persona\n\u2514\u2500\u2500 AdminSteps.java      // All steps for an admin\n"})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"1-keep-steps-focused",children:"1. Keep Steps Focused"}),"\n",(0,r.jsx)(n.p,{children:"Each step should represent one logical user action:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// \u274c Bad: Too many things in one step\n@Step("Login and add product to cart")\npublic void loginAndAddToCart(Page page, User user, String product) {\n    // Too much happening here\n}\n\n// \u2705 Good: Focused, single-purpose steps\n@Step("Login as {1}")\npublic void login(Page page, User user) { ... }\n\n@Step("Add \'{1}\' to cart")\npublic void addToCart(Page page, String product) { ... }\n'})}),"\n",(0,r.jsx)(n.h3,{id:"2-use-business-language",children:"2. Use Business Language"}),"\n",(0,r.jsx)(n.p,{children:"Steps should read like natural language:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// \u274c Bad: Technical language\n@Step("Click submit button")\n@Step("Fill input field with value")\n\n// \u2705 Good: Business language\n@Step("Submit the order")\n@Step("Enter shipping address")\n'})}),"\n",(0,r.jsx)(n.h3,{id:"3-handle-state-carefully",children:"3. Handle State Carefully"}),"\n",(0,r.jsx)(n.p,{children:"Be mindful of state between step calls:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public class AccountSteps {\n    private AccountPage accountPage;\n    private User currentUser;  // Track state when needed\n\n    @Step("Login as {1}")\n    public void loginAs(Page page, User user) {\n        // Store for later steps\n        this.currentUser = user;\n        loginPage.loginAs(user.getEmail(), user.getPassword());\n    }\n\n    @Step("Verify welcome message shows user\'s name")\n    public void verifyWelcomeMessage(Page page) {\n        assertThat(accountPage.getWelcomeMessage())\n            .contains(currentUser.getFirstName());\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"4-make-assertions-clear",children:"4. Make Assertions Clear"}),"\n",(0,r.jsx)(n.p,{children:"Include descriptive assertions in verification steps:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Step("Verify order total is ${1}")\npublic void verifyOrderTotal(Page page, BigDecimal expectedTotal) {\n    BigDecimal actualTotal = checkoutPage.getOrderTotal();\n    assertThat(actualTotal)\n        .as("Order total")\n        .isEqualByComparingTo(expectedTotal);\n}\n\n@Step("Verify error message is displayed")\npublic void verifyErrorMessageDisplayed(Page page, String expectedMessage) {\n    assertThat(errorPage.getMessage())\n        .as("Error message")\n        .containsIgnoringCase(expectedMessage);\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"5-compose-higher-level-steps",children:"5. Compose Higher-Level Steps"}),"\n",(0,r.jsx)(n.p,{children:"Build complex workflows from simpler steps:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Step("Complete guest checkout")\npublic void completeGuestCheckout(Page page, Address address, CreditCard card) {\n    enterShippingAddress(page, address);\n    selectShippingMethod(page, "Standard");\n    enterPaymentDetails(page, card);\n    confirmOrder(page);\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"This creates a hierarchical report showing both the high-level step and its constituent parts."})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},8453(e,n,t){t.d(n,{R:()=>i,x:()=>c});var a=t(6540);const r={},s=a.createContext(r);function i(e){const n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);