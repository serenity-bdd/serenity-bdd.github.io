"use strict";(self.webpackChunkserenity_users_guide=self.webpackChunkserenity_users_guide||[]).push([[1219],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=a.createContext({}),u=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(o.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=u(n),m=r,g=d["".concat(o,".").concat(m)]||d[m]||p[m]||i;return n?a.createElement(g,l(l({ref:t},c),{},{components:n})):a.createElement(g,l({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=d;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s.mdxType="string"==typeof e?e:r,l[1]=s;for(var u=2;u<i;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3086:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>l,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>o});var a=n(7462),r=(n(7294),n(3905));const i={id:"parallel-execution",title:"Running JUnit 5 Tests in Parallel",sidebar_position:2},l="Running JUnit 5 Serenity Tests in Parallel",s={unversionedId:"junit5/parallel-execution",id:"junit5/parallel-execution",isDocsHomePage:!1,title:"Running JUnit 5 Tests in Parallel",description:"Running JUnit 5 tests in parallel can significantly reduce test execution time. This guide explains how to configure and optimize parallel execution for Serenity BDD tests using JUnit 5.",source:"@site/docs/junit5/parallel-execution.md",sourceDirName:"junit5",slug:"/junit5/parallel-execution",permalink:"/docs/junit5/parallel-execution",editUrl:"https://github.com/serenity-bdd/serenity-bdd.github.io/blob/master/docs/junit5/parallel-execution.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"parallel-execution",title:"Running JUnit 5 Tests in Parallel",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"JUnit 5 with Serenity BDD",permalink:"/docs/junit5/junit5-tests"},next:{title:"Cucumber with JUnit 5",permalink:"/docs/cucumber/cucumber-junit5"}},o=[{value:"Overview",id:"overview",children:[]},{value:"Prerequisites",id:"prerequisites",children:[]},{value:"Basic Configuration",id:"basic-configuration",children:[{value:"Step 1: Enable Parallel Execution",id:"step-1-enable-parallel-execution",children:[]},{value:"Step 2: Configure Execution Mode",id:"step-2-configure-execution-mode",children:[]},{value:"Step 3: Configure Execution Strategy",id:"step-3-configure-execution-strategy",children:[]}]},{value:"Execution Modes",id:"execution-modes",children:[{value:"Concurrent Mode",id:"concurrent-mode",children:[]},{value:"Same Thread Mode",id:"same-thread-mode",children:[]},{value:"Mixed Mode",id:"mixed-mode",children:[]}]},{value:"Execution Strategies",id:"execution-strategies",children:[{value:"Dynamic Strategy (Recommended)",id:"dynamic-strategy-recommended",children:[]},{value:"Fixed Strategy",id:"fixed-strategy",children:[]},{value:"Custom Strategy",id:"custom-strategy",children:[]}]},{value:"Controlling Parallelism at Class/Method Level",id:"controlling-parallelism-at-classmethod-level",children:[{value:"Per-Class Configuration",id:"per-class-configuration",children:[]},{value:"Force Sequential Execution",id:"force-sequential-execution",children:[]},{value:"Method-Level Control",id:"method-level-control",children:[]}]},{value:"Resource Locks",id:"resource-locks",children:[{value:"Common Resource Locks",id:"common-resource-locks",children:[]}]},{value:"Thread Safety with Serenity",id:"thread-safety-with-serenity",children:[{value:"WebDriver Management",id:"webdriver-management",children:[]},{value:"Step Libraries",id:"step-libraries",children:[]},{value:"Avoid Shared Mutable State",id:"avoid-shared-mutable-state",children:[]}]},{value:"Complete Configuration Example",id:"complete-configuration-example",children:[{value:"Comprehensive junit-platform.properties",id:"comprehensive-junit-platformproperties",children:[]}]},{value:"Maven Configuration",id:"maven-configuration",children:[{value:"Failsafe Plugin",id:"failsafe-plugin",children:[]},{value:"Running from Command Line",id:"running-from-command-line",children:[]}]},{value:"Gradle Configuration",id:"gradle-configuration",children:[]},{value:"Performance Optimization",id:"performance-optimization",children:[{value:"1. Choose the Right Strategy",id:"1-choose-the-right-strategy",children:[]},{value:"2. Monitor Resource Usage",id:"2-monitor-resource-usage",children:[]},{value:"3. Optimize Test Design",id:"3-optimize-test-design",children:[]},{value:"4. Balance Thread Count",id:"4-balance-thread-count",children:[]}]},{value:"Debugging Parallel Tests",id:"debugging-parallel-tests",children:[{value:"Temporarily Disable Parallelism",id:"temporarily-disable-parallelism",children:[]},{value:"Run Single Test Class",id:"run-single-test-class",children:[]},{value:"Enable Verbose Logging",id:"enable-verbose-logging",children:[]}]},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",children:[{value:"Issue 1: Flaky Tests",id:"issue-1-flaky-tests",children:[]},{value:"Issue 2: Resource Exhaustion",id:"issue-2-resource-exhaustion",children:[]},{value:"Issue 3: WebDriver Issues",id:"issue-3-webdriver-issues",children:[]},{value:"Issue 4: Database Locks",id:"issue-4-database-locks",children:[]}]},{value:"Best Practices",id:"best-practices",children:[{value:"1. Start Small",id:"1-start-small",children:[]},{value:"2. Isolate Test Data",id:"2-isolate-test-data",children:[]},{value:"3. Use Tags for Selective Parallelism",id:"3-use-tags-for-selective-parallelism",children:[]},{value:"4. Clean Up Resources",id:"4-clean-up-resources",children:[]},{value:"5. Document Thread Safety",id:"5-document-thread-safety",children:[]}]},{value:"Measuring Performance",id:"measuring-performance",children:[{value:"Before Parallel Execution",id:"before-parallel-execution",children:[]},{value:"After Parallel Execution (8 threads)",id:"after-parallel-execution-8-threads",children:[]}]},{value:"Next Steps",id:"next-steps",children:[]},{value:"Additional Resources",id:"additional-resources",children:[]}],u={toc:o};function c({components:e,...t}){return(0,r.kt)("wrapper",(0,a.Z)({},u,t,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"running-junit-5-serenity-tests-in-parallel"},"Running JUnit 5 Serenity Tests in Parallel"),(0,r.kt)("p",null,"Running JUnit 5 tests in parallel can significantly reduce test execution time. This guide explains how to configure and optimize parallel execution for Serenity BDD tests using JUnit 5."),(0,r.kt)("h2",{id:"overview"},"Overview"),(0,r.kt)("p",null,"JUnit 5 (Jupiter) has built-in support for parallel test execution. When combined with Serenity BDD, you can run test methods and test classes concurrently, taking advantage of multi-core processors."),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Parallel Execution Benefits")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"On a machine with 8 cores, parallel execution can reduce test time from 30 minutes to 5-8 minutes or less."))),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"JUnit 5 (Jupiter)"),(0,r.kt)("li",{parentName:"ul"},"Serenity BDD 3.6.0 or higher"),(0,r.kt)("li",{parentName:"ul"},"Thread-safe test code"),(0,r.kt)("li",{parentName:"ul"},"Sufficient system resources (CPU, RAM)")),(0,r.kt)("h2",{id:"basic-configuration"},"Basic Configuration"),(0,r.kt)("h3",{id:"step-1-enable-parallel-execution"},"Step 1: Enable Parallel Execution"),(0,r.kt)("p",null,"Create or update ",(0,r.kt)("inlineCode",{parentName:"p"},"junit-platform.properties")," in ",(0,r.kt)("inlineCode",{parentName:"p"},"src/test/resources"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"# Enable parallel execution\njunit.jupiter.execution.parallel.enabled=true\n")),(0,r.kt)("h3",{id:"step-2-configure-execution-mode"},"Step 2: Configure Execution Mode"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"# Run test classes in parallel\njunit.jupiter.execution.parallel.mode.default=concurrent\n\n# Run test classes in parallel\njunit.jupiter.execution.parallel.mode.classes.default=concurrent\n")),(0,r.kt)("h3",{id:"step-3-configure-execution-strategy"},"Step 3: Configure Execution Strategy"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"# Use dynamic strategy (recommended)\njunit.jupiter.execution.parallel.config.strategy=dynamic\njunit.jupiter.execution.parallel.config.dynamic.factor=1.0\n")),(0,r.kt)("h2",{id:"execution-modes"},"Execution Modes"),(0,r.kt)("h3",{id:"concurrent-mode"},"Concurrent Mode"),(0,r.kt)("p",null,"Tests run in parallel:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"junit.jupiter.execution.parallel.mode.default=concurrent\njunit.jupiter.execution.parallel.mode.classes.default=concurrent\n")),(0,r.kt)("h3",{id:"same-thread-mode"},"Same Thread Mode"),(0,r.kt)("p",null,"Tests run sequentially:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"junit.jupiter.execution.parallel.mode.default=same_thread\njunit.jupiter.execution.parallel.mode.classes.default=same_thread\n")),(0,r.kt)("h3",{id:"mixed-mode"},"Mixed Mode"),(0,r.kt)("p",null,"Run classes in parallel but methods within a class sequentially:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"# Classes in parallel\njunit.jupiter.execution.parallel.mode.classes.default=concurrent\n\n# Methods in same class run sequentially\njunit.jupiter.execution.parallel.mode.default=same_thread\n")),(0,r.kt)("h2",{id:"execution-strategies"},"Execution Strategies"),(0,r.kt)("h3",{id:"dynamic-strategy-recommended"},"Dynamic Strategy (Recommended)"),(0,r.kt)("p",null,"Automatically determines thread count based on available processors:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"junit.jupiter.execution.parallel.config.strategy=dynamic\njunit.jupiter.execution.parallel.config.dynamic.factor=1.0\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Factor calculation:")," ",(0,r.kt)("inlineCode",{parentName:"p"},"threads = processors \xd7 factor")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Examples")," (on an 8-core machine):"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Factor ",(0,r.kt)("inlineCode",{parentName:"li"},"1.0")," = 8 threads (recommended)"),(0,r.kt)("li",{parentName:"ul"},"Factor ",(0,r.kt)("inlineCode",{parentName:"li"},"0.5")," = 4 threads"),(0,r.kt)("li",{parentName:"ul"},"Factor ",(0,r.kt)("inlineCode",{parentName:"li"},"2.0")," = 16 threads")),(0,r.kt)("h3",{id:"fixed-strategy"},"Fixed Strategy"),(0,r.kt)("p",null,"Uses a specified number of threads:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"junit.jupiter.execution.parallel.config.strategy=fixed\njunit.jupiter.execution.parallel.config.fixed.parallelism=4\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Use when:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"You need consistent thread counts"),(0,r.kt)("li",{parentName:"ul"},"Running on shared CI/CD infrastructure"),(0,r.kt)("li",{parentName:"ul"},"Debugging parallel execution issues")),(0,r.kt)("h3",{id:"custom-strategy"},"Custom Strategy"),(0,r.kt)("p",null,"Implement your own strategy:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"junit.jupiter.execution.parallel.config.strategy=custom\njunit.jupiter.execution.parallel.config.custom.class=com.example.MyParallelStrategy\n")),(0,r.kt)("h2",{id:"controlling-parallelism-at-classmethod-level"},"Controlling Parallelism at Class/Method Level"),(0,r.kt)("h3",{id:"per-class-configuration"},"Per-Class Configuration"),(0,r.kt)("p",null,"Use ",(0,r.kt)("inlineCode",{parentName:"p"},"@Execution")," annotation to control parallelism:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"import org.junit.jupiter.api.parallel.Execution;\nimport org.junit.jupiter.api.parallel.ExecutionMode;\n\n@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.CONCURRENT)  // Run this class's methods in parallel\nclass FastTests {\n\n    @Test\n    void test1() { }\n\n    @Test\n    void test2() { }\n\n    @Test\n    void test3() { }\n}\n")),(0,r.kt)("h3",{id:"force-sequential-execution"},"Force Sequential Execution"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.SAME_THREAD)  // Run sequentially\nclass DatabaseMigrationTests {\n\n    @Test\n    void migration1() { }\n\n    @Test\n    void migration2() { }  // Must run after migration1\n}\n")),(0,r.kt)("h3",{id:"method-level-control"},"Method-Level Control"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@ExtendWith(SerenityJUnit5Extension.class)\nclass MixedTests {\n\n    @Test\n    @Execution(ExecutionMode.CONCURRENT)\n    void canRunInParallel() { }\n\n    @Test\n    @Execution(ExecutionMode.SAME_THREAD)\n    void mustRunSequentially() { }\n}\n")),(0,r.kt)("h2",{id:"resource-locks"},"Resource Locks"),(0,r.kt)("p",null,"Prevent concurrent access to shared resources:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'import org.junit.jupiter.api.parallel.ResourceLock;\n\n@ExtendWith(SerenityJUnit5Extension.class)\nclass SharedResourceTests {\n\n    @Test\n    @ResourceLock("database")\n    void accessDatabase1() {\n        // Exclusive access to database\n    }\n\n    @Test\n    @ResourceLock("database")\n    void accessDatabase2() {\n        // Will wait for accessDatabase1 to complete\n    }\n\n    @Test\n    @ResourceLock(value = "database", mode = READ)\n    void readFromDatabase() {\n        // Read-only access - can run concurrently with other reads\n    }\n}\n')),(0,r.kt)("h3",{id:"common-resource-locks"},"Common Resource Locks"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'import static org.junit.jupiter.api.parallel.Resources.*;\n\n@Test\n@ResourceLock(SYSTEM_PROPERTIES)\nvoid modifiesSystemProperties() { }\n\n@Test\n@ResourceLock(SYSTEM_OUT)\nvoid writesToSystemOut() { }\n\n@Test\n@ResourceLock("my-custom-resource")\nvoid accessesCustomResource() { }\n')),(0,r.kt)("h2",{id:"thread-safety-with-serenity"},"Thread Safety with Serenity"),(0,r.kt)("h3",{id:"webdriver-management"},"WebDriver Management"),(0,r.kt)("p",null,"Serenity's ",(0,r.kt)("inlineCode",{parentName:"p"},"@Managed")," WebDriver is automatically thread-safe:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.CONCURRENT)\nclass WebTests {\n\n    @Managed(driver = "chrome", options = "headless")\n    WebDriver driver;  // Each thread gets its own instance\n\n    @Test\n    void test1() {\n        driver.get("https://example.com");\n        // Thread-safe\n    }\n\n    @Test\n    void test2() {\n        driver.get("https://example.com/other");\n        // Independent WebDriver instance\n    }\n}\n')),(0,r.kt)("h3",{id:"step-libraries"},"Step Libraries"),(0,r.kt)("p",null,"Step libraries are thread-safe when properly used:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.CONCURRENT)\nclass CheckoutTests {\n\n    @Steps\n    CartSteps cart;  // Thread-safe - instance per thread\n\n    @Test\n    void addToCart() {\n        cart.addProduct("Product1");\n    }\n\n    @Test\n    void removeFromCart() {\n        cart.addProduct("Product2");\n        cart.removeProduct("Product2");\n    }\n}\n')),(0,r.kt)("h3",{id:"avoid-shared-mutable-state"},"Avoid Shared Mutable State"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'// \u274c BAD - Not thread-safe\n@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.CONCURRENT)\nclass BadTests {\n\n    private String sharedData;  // Shared mutable state!\n\n    @Test\n    void test1() {\n        sharedData = "test1";  // Race condition!\n    }\n\n    @Test\n    void test2() {\n        sharedData = "test2";  // Race condition!\n    }\n}\n\n// \u2705 GOOD - Thread-safe\n@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.CONCURRENT)\nclass GoodTests {\n\n    @Test\n    void test1() {\n        String localData = "test1";  // Local variable - thread-safe\n        // Use localData\n    }\n\n    @Test\n    void test2() {\n        String localData = "test2";  // Independent\n        // Use localData\n    }\n}\n')),(0,r.kt)("h2",{id:"complete-configuration-example"},"Complete Configuration Example"),(0,r.kt)("h3",{id:"comprehensive-junit-platformproperties"},"Comprehensive junit-platform.properties"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"# ==========================================\n# Parallel Execution\n# ==========================================\njunit.jupiter.execution.parallel.enabled=true\njunit.jupiter.execution.parallel.mode.default=concurrent\njunit.jupiter.execution.parallel.mode.classes.default=concurrent\n\n# ==========================================\n# Execution Strategy\n# ==========================================\njunit.jupiter.execution.parallel.config.strategy=dynamic\njunit.jupiter.execution.parallel.config.dynamic.factor=1.0\n\n# Alternative: Fixed strategy\n# junit.jupiter.execution.parallel.config.strategy=fixed\n# junit.jupiter.execution.parallel.config.fixed.parallelism=4\n# junit.jupiter.execution.parallel.config.fixed.max-pool-size=8\n\n# ==========================================\n# Test Instance Lifecycle\n# ==========================================\njunit.jupiter.testinstance.lifecycle.default=per_method\n\n# ==========================================\n# Test Discovery\n# ==========================================\njunit.jupiter.testclass.order.default=org.junit.jupiter.api.ClassOrderer$Random\n\n# ==========================================\n# Display Names\n# ==========================================\njunit.jupiter.displayname.generator.default=org.junit.jupiter.api.DisplayNameGenerator$ReplaceUnderscores\n")),(0,r.kt)("h2",{id:"maven-configuration"},"Maven Configuration"),(0,r.kt)("h3",{id:"failsafe-plugin"},"Failsafe Plugin"),(0,r.kt)("p",null,"Configure Maven Failsafe plugin for parallel execution:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"<plugin>\n    <groupId>org.apache.maven.plugins</groupId>\n    <artifactId>maven-failsafe-plugin</artifactId>\n    <version>3.0.0</version>\n    <configuration>\n        \x3c!-- Enable JUnit 5 --\x3e\n        <includes>\n            <include>**/*Test.java</include>\n            <include>**/*Tests.java</include>\n        </includes>\n\n        \x3c!-- System properties --\x3e\n        <systemPropertyVariables>\n            <webdriver.driver>${webdriver.driver}</webdriver.driver>\n            <environment>${environment}</environment>\n        </systemPropertyVariables>\n\n        \x3c!-- Increase memory for parallel execution --\x3e\n        <argLine>-Xmx2g</argLine>\n    </configuration>\n    <executions>\n        <execution>\n            <goals>\n                <goal>integration-test</goal>\n                <goal>verify</goal>\n            </goals>\n        </execution>\n    </executions>\n</plugin>\n")),(0,r.kt)("h3",{id:"running-from-command-line"},"Running from Command Line"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# Run all tests in parallel\nmvn clean verify\n\n# Override parallelism\nmvn clean verify -Djunit.jupiter.execution.parallel.config.fixed.parallelism=8\n\n# Disable parallel execution\nmvn clean verify -Djunit.jupiter.execution.parallel.enabled=false\n")),(0,r.kt)("h2",{id:"gradle-configuration"},"Gradle Configuration"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-groovy"},"test {\n    useJUnitPlatform()\n\n    // Enable parallel execution\n    maxParallelForks = Runtime.runtime.availableProcessors()\n\n    // Increase memory\n    minHeapSize = \"512m\"\n    maxHeapSize = \"2g\"\n\n    // System properties\n    systemProperty 'junit.jupiter.execution.parallel.enabled', 'true'\n    systemProperty 'junit.jupiter.execution.parallel.config.strategy', 'dynamic'\n    systemProperty 'junit.jupiter.execution.parallel.config.dynamic.factor', '1.0'\n}\n")),(0,r.kt)("h2",{id:"performance-optimization"},"Performance Optimization"),(0,r.kt)("h3",{id:"1-choose-the-right-strategy"},"1. Choose the Right Strategy"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Small test suites")," (<30 tests):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"junit.jupiter.execution.parallel.config.strategy=fixed\njunit.jupiter.execution.parallel.config.fixed.parallelism=2\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Medium test suites")," (30-100 tests):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"junit.jupiter.execution.parallel.config.strategy=dynamic\njunit.jupiter.execution.parallel.config.dynamic.factor=1.0\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Large test suites")," (>100 tests):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"junit.jupiter.execution.parallel.config.strategy=dynamic\njunit.jupiter.execution.parallel.config.dynamic.factor=0.75\n")),(0,r.kt)("h3",{id:"2-monitor-resource-usage"},"2. Monitor Resource Usage"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# Monitor while tests run\ntop\nhtop\njconsole\n")),(0,r.kt)("p",null,"Watch for:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"CPU"),": Should be near 100% utilization"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Memory"),": Each browser instance uses ~200-500MB RAM"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Threads"),": Should match your parallelism setting")),(0,r.kt)("h3",{id:"3-optimize-test-design"},"3. Optimize Test Design"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"// \u2705 GOOD - Fast, focused tests\n@Test\nvoid shouldCalculateTotal() {\n    // No external dependencies, runs quickly\n    assertThat(calculator.add(2, 3)).isEqualTo(5);\n}\n\n// \u26a0\ufe0f SLOW - Consider optimization\n@Test\nvoid shouldProcessLargeDataset() {\n    // Process 10000 records - consider using smaller dataset\n}\n")),(0,r.kt)("h3",{id:"4-balance-thread-count"},"4. Balance Thread Count"),(0,r.kt)("p",null,"Too few threads:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"# Underutilizing CPU\njunit.jupiter.execution.parallel.config.dynamic.factor=0.25\n")),(0,r.kt)("p",null,"Too many threads:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"# May cause resource exhaustion\njunit.jupiter.execution.parallel.config.dynamic.factor=4.0\n")),(0,r.kt)("p",null,"Optimal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"# Matches CPU cores\njunit.jupiter.execution.parallel.config.dynamic.factor=1.0\n")),(0,r.kt)("h2",{id:"debugging-parallel-tests"},"Debugging Parallel Tests"),(0,r.kt)("h3",{id:"temporarily-disable-parallelism"},"Temporarily Disable Parallelism"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"junit.jupiter.execution.parallel.enabled=false\n")),(0,r.kt)("p",null,"Or via command line:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mvn verify -Djunit.jupiter.execution.parallel.enabled=false\n")),(0,r.kt)("h3",{id:"run-single-test-class"},"Run Single Test Class"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mvn test -Dtest=MyTestClass\n")),(0,r.kt)("h3",{id:"enable-verbose-logging"},"Enable Verbose Logging"),(0,r.kt)("p",null,"Add to ",(0,r.kt)("inlineCode",{parentName:"p"},"junit-platform.properties"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"# Show which thread runs which test\njunit.platform.output.capture.stdout=true\njunit.platform.output.capture.stderr=true\n")),(0,r.kt)("p",null,"In your test:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@BeforeEach\nvoid logThread() {\n    System.out.println("Running on: " + Thread.currentThread().getName());\n}\n')),(0,r.kt)("h2",{id:"common-issues-and-solutions"},"Common Issues and Solutions"),(0,r.kt)("h3",{id:"issue-1-flaky-tests"},"Issue 1: Flaky Tests"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Symptoms:")," Tests pass individually but fail in parallel"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solutions:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Check for shared mutable state"),(0,r.kt)("li",{parentName:"ul"},"Verify test data isolation"),(0,r.kt)("li",{parentName:"ul"},"Review resource locking"),(0,r.kt)("li",{parentName:"ul"},"Add proper synchronization")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"// Problem: Shared state\nprivate static int counter = 0;  // \u274c Not thread-safe\n\n@Test\nvoid incrementCounter() {\n    counter++;  // Race condition\n}\n\n// Solution: Use atomic types or local variables\nprivate static AtomicInteger counter = new AtomicInteger(0);  // \u2705 Thread-safe\n\n@Test\nvoid incrementCounter() {\n    counter.incrementAndGet();\n}\n")),(0,r.kt)("h3",{id:"issue-2-resource-exhaustion"},"Issue 2: Resource Exhaustion"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Symptoms:")," Tests slow down or fail after some time"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solutions:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Reduce thread count"),(0,r.kt)("li",{parentName:"ul"},"Increase JVM heap size"),(0,r.kt)("li",{parentName:"ul"},"Check for resource leaks"),(0,r.kt)("li",{parentName:"ul"},"Monitor system resources")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- Increase heap size --\x3e\n<argLine>-Xmx4g</argLine>\n")),(0,r.kt)("h3",{id:"issue-3-webdriver-issues"},"Issue 3: WebDriver Issues"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Symptoms:")," Browser instances multiply or don't close"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solutions:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Use ",(0,r.kt)("inlineCode",{parentName:"li"},"@Managed")," WebDriver (Serenity handles lifecycle)"),(0,r.kt)("li",{parentName:"ul"},"Ensure proper cleanup in ",(0,r.kt)("inlineCode",{parentName:"li"},"@AfterEach")),(0,r.kt)("li",{parentName:"ul"},"Limit concurrent browser instances")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"// \u2705 Serenity manages lifecycle\n@Managed\nWebDriver driver;\n\n// \u274c Don't manage manually in parallel tests\nWebDriver driver = new ChromeDriver();  // Memory leak risk\n")),(0,r.kt)("h3",{id:"issue-4-database-locks"},"Issue 4: Database Locks"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Symptoms:")," Tests timeout waiting for database"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Solutions:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Use resource locks"),(0,r.kt)("li",{parentName:"ul"},"Isolate test data"),(0,r.kt)("li",{parentName:"ul"},"Use in-memory database for tests")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\n@ResourceLock("database")\nvoid modifiesDatabase() {\n    // Exclusive database access\n}\n')),(0,r.kt)("h2",{id:"best-practices"},"Best Practices"),(0,r.kt)("h3",{id:"1-start-small"},"1. Start Small"),(0,r.kt)("p",null,"Begin with 2-4 threads and gradually increase:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"junit.jupiter.execution.parallel.config.strategy=fixed\njunit.jupiter.execution.parallel.config.fixed.parallelism=2\n")),(0,r.kt)("h3",{id:"2-isolate-test-data"},"2. Isolate Test Data"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@ExtendWith(SerenityJUnit5Extension.class)\nclass UserTests {\n\n    @Test\n    void createUser() {\n        String uniqueId = UUID.randomUUID().toString();\n        User user = createTestUser("user_" + uniqueId);\n        // Test with unique user\n    }\n}\n')),(0,r.kt)("h3",{id:"3-use-tags-for-selective-parallelism"},"3. Use Tags for Selective Parallelism"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\n@Tag("parallel")\nvoid canRunInParallel() { }\n\n@Test\n@Tag("serial")\n@Execution(ExecutionMode.SAME_THREAD)\nvoid mustRunSequentially() { }\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"# Run only parallel tests\njunit.jupiter.includeTags=parallel\n")),(0,r.kt)("h3",{id:"4-clean-up-resources"},"4. Clean Up Resources"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@AfterEach\nvoid cleanup() {\n    // Clean up test data\n    testDataService.deleteTestData(testId);\n}\n")),(0,r.kt)("h3",{id:"5-document-thread-safety"},"5. Document Thread Safety"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * Tests in this class modify global application state\n * and must run sequentially.\n */\n@Execution(ExecutionMode.SAME_THREAD)\nclass GlobalStateTests {\n    // ...\n}\n")),(0,r.kt)("h2",{id:"measuring-performance"},"Measuring Performance"),(0,r.kt)("h3",{id:"before-parallel-execution"},"Before Parallel Execution"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Total tests: 150\nExecution time: 25 minutes\n")),(0,r.kt)("h3",{id:"after-parallel-execution-8-threads"},"After Parallel Execution (8 threads)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Total tests: 150\nExecution time: 4 minutes\nSpeedup: 6.25x\nEfficiency: 78%\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Calculate metrics:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Speedup = Sequential Time / Parallel Time\nEfficiency = Speedup / Number of Threads \xd7 100%\n")),(0,r.kt)("h2",{id:"next-steps"},"Next Steps"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Return to the main ",(0,r.kt)("a",{parentName:"li",href:"junit5-tests"},"JUnit 5 Guide")),(0,r.kt)("li",{parentName:"ul"},"Learn about ",(0,r.kt)("a",{parentName:"li",href:"junit5-tests#display-names-and-organization"},"Test Organization")),(0,r.kt)("li",{parentName:"ul"},"Review ",(0,r.kt)("a",{parentName:"li",href:"junit5-tests#best-practices"},"Best Practices")),(0,r.kt)("li",{parentName:"ul"},"Explore ",(0,r.kt)("a",{parentName:"li",href:"/docs/reporting/the_serenity_reports"},"Serenity Reports"))),(0,r.kt)("h2",{id:"additional-resources"},"Additional Resources"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://junit.org/junit5/docs/current/user-guide/#writing-tests-parallel-execution"},"JUnit 5 Parallel Execution Docs")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://serenity-bdd.info"},"Serenity BDD Performance Tips")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://jcip.net/"},"Java Concurrency in Practice"))))}c.isMDXComponent=!0}}]);