"use strict";(globalThis.webpackChunkserenity_users_guide=globalThis.webpackChunkserenity_users_guide||[]).push([[5974],{2152(e,a,s){s.r(a),s.d(a,{assets:()=>d,contentTitle:()=>t,default:()=>m,frontMatter:()=>i,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"guide/page_objects","title":"Interagindo com P\xe1ginas Web","description":"O Serenity integra-se suavemente com o Selenium WebDriver e gerencia detalhes como a configura\xe7\xe3o do driver e a manuten\xe7\xe3o da inst\xe2ncia do driver. Ele tamb\xe9m fornece uma s\xe9rie de melhorias em rela\xe7\xe3o ao Selenium padr\xe3o.","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/guide/page_objects.md","sourceDirName":"guide","slug":"/guide/page_objects","permalink":"/pt-BR/docs/guide/page_objects","draft":false,"unlisted":false,"editUrl":"https://github.com/serenity-bdd/serenity-bdd.github.io/blob/master/docs/guide/page_objects.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"id":"page_objects","title":"Interagindo com P\xe1ginas Web","sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Bibliotecas de Passos","permalink":"/pt-BR/docs/guide/step_libraries"},"next":{"title":"Elementos de P\xe1gina do Serenity","permalink":"/pt-BR/docs/guide/page_elements"}}');var n=s(4848),r=s(8453);const i={id:"page_objects",title:"Interagindo com P\xe1ginas Web",sidebar_position:5},t="Interagindo com P\xe1ginas Web",d={},c=[{value:"Page Object",id:"page-object",level:2},{value:"Usando p\xe1ginas em uma biblioteca de passos",id:"usando-p\xe1ginas-em-uma-biblioteca-de-passos",level:2},{value:"Abrindo a p\xe1gina",id:"abrindo-a-p\xe1gina",level:2},{value:"Trabalhando com elementos web",id:"trabalhando-com-elementos-web",level:2},{value:"Verificando se elementos est\xe3o vis\xedveis",id:"verificando-se-elementos-est\xe3o-vis\xedveis",level:3},{value:"Verificando se elementos est\xe3o habilitados",id:"verificando-se-elementos-est\xe3o-habilitados",level:3},{value:"Manipulando listas de sele\xe7\xe3o",id:"manipulando-listas-de-sele\xe7\xe3o",level:3},{value:"Determinando o foco",id:"determinando-o-foco",level:3},{value:"Usando seletores XPath e CSS diretos",id:"usando-seletores-xpath-e-css-diretos",level:3},{value:"Trabalhando com P\xe1ginas Ass\xedncronas",id:"trabalhando-com-p\xe1ginas-ass\xedncronas",level:2},{value:"Verificando se um elemento est\xe1 vis\xedvel",id:"verificando-se-um-elemento-est\xe1-vis\xedvel",level:3},{value:"Trabalhando com elementos Shadow DOM",id:"trabalhando-com-elementos-shadow-dom",level:3},{value:"Trabalhando com timeouts",id:"trabalhando-com-timeouts",level:2},{value:"Esperas Impl\xedcitas",id:"esperas-impl\xedcitas",level:3},{value:"Usando f\xe1bricas de localizador personalizadas",id:"usando-f\xe1bricas-de-localizador-personalizadas",level:3},{value:"Timeouts Expl\xedcitos",id:"timeouts-expl\xedcitos",level:3},{value:"Executando Javascript",id:"executando-javascript",level:2},{value:"Fazendo upload de arquivos",id:"fazendo-upload-de-arquivos",level:2},{value:"Usando express\xf5es Fluent Matcher",id:"usando-express\xf5es-fluent-matcher",level:2},{value:"Trabalhando com Tabelas HTML",id:"trabalhando-com-tabelas-html",level:3},{value:"Mudando para outra p\xe1gina",id:"mudando-para-outra-p\xe1gina",level:2},{value:"Estrat\xe9gias de carregamento de cole\xe7\xe3o de WebElement",id:"estrat\xe9gias-de-carregamento-de-cole\xe7\xe3o-de-webelement",level:2},{value:"Trabalhando com m\xe9todos de fixture",id:"trabalhando-com-m\xe9todos-de-fixture",level:2},{value:"Estendendo a Integra\xe7\xe3o WebDriver do Serenity",id:"estendendo-a-integra\xe7\xe3o-webdriver-do-serenity",level:2},{value:"A interface BeforeAWebdriverScenario",id:"a-interface-beforeawebdriverscenario",level:3},{value:"A interface AfterAWebdriverScenario",id:"a-interface-afterawebdriverscenario",level:3},{value:"Driver Enhancers",id:"driver-enhancers",level:3},{value:"Configurando os pacotes de extens\xe3o",id:"configurando-os-pacotes-de-extens\xe3o",level:3},{value:"Implementa\xe7\xf5es personalizadas de WebDriver",id:"implementa\xe7\xf5es-personalizadas-de-webdriver",level:3},{value:"Usando a interface HasAuthentication",id:"usando-a-interface-hasauthentication",level:2}];function l(e){const a={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.header,{children:(0,n.jsx)(a.h1,{id:"interagindo-com-p\xe1ginas-web",children:"Interagindo com P\xe1ginas Web"})}),"\n",(0,n.jsx)(a.p,{children:"O Serenity integra-se suavemente com o Selenium WebDriver e gerencia detalhes como a configura\xe7\xe3o do driver e a manuten\xe7\xe3o da inst\xe2ncia do driver. Ele tamb\xe9m fornece uma s\xe9rie de melhorias em rela\xe7\xe3o ao Selenium padr\xe3o."}),"\n",(0,n.jsx)(a.h2,{id:"page-object",children:"Page Object"}),"\n",(0,n.jsx)(a.p,{children:"Se voc\xea est\xe1 trabalhando com testes web WebDriver, voc\xea estar\xe1 familiarizado com o conceito de Page Object. Page Object s\xe3o uma forma de isolar os detalhes de implementa\xe7\xe3o de uma p\xe1gina web dentro de uma classe, expondo apenas m\xe9todos focados no neg\xf3cio relacionados a essa p\xe1gina. Eles s\xe3o uma excelente maneira de tornar seus testes web mais f\xe1ceis de manter."}),"\n",(0,n.jsxs)(a.p,{children:["No Serenity, Page Object s\xe3o apenas classes comuns que estendem a classe ",(0,n.jsx)(a.code,{children:"PageObject"}),". O Serenity injeta automaticamente uma inst\xe2ncia do WebDriver no Page Object que voc\xea pode acessar atrav\xe9s do m\xe9todo ",(0,n.jsx)(a.code,{children:"getDriver()"}),", embora voc\xea raramente precise usar o WebDriver diretamente. A classe ",(0,n.jsx)(a.code,{children:"PageObject"})," do Serenity fornece v\xe1rios m\xe9todos convenientes que tornam o acesso e a manipula\xe7\xe3o de elementos web muito mais f\xe1cil do que com scripts de teste WebDriver convencionais."]}),"\n",(0,n.jsx)(a.p,{children:"Aqui est\xe1 um exemplo simples:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'...\nimport net.serenitybdd.core.pages.WebElementFacade;\nimport net.thucydides.core.pages.PageObject;\n...\n\n@DefaultUrl("http://localhost:9000/somepage")\npublic class FindAJobPage extends PageObject {\n\n    WebElementFacade keywords;\n    WebElementFacade searchButton;\n\n    public void look_for_jobs_with_keywords(String values) {\n        typeInto(keywords, values);\n        searchButton.click();\n    }\n\n    public List<String> getJobTabs() {\n        return findAll("//div[@id=\'tabs\']//a").stream()\n            .map(WebElementFacade::getText)\n            .collect(Collectors.toList());\n    }\n}\n'})}),"\n",(0,n.jsxs)(a.p,{children:["O m\xe9todo ",(0,n.jsx)(a.code,{children:"typeInto"})," \xe9 um atalho que simplesmente limpa um campo e insere o texto especificado.\nSe voc\xea preferir um estilo de API mais fluente, tamb\xe9m pode fazer algo assim:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@DefaultUrl("http://localhost:9000/somepage")\npublic class FindAJobPage extends PageObject {\n\tWebElementFacade keywordsField;\n\tWebElementFacade searchButton;\n\n\tpublic FindAJobPage(WebDriver driver) {\n\t    super(driver);\n\t}\n\n\tpublic void look_for_jobs_with_keywords(String values) {\n\t    enter(values).into(keywordsField);\n\t    searchButton.click();\n\t}\n\n\tpublic List<String> getJobTabs() {\n\t     return findAll("//div[@id=\'tabs\']//a").stream()\n            .map(WebElementFacade::getText)\n            .collect(Collectors.toList());\n\t}\n}\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Voc\xea pode usar um estilo ainda mais fluente para expressar os passos de implementa\xe7\xe3o usando m\xe9todos como ",(0,n.jsx)(a.code,{children:"find"}),", ",(0,n.jsx)(a.code,{children:"findBy"})," e ",(0,n.jsx)(a.code,{children:"then"}),"."]}),"\n",(0,n.jsxs)(a.p,{children:["Por exemplo, voc\xea pode usar localizadores ",(0,n.jsx)(a.code,{children:"By"})," do WebDriver com nome de elemento, id, seletor CSS ou seletor XPath da seguinte forma:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'find(By.name("demo")).then(By.name("specialField")).getValue();\n\nfind(By.cssSelector(".foo")).getValue();\n\nfind(By.xpath("//th")).getValue();\n'})}),"\n",(0,n.jsxs)(a.p,{children:["O m\xe9todo ",(0,n.jsx)(a.code,{children:"findBy"})," permite que voc\xea passe o seletor CSS ou XPath diretamente para o WebDriver. Por exemplo,"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'findBy("#demo").then("#specialField").getValue(); // seletores CSS\n\nfindBy("//div[@id=\'dataTable\']").getValue(); // seletor XPath\n'})}),"\n",(0,n.jsx)(a.h2,{id:"usando-p\xe1ginas-em-uma-biblioteca-de-passos",children:"Usando p\xe1ginas em uma biblioteca de passos"}),"\n",(0,n.jsx)(a.p,{children:"Quando voc\xea precisa usar um Page Object em um de seus passos, voc\xea s\xf3 precisa declarar uma vari\xe1vel do tipo PageObject em sua biblioteca de passos, por exemplo:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"FindAJobPage page;\n"})}),"\n",(0,n.jsxs)(a.p,{children:["Se voc\xea quiser ter certeza de que est\xe1 na p\xe1gina correta, pode usar o m\xe9todo ",(0,n.jsx)(a.code,{children:"currentPageAt()"}),". Isso verificar\xe1 a classe da p\xe1gina para quaisquer anota\xe7\xf5es ",(0,n.jsx)(a.code,{children:"@At"})," presentes na classe PageObject e, se presentes, verificar\xe1 se a URL atual corresponde ao padr\xe3o de URL especificado na anota\xe7\xe3o. Por exemplo, quando voc\xea invoca usando ",(0,n.jsx)(a.code,{children:"currentPageAt()"}),", o seguinte Page Object verificar\xe1 se a URL atual \xe9 precisamente ",(0,n.jsx)(a.code,{children:"http://www.apache.org"}),"."]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@At("http://www.apache.org")\npublic class ApacheHomePage extends PageObject {\n    ...\n}\n'})}),"\n",(0,n.jsxs)(a.p,{children:["A anota\xe7\xe3o ",(0,n.jsx)(a.code,{children:"@At"})," tamb\xe9m suporta curingas e express\xf5es regulares. O seguinte Page Object corresponder\xe1 a qualquer subdom\xednio Apache:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@At("http://.*.apache.org")\npublic class AnyApachePage extends PageObject {\n    ...\n}\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Mais geralmente, no entanto, voc\xea est\xe1 mais interessado no que vem depois do nome do host. Voc\xea pode usar o token especial ",(0,n.jsx)(a.code,{children:"#HOST"})," para corresponder a qualquer nome de servidor. Ent\xe3o o seguinte Page Object corresponder\xe1 tanto a ",(0,n.jsx)(a.code,{children:"http://localhost:8080/app/action/login.form"})," quanto a ",(0,n.jsx)(a.code,{children:"http://staging.acme.com/app/action/login.form"}),". Ele tamb\xe9m ignorar\xe1 par\xe2metros, ent\xe3o ",(0,n.jsx)(a.code,{children:"http://staging.acme.com/app/action/login.form?username=toto&password=oz"})," funcionar\xe1 bem tamb\xe9m."]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@At(urls={"#HOST/app/action/login.form"})\npublic class LoginPage extends PageObject {\n   ...\n}\n'})}),"\n",(0,n.jsx)(a.h2,{id:"abrindo-a-p\xe1gina",children:"Abrindo a p\xe1gina"}),"\n",(0,n.jsxs)(a.p,{children:["Um Page Object \xe9 geralmente projetado para trabalhar com uma p\xe1gina web espec\xedfica. Quando o m\xe9todo ",(0,n.jsx)(a.code,{children:"open()"})," \xe9 invocado, o navegador ser\xe1 aberto na URL padr\xe3o da p\xe1gina."]}),"\n",(0,n.jsxs)(a.p,{children:["A anota\xe7\xe3o ",(0,n.jsx)(a.code,{children:"@DefaultUrl"})," indica a URL que este teste deve usar quando executado isoladamente (por exemplo, de dentro do seu IDE).\nGeralmente, no entanto, a parte do host da URL padr\xe3o ser\xe1 sobrescrita pela propriedade ",(0,n.jsx)(a.code,{children:"webdriver.base.url"}),", pois isso permite definir a URL base de forma geral para todos os seus testes,\ne assim torna mais f\xe1cil executar seus testes em diferentes ambientes simplesmente alterando este valor de propriedade.\nPor exemplo, na classe de teste acima, definir o ",(0,n.jsx)(a.code,{children:"webdriver.base.url"})," para '",(0,n.jsx)(a.a,{href:"https://staging.mycompany.com",children:"https://staging.mycompany.com"}),"' resultaria na p\xe1gina sendo aberta na URL '",(0,n.jsx)(a.a,{href:"https://staging.mycompany.com/somepage",children:"https://staging.mycompany.com/somepage"}),"'."]}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode definir URLs nomeadas que podem ser usadas para abrir a p\xe1gina web, opcionalmente com par\xe2metros. Por exemplo, no c\xf3digo a seguir, definimos uma URL chamada 'open.issue', que aceita um \xfanico par\xe2metro:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@DefaultUrl("http://jira.mycompany.org")\n@NamedUrls(\n  {\n    @NamedUrl(name = "open.issue", url = "http://jira.mycompany.org/issues/{1}")\n  }\n)\npublic class JiraIssuePage extends PageObject {\n    ...\n}\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Voc\xea poderia ent\xe3o abrir esta p\xe1gina na URL ",(0,n.jsx)(a.a,{href:"http://jira.mycompany.org/issues/ISSUE-1",children:"http://jira.mycompany.org/issues/ISSUE-1"})," como mostrado aqui:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'page.open("open.issue", withParameters("ISSUE-1"));\n'})}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m poderia dispensar totalmente a URL base na defini\xe7\xe3o da URL nomeada e confiar nos valores padr\xe3o:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@DefaultUrl("http://jira.mycompany.org")\n@NamedUrls(\n  {\n    @NamedUrl(name = "open.issue", url = "/issues/{1}")\n  }\n)\npublic class JiraIssuePage extends PageObject {\n    ...\n}\n'})}),"\n",(0,n.jsx)(a.p,{children:"E naturalmente voc\xea pode definir mais de uma defini\xe7\xe3o:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@NamedUrls(\n  {\n          @NamedUrl(name = "open.issue", url = "/issues/{1}"),\n          @NamedUrl(name = "close.issue", url = "/issues/close/{1}")\n  }\n)\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Voc\xea nunca deve tentar implementar o m\xe9todo ",(0,n.jsx)(a.code,{children:"open()"})," voc\xea mesmo. Na verdade, ele \xe9 final. Se voc\xea precisa que sua p\xe1gina fa\xe7a algo ao carregar, como esperar por um elemento din\xe2mico aparecer, voc\xea pode usar a anota\xe7\xe3o @WhenPageOpens.\nM\xe9todos no PageObject com esta anota\xe7\xe3o ser\xe3o invocados (em uma ordem n\xe3o especificada) ap\xf3s a URL ter sido aberta. Neste exemplo, o m\xe9todo ",(0,n.jsx)(a.code,{children:"open()"})," n\xe3o retornar\xe1 at\xe9 que\no elemento web ",(0,n.jsx)(a.code,{children:"dataSection"})," esteja vis\xedvel:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@DefaultUrl("http://localhost:8080/client/list")\n    public class ClientList extends PageObject {\n\n     @FindBy(id="data-section");\n     WebElementFacade dataSection;\n     ...\n\n     @WhenPageOpens\n     public void waitUntilTitleAppears() {\n         element(dataSection).waitUntilVisible();\n     }\n}\n'})}),"\n",(0,n.jsx)(a.h2,{id:"trabalhando-com-elementos-web",children:"Trabalhando com elementos web"}),"\n",(0,n.jsx)(a.h3,{id:"verificando-se-elementos-est\xe3o-vis\xedveis",children:"Verificando se elementos est\xe3o vis\xedveis"}),"\n",(0,n.jsxs)(a.p,{children:["A classe ",(0,n.jsx)(a.code,{children:"WebElementFacade"})," cont\xe9m uma API fluente conveniente para lidar com elementos web, fornecendo alguns recursos extras comumente usados que n\xe3o s\xe3o fornecidos de forma nativa pela API do WebDriver.\n",(0,n.jsx)(a.code,{children:"WebElementFacades"})," s\xe3o amplamente intercambi\xe1veis com WebElements: voc\xea apenas declara uma vari\xe1vel do tipo ",(0,n.jsx)(a.code,{children:"WebElementFacade"})," em vez do tipo ",(0,n.jsx)(a.code,{children:"WebElement"}),". Por exemplo, voc\xea pode verificar se um elemento est\xe1 vis\xedvel como mostrado aqui:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"public class FindAJobPage extends PageObject {\n\n    WebElementFacade searchButton;\n\n    public boolean searchButtonIsVisible() {\n        return searchButton.isVisible();\n    }\n    ...\n}\n"})}),"\n",(0,n.jsx)(a.p,{children:"Se o bot\xe3o n\xe3o estiver presente na tela, o teste esperar\xe1 por um curto per\xedodo caso ele apare\xe7a devido a alguma m\xe1gica Ajax. Se voc\xea n\xe3o quiser que o teste fa\xe7a isso, voc\xea pode usar a vers\xe3o mais r\xe1pida:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"public boolean searchButtonIsVisibleNow() {\n    return searchButton.isCurrentlyVisible();\n}\n"})}),"\n",(0,n.jsxs)(a.p,{children:["Voc\xea pode transformar isso em uma asser\xe7\xe3o usando o m\xe9todo ",(0,n.jsx)(a.code,{children:"shouldBeVisible()"})," em vez disso:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"public void checkThatSearchButtonIsVisible() {\n    searchButton.shouldBeVisible();\n}\n"})}),"\n",(0,n.jsx)(a.p,{children:"Este m\xe9todo lan\xe7ar\xe1 um erro de asser\xe7\xe3o se o bot\xe3o de busca n\xe3o estiver vis\xedvel para o usu\xe1rio final."}),"\n",(0,n.jsx)(a.h3,{id:"verificando-se-elementos-est\xe3o-habilitados",children:"Verificando se elementos est\xe3o habilitados"}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode verificar se um elemento est\xe1 habilitado ou n\xe3o:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"searchButton.isEnabled()\nsearchButton.shouldBeEnabled()\n"})}),"\n",(0,n.jsx)(a.p,{children:"Tamb\xe9m existem m\xe9todos negativos equivalentes:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"searchButton.shouldNotBeVisible();\nsearchButton.shouldNotBeCurrentlyVisible();\nsearchButton.shouldNotBeEnabled()\n"})}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode verificar elementos que est\xe3o presentes na p\xe1gina mas n\xe3o vis\xedveis, por exemplo:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"searchButton.isPresent();\nsearchButton.isNotPresent();\nsearchButton.shouldBePresent();\nsearchButton.shouldNotBePresent();\n"})}),"\n",(0,n.jsx)(a.h3,{id:"manipulando-listas-de-sele\xe7\xe3o",children:"Manipulando listas de sele\xe7\xe3o"}),"\n",(0,n.jsx)(a.p,{children:"Tamb\xe9m existem m\xe9todos auxiliares dispon\xedveis para listas dropdown. Suponha que voc\xea tenha o seguinte dropdown na sua p\xe1gina:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-xml",children:'<select id="color">\n    <option value="red">Red</option>\n    <option value="blue">Blue</option>\n    <option value="green">Green</option>\n</select>\n'})}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea poderia escrever um Page Object para manipular este dropdown como mostrado aqui:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'public class FindAJobPage extends PageObject {\n\n\t@FindBy(id="color")\n\tWebElementFacade colorDropdown;\n\n\tpublic selectDropdownValues() {\n\t    colorDropdown.selectByVisibleText("Blue");\n\t    assertThat(colorDropdown.getSelectedVisibleTextValue(), is("Blue"));\n\n\t    colorDropdown.selectByValue("blue");\n\t    assertThat(colorDropdown.getSelectedValue(), is("blue"));\n\n\t    colorDropdown.selectByIndex(2);\n\t    assertThat(colorDropdown.getSelectedValue(), is("green"));\n\n\t}\n\t...\n}\n'})}),"\n",(0,n.jsx)(a.h3,{id:"determinando-o-foco",children:"Determinando o foco"}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea pode determinar se um campo espec\xedfico tem o foco da seguinte forma:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"firstName.hasFocus()\n"})}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode esperar que elementos apare\xe7am, desapare\xe7am ou se tornem habilitados ou desabilitados:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"button.waitUntilEnabled()\nbutton.waitUntilDisabled()\n"})}),"\n",(0,n.jsx)(a.p,{children:"ou"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"field.waitUntilVisible()\nbutton.waitUntilNotVisible()\n"})}),"\n",(0,n.jsx)(a.h3,{id:"usando-seletores-xpath-e-css-diretos",children:"Usando seletores XPath e CSS diretos"}),"\n",(0,n.jsxs)(a.p,{children:["Outra maneira de acessar um elemento web \xe9 usar uma express\xe3o XPath ou CSS. Voc\xea pode usar o m\xe9todo ",(0,n.jsx)(a.code,{children:"$()"})," com uma express\xe3o XPath para fazer isso de forma mais simples. Por exemplo, imagine que sua aplica\xe7\xe3o web precisa clicar em um item de lista contendo um determinado c\xf3digo postal. Uma maneira seria como mostrado aqui:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'WebElement selectedSuburb = getDriver().findElement(By.xpath("//li/a[contains(.,\'" ` postcode ` "\')]"));\nselectedSuburb.click();\n'})}),"\n",(0,n.jsx)(a.p,{children:"No entanto, uma op\xe7\xe3o mais simples seria fazer isso:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'$("//li/a[contains(.,\'" ` postcode ` "\')]").click();\n'})}),"\n",(0,n.jsx)(a.h2,{id:"trabalhando-com-p\xe1ginas-ass\xedncronas",children:"Trabalhando com P\xe1ginas Ass\xedncronas"}),"\n",(0,n.jsx)(a.p,{children:"P\xe1ginas ass\xedncronas s\xe3o aquelas cujos campos ou dados n\xe3o s\xe3o todos exibidos quando a p\xe1gina \xe9 carregada. \xc0s vezes, voc\xea precisa esperar que certos elementos apare\xe7am ou desapare\xe7am antes de poder prosseguir com seus testes. O Serenity fornece alguns m\xe9todos \xfateis na classe base PageObject para ajudar com esses cen\xe1rios. Eles s\xe3o projetados principalmente para serem usados como parte de seus m\xe9todos de neg\xf3cio em seus Page Object, embora nos exemplos os mostraremos sendo usados como chamadas externas em uma inst\xe2ncia PageObject para clareza."}),"\n",(0,n.jsx)(a.h3,{id:"verificando-se-um-elemento-est\xe1-vis\xedvel",children:"Verificando se um elemento est\xe1 vis\xedvel"}),"\n",(0,n.jsx)(a.p,{children:"Em termos de WebDriver, h\xe1 uma distin\xe7\xe3o entre quando um elemento est\xe1 presente na tela (ou seja, no c\xf3digo-fonte HTML), e quando ele \xe9 renderizado (ou seja, vis\xedvel para o usu\xe1rio). Voc\xea tamb\xe9m pode precisar verificar se um elemento est\xe1 vis\xedvel na tela. Voc\xea pode fazer isso de duas maneiras. Sua primeira op\xe7\xe3o \xe9 usar o m\xe9todo isElementVisible, que retorna um valor booleano com base em se o elemento \xe9 renderizado (vis\xedvel para o usu\xe1rio) ou n\xe3o:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"isElementVisible(By.xpath(\"//h2[.='A visible title']\"))\n"})}),"\n",(0,n.jsx)(a.p,{children:"Sua segunda op\xe7\xe3o \xe9 assertar ativamente que o elemento deve estar vis\xedvel:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"shouldBeVisible(By.xpath(\"//h2[.='An invisible title']\"));\n"})}),"\n",(0,n.jsx)(a.p,{children:"Se o elemento n\xe3o aparecer imediatamente, voc\xea pode esperar que ele apare\xe7a:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"waitForRenderedElements(By.xpath(\"//h2[.='A title that is not immediately visible']\"));\n"})}),"\n",(0,n.jsxs)(a.p,{children:["Uma alternativa \xe0 sintaxe acima \xe9 usar o m\xe9todo mais fluido ",(0,n.jsx)(a.code,{children:"waitFor"})," que recebe um seletor CSS ou XPath como argumento:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'waitFor("#popup"); // seletor CSS\n\nwaitFor("//h2[.=\'A title that is not immediately visible\']"); // seletor XPath\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Se voc\xea apenas quiser verificar se o elemento est\xe1 presente, embora n\xe3o necessariamente vis\xedvel, voc\xea pode usar ",(0,n.jsx)(a.code,{children:"waitForRenderedElementsToBePresent"}),":"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"waitForRenderedElementsToBePresent(By.xpath(\"//h2[.='A title that is not immediately visible']\"));\n"})}),"\n",(0,n.jsxs)(a.p,{children:["ou sua vers\xe3o mais expressiva, ",(0,n.jsx)(a.code,{children:"waitForPresenceOf"})," que recebe um seletor CSS ou XPath como argumento."]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'waitForPresenceOf("#popup"); // CSS\n\nwaitForPresenceOf("//h2[.=\'A title that is not immediately visible\']"); // XPath\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Voc\xea tamb\xe9m pode esperar que um elemento desapare\xe7a usando ",(0,n.jsx)(a.code,{children:"waitForRenderedElementsToDisappear"})," ou ",(0,n.jsx)(a.code,{children:"waitForAbsenceOf"}),":"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'waitForRenderedElementsToDisappear(By.xpath("//h2[.=\'A title that will soon disappear\']"));\n\nwaitForAbsenceOf("#popup");\n\nwaitForAbsenceOf("//h2[.=\'A title that will soon disappear\']");\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Para simplicidade, voc\xea tamb\xe9m pode usar os m\xe9todos ",(0,n.jsx)(a.code,{children:"waitForTextToAppear"})," e ",(0,n.jsx)(a.code,{children:"waitForTextToDisappear"}),":"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'waitForTextToDisappear("A visible bit of text");\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Se v\xe1rios textos poss\xedveis podem aparecer, voc\xea pode usar ",(0,n.jsx)(a.code,{children:"waitForAnyTextToAppear"})," ou ",(0,n.jsx)(a.code,{children:"waitForAllTextToAppear"}),":"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'waitForAnyTextToAppear("this might appear","or this", "or even this");\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Se voc\xea precisa esperar por um de v\xe1rios elementos poss\xedveis aparecerem, voc\xea tamb\xe9m pode usar o m\xe9todo ",(0,n.jsx)(a.code,{children:"waitForAnyRenderedElementOf"}),":"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'waitForAnyRenderedElementOf(By.id("color"), By.id("taste"), By.id("sound"));\n'})}),"\n",(0,n.jsx)(a.h3,{id:"trabalhando-com-elementos-shadow-dom",children:"Trabalhando com elementos Shadow DOM"}),"\n",(0,n.jsx)(a.p,{children:"O Selenium 4 introduziu suporte para elementos Shadow DOM, e o Serenity BDD adiciona suporte aprimorado para esses elementos. Suponha que temos a seguinte estrutura HTML contendo elementos Shadow DOM."}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-html",children:'<pre>\n    <div id="shadow-host">\n      #shadow-root\n      <input id="shadowedInput"/>\n\n      <div id="nested-shadow-host">\n          #shadow-root\n          <input id="nestedShadowedInput"/>\n      </div>\n    </div>\n'})}),"\n",(0,n.jsx)(a.p,{children:"Para encontrar o primeiro elemento input dentro de um Shadow DOM de n\xedvel \xfanico, voc\xea precisa fornecer o localizador para o elemento aninhado e o localizador para o elemento host shadow:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:' ByShadow.cssSelector("#shadowedInput","#shadow-host")\n'})}),"\n",(0,n.jsx)(a.p,{children:"Para encontrar o elemento input dentro do Shadow DOM aninhado, voc\xea precisa fornecer o localizador para o elemento sombreado, bem como a lista de localizadores de shadow dom pai, de cima para baixo:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'ByShadow.cssSelector("#nestedShadowedInput","#shadow-host", "#nested-shadow-host")\n'})}),"\n",(0,n.jsx)(a.h2,{id:"trabalhando-com-timeouts",children:"Trabalhando com timeouts"}),"\n",(0,n.jsx)(a.p,{children:"Aplica\xe7\xf5es web modernas baseadas em AJAX adicionam uma grande complexidade aos testes web. O problema b\xe1sico \xe9 que, quando voc\xea acessa um elemento web em uma p\xe1gina, ele pode n\xe3o estar dispon\xedvel ainda. Ent\xe3o voc\xea precisa esperar um pouco. De fato, muitos testes cont\xeam pausas codificadas espalhadas pelo c\xf3digo para atender a esse tipo de situa\xe7\xe3o."}),"\n",(0,n.jsx)(a.p,{children:"Mas esperas codificadas s\xe3o ruins. Elas tornam sua su\xedte de testes mais lenta e fazem com que falhem aleatoriamente se n\xe3o forem longas o suficiente. Em vez disso, voc\xea precisa esperar por um estado ou evento espec\xedfico. O Selenium fornece grande suporte para isso, e o Serenity constr\xf3i sobre esse suporte para torn\xe1-lo mais f\xe1cil de usar."}),"\n",(0,n.jsx)(a.h3,{id:"esperas-impl\xedcitas",children:"Esperas Impl\xedcitas"}),"\n",(0,n.jsxs)(a.p,{children:["A primeira maneira de gerenciar como o WebDriver lida com campos tardios \xe9 usar a propriedade ",(0,n.jsx)(a.code,{children:"webdriver.timeouts.implicitlywait"}),". Isso determina quanto tempo, em milissegundos, o WebDriver esperar\xe1 se um elemento que ele tenta acessar n\xe3o estiver presente na p\xe1gina. Para citar a documenta\xe7\xe3o do WebDriver:"]}),"\n",(0,n.jsx)(a.p,{children:'"Uma espera impl\xedcita \xe9 dizer ao WebDriver para pesquisar o DOM por uma certa quantidade de tempo ao tentar encontrar um elemento ou elementos se eles n\xe3o estiverem imediatamente dispon\xedveis."'}),"\n",(0,n.jsx)(a.p,{children:"O valor padr\xe3o no Serenity para esta propriedade \xe9 atualmente 2 segundos. Isso \xe9 diferente do WebDriver padr\xe3o, onde o padr\xe3o \xe9 zero."}),"\n",(0,n.jsx)(a.p,{children:"Vamos ver um exemplo. Suponha que temos um PageObject com um campo definido assim:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@FindBy(id="slow-loader")\npublic WebElementFacade slowLoadingField;\n'})}),"\n",(0,n.jsx)(a.p,{children:"Este campo demora um pouco para carregar, ent\xe3o n\xe3o estar\xe1 pronto imediatamente na p\xe1gina."}),"\n",(0,n.jsxs)(a.p,{children:["Agora suponha que definimos o valor ",(0,n.jsx)(a.code,{children:"webdriver.timeouts.implicitlywait"})," para 5000, e que nosso teste usa o slowLoadingField:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"boolean loadingFinished = slowLoadingField.isDisplayed()\n"})}),"\n",(0,n.jsx)(a.p,{children:"Quando acessamos este campo, duas coisas podem acontecer. Se o campo levar menos de 5 segundos para carregar, tudo estar\xe1 bem. Mas se levar mais de 5 segundos, uma NoSuchElementException (ou algo similar) ser\xe1 lan\xe7ada."}),"\n",(0,n.jsx)(a.p,{children:"Esse timeout tamb\xe9m se aplica a listas. Suponha que definimos um campo assim, que leva algum tempo para carregar dinamicamente:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@FindBy(css="#elements option")\npublic List<WebElementFacade> elementItems;\n'})}),"\n",(0,n.jsx)(a.p,{children:"Agora suponha que contamos os valores do elemento assim:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"int itemCount = elementItems.size()\n"})}),"\n",(0,n.jsxs)(a.p,{children:["O n\xfamero de itens retornados depender\xe1 do valor de espera impl\xedcita. Se definirmos o valor ",(0,n.jsx)(a.code,{children:"webdriver.timeouts.implicitlywait"})," para um valor muito pequeno, o WebDriver pode carregar apenas alguns dos valores. Mas se dermos \xe0 lista tempo suficiente para carregar completamente, obteremos a lista completa."]}),"\n",(0,n.jsx)(a.p,{children:"O valor de espera impl\xedcita \xe9 definido globalmente para cada inst\xe2ncia do WebDriver, mas voc\xea pode sobrescrever o valor voc\xea mesmo. A maneira mais simples de fazer isso de dentro de um PageObject do Serenity \xe9 usar o m\xe9todo setImplicitTimeout():"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"setImplicitTimeout(5, SECONDS)\n"})}),"\n",(0,n.jsx)(a.p,{children:"Mas lembre-se de que esta \xe9 uma configura\xe7\xe3o global, ent\xe3o tamb\xe9m afetar\xe1 outros Page Object. Portanto, assim que terminar, voc\xea deve sempre redefinir o timeout impl\xedcito para seu valor anterior. O Serenity fornece um m\xe9todo \xfatil para fazer isso:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"resetImplicitTimeout()\n"})}),"\n",(0,n.jsxs)(a.p,{children:["Veja ",(0,n.jsx)(a.a,{href:"http://docs.seleniumhq.org/docs/04_webdriver_advanced.jsp#implicit-waits%5BDocumenta%C3%A7%C3%A3o",children:"http://docs.seleniumhq.org/docs/04_webdriver_advanced.jsp#implicit-waits[Documenta\xe7\xe3o"})," do Selenium] para mais detalhes sobre como as esperas impl\xedcitas do WebDriver funcionam."]}),"\n",(0,n.jsx)(a.h3,{id:"usando-f\xe1bricas-de-localizador-personalizadas",children:"Usando f\xe1bricas de localizador personalizadas"}),"\n",(0,n.jsxs)(a.p,{children:["Internamente, o Selenium usa o conceito de Locator Factories\nNormalmente, o Serenity usa ",(0,n.jsx)(a.code,{children:"SmartElementLocatorFactory"}),", uma extens\xe3o do ",(0,n.jsx)(a.code,{children:"AjaxElementLocatorFactory"})," do WebDriver, ao instanciar Page Object. Entre outras coisas, isso ajuda a garantir que os elementos web estejam dispon\xedveis e utiliz\xe1veis antes de serem usados, permite timeouts campo-por-campo e evita longas esperas desnecess\xe1rias em elementos web ap\xf3s um passo ter falhado."]}),"\n",(0,n.jsxs)(a.p,{children:["O ",(0,n.jsx)(a.code,{children:"SmartElementLocatorFactory"})," usa a espera impl\xedcita padr\xe3o, ou o atributo ",(0,n.jsx)(a.code,{children:"timeoutInSeconds"})," da anota\xe7\xe3o ",(0,n.jsx)(a.code,{children:"@FindBy"})," se este valor foi especificado (veja abaixo), ou o valor de espera impl\xedcita padr\xe3o especificado pela propriedade ",(0,n.jsx)(a.code,{children:"webdriver.timeouts.implicitlywait"}),"."]}),"\n",(0,n.jsxs)(a.p,{children:["Em casos raros, voc\xea pode precisar personalizar este comportamento. Para fazer isso, voc\xea pode usar a propriedade ",(0,n.jsx)(a.code,{children:"serenity.locator.factory"})," para usar uma das seguintes f\xe1bricas de localizador alternativas:"]}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.code,{children:"AjaxElementLocatorFactory"}),": Uma f\xe1brica de localizador do WebDriver mais adequada para aplica\xe7\xf5es Ajax. De acordo com a documenta\xe7\xe3o do WebDriver, esta f\xe1brica de localizador retornar\xe1 ",(0,n.jsx)(a.em,{children:"um localizador de elemento que esperar\xe1 pelo n\xfamero especificado de segundos para que um elemento apare\xe7a, em vez de falhar instantaneamente se n\xe3o estiver presente. Isso funciona pesquisando a UI regularmente. O elemento retornado estar\xe1 presente no DOM, mas pode n\xe3o estar realmente vis\xedvel."})]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.code,{children:"DefaultElementLocatorFactory"}),": a f\xe1brica de localizador padr\xe3o do WebDriver"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(a.p,{children:["Se voc\xea usar o ",(0,n.jsx)(a.code,{children:"AjaxElementLocatorFactory"}),", voc\xea pode usar o par\xe2metro ",(0,n.jsx)(a.code,{children:"webdriver.timeouts.implicitlywait"})," para especificar o n\xfamero de segundos a esperar. Se nenhum valor for especificado, a espera padr\xe3o ser\xe1 de 5 segundos."]}),"\n",(0,n.jsx)(a.h3,{id:"timeouts-expl\xedcitos",children:"Timeouts Expl\xedcitos"}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode esperar programaticamente at\xe9 que um elemento esteja em um estado espec\xedfico. Isso \xe9 mais flex\xedvel e \xfatil quando voc\xea precisa esperar tempo extra em uma situa\xe7\xe3o espec\xedfica. Por exemplo, poder\xedamos esperar at\xe9 que um campo se torne vis\xedvel:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"slowLoadingField.waitUntilVisible()\n"})}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode esperar por condi\xe7\xf5es mais arbitr\xe1rias, por exemplo:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"waitFor(ExpectedConditions.alertIsPresent())\n"})}),"\n",(0,n.jsxs)(a.p,{children:["O tempo padr\xe3o que o Serenity esperar\xe1 \xe9 determinado pela propriedade ",(0,n.jsx)(a.code,{children:"webdriver.wait.for.timeout"}),". O valor padr\xe3o para esta propriedade \xe9 5 segundos."]}),"\n",(0,n.jsx)(a.p,{children:"\xc0s vezes voc\xea quer dar ao WebDriver mais tempo para uma opera\xe7\xe3o espec\xedfica. De dentro de um PageObject, voc\xea pode sobrescrever ou estender o timeout expl\xedcito usando o m\xe9todo withTimeoutOf(). Por exemplo, voc\xea poderia esperar que a lista #elements carregue por at\xe9 5 segundos assim:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'withTimeoutOf(5, SECONDS).waitForPresenceOf(By.cssSelector("#elements option"))\n'})}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode especificar o timeout para um campo. Por exemplo, se voc\xea quisesse esperar at\xe9 5 segundos para um bot\xe3o se tornar clic\xe1vel antes de clicar nele, voc\xea poderia fazer o seguinte:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"someButton.withTimeoutOf(5, SECONDS).waitUntilClickable().click()\n"})}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode usar esta abordagem para recuperar elementos:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'elements = withTimeoutOf(5, SECONDS).findAll("#elements option")\n'})}),"\n",(0,n.jsx)(a.p,{children:"Finalmente, se um elemento espec\xedfico em um PageObject precisa de um pouco mais de tempo para carregar, voc\xea pode usar o atributo timeoutInSeconds na anota\xe7\xe3o @FindBy do Serenity, por exemplo:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'import net.serenitybdd.core.annotations.findby.FindBy;\n...\n@FindBy(name = "country", timeoutInSeconds="10")\npublic WebElementFacade country;\n'})}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode esperar que um elemento esteja em um estado espec\xedfico e ent\xe3o realizar uma a\xe7\xe3o no elemento. Aqui esperamos que um elemento seja clic\xe1vel antes de clicar no elemento:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"addToCartButton.withTimeoutOf(5, SECONDS).waitUntilClickable().click()\n"})}),"\n",(0,n.jsx)(a.p,{children:"Ou, voc\xea pode esperar diretamente em um elemento web:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@FindBy(id="share1-fb-like")\nWebElementFacade facebookIcon;\n  ...\npublic WebElementState facebookIcon() {\n    return withTimeoutOf(5, TimeUnit.SECONDS).waitFor(facebookIcon);\n}\n'})}),"\n",(0,n.jsx)(a.p,{children:"Ou at\xe9:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'List<WebElementFacade> currencies = withTimeoutOf(5, TimeUnit.SECONDS)\n                              .waitFor(currencyTab)\n                              .thenFindAll(".currency-code");\n'})}),"\n",(0,n.jsx)(a.h2,{id:"executando-javascript",children:"Executando Javascript"}),"\n",(0,n.jsxs)(a.p,{children:["H\xe1 momentos em que voc\xea pode achar \xfatil executar um pouco de Javascript diretamente dentro do navegador para realizar o trabalho. Voc\xea pode usar o m\xe9todo ",(0,n.jsx)(a.code,{children:"evaluateJavascript()"})," da classe ",(0,n.jsx)(a.code,{children:"PageObject"})," para fazer isso. Por exemplo, voc\xea pode precisar avaliar uma express\xe3o e usar o resultado em seus testes. O seguinte comando avaliar\xe1 o t\xedtulo do documento e o retornar\xe1 ao c\xf3digo Java que chama:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'String result = (String) evaluateJavascript("return document.title");\n'})}),"\n",(0,n.jsx)(a.p,{children:"Alternativamente, voc\xea pode simplesmente querer executar um comando Javascript localmente no navegador. No c\xf3digo a seguir, por exemplo, definimos o foco para o campo de entrada 'firstname':"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"\tevaluateJavascript(\"document.getElementById('firstname').focus()\");\n"})}),"\n",(0,n.jsx)(a.p,{children:"E, se voc\xea estiver familiarizado com JQuery, voc\xea tamb\xe9m pode invocar express\xf5es JQuery:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"\tevaluateJavascript(\"$('#firstname').focus()\");\n"})}),"\n",(0,n.jsx)(a.p,{children:"Esta \xe9 frequentemente uma estrat\xe9gia \xfatil se voc\xea precisar disparar eventos como mouse-overs que n\xe3o s\xe3o atualmente suportados pela API do WebDriver."}),"\n",(0,n.jsx)(a.h2,{id:"fazendo-upload-de-arquivos",children:"Fazendo upload de arquivos"}),"\n",(0,n.jsx)(a.p,{children:"Fazer upload de arquivos \xe9 f\xe1cil. Arquivos para upload podem ser colocados em um local codificado (ruim) ou armazenados no classpath (melhor). Aqui est\xe1 um exemplo simples:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'public class NewCompanyPage extends PageObject {\n    ...\n    @FindBy(id="object_logo")\n    WebElementFacade logoField;\n\n    public NewCompanyPage(WebDriver driver) {\n        super(driver);\n    }\n\n    public void loadLogoFrom(String filename) {\n        upload(filename).to(logoField);\n    }\n}\n'})}),"\n",(0,n.jsx)(a.h2,{id:"usando-express\xf5es-fluent-matcher",children:"Usando express\xf5es Fluent Matcher"}),"\n",(0,n.jsx)(a.p,{children:"Ao escrever testes de aceita\xe7\xe3o, voc\xea frequentemente se encontra expressando expectativas sobre objetos de dom\xednio individuais ou cole\xe7\xf5es de objetos de dom\xednio. Por exemplo, se voc\xea est\xe1 testando um recurso de busca multi-crit\xe9rio, voc\xea vai querer saber se a aplica\xe7\xe3o encontra os registros que voc\xea esperava. Voc\xea pode ser capaz de fazer isso de maneira muito precisa (por exemplo, sabendo exatamente quais valores de campo voc\xea espera), ou voc\xea pode querer tornar seus testes mais flex\xedveis expressando os intervalos de valores que seriam aceit\xe1veis. O Serenity fornece alguns recursos que facilitam a escrita de testes de aceita\xe7\xe3o para esse tipo de caso."}),"\n",(0,n.jsx)(a.p,{children:"No restante desta se\xe7\xe3o, estudaremos alguns exemplos baseados em testes para o site de busca Maven Central. Este site permite que voc\xea pesquise no reposit\xf3rio Maven por artefatos Maven e veja os detalhes de um artefato espec\xedfico."}),"\n",(0,n.jsx)(a.p,{children:"Usaremos alguns testes de regress\xe3o imagin\xe1rios para este site para ilustrar como os matchers do Serenity podem ser usados para escrever testes mais expressivos. O primeiro cen\xe1rio que consideraremos \xe9 simplesmente pesquisar um artefato pelo nome e garantir que apenas artefatos correspondentes a este nome apare\xe7am na lista de resultados. Poder\xedamos expressar este crit\xe9rio de aceita\xe7\xe3o informalmente da seguinte maneira:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Dado que o desenvolvedor est\xe1 na p\xe1gina de busca,"}),"\n",(0,n.jsx)(a.li,{children:"E o desenvolvedor pesquisa por artefatos chamados 'Serenity'"}),"\n",(0,n.jsx)(a.li,{children:"Ent\xe3o o desenvolvedor deve ver pelo menos 16 artefatos Serenity, cada um com um Artifact Id \xfanico"}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:"No JUnit 5, um teste Serenity para este cen\xe1rio poderia parecer com este:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'...\nimport static net.thucydides.core.matchers.BeanMatchers.the_count;\nimport static net.thucydides.core.matchers.BeanMatchers.each;\nimport static net.thucydides.core.matchers.BeanMatchers.the;\nimport static org.hamcrest.Matchers.greaterThanOrEqualTo;\nimport static org.hamcrest.Matchers.is;\nimport static org.hamcrest.Matchers.startsWith;\n\n@ExtendWith(SerenityJUnit5Extension.class)\nclass WhenSearchingForArtifacts {\n\n    @Managed\n    WebDriver driver;\n\n    @Steps\n    DeveloperSteps developer;\n\n    @Test\n    void should_find_the_right_number_of_artifacts() {\n        developer.opens_the_search_page();\n        developer.searches_for("Serenity");\n        developer.should_see_artifacts_where(the("GroupId", startsWith("net.thucydides")),\n                                             each("ArtifactId").isDifferent(),\n                                             the_count(is(greaterThanOrEqualTo(16))));\n\n    }\n}\n'})}),"\n",(0,n.jsx)(a.admonition,{title:"JUnit 4 Obsoleto",type:"note",children:(0,n.jsxs)(a.p,{children:["Se voc\xea ainda est\xe1 usando JUnit 4 com ",(0,n.jsx)(a.code,{children:"@RunWith(SerenityRunner.class)"}),", observe que o suporte ao JUnit 4 est\xe1 obsoleto a partir do Serenity 5.0.0 e ser\xe1 removido no Serenity 6.0.0. Por favor, migre para o JUnit 5 usando ",(0,n.jsx)(a.code,{children:"@ExtendWith(SerenityJUnit5Extension.class)"}),"."]})}),"\n",(0,n.jsxs)(a.p,{children:["Vamos ver como o teste nesta classe \xe9 implementado. O teste ",(0,n.jsx)(a.code,{children:"should_find_the_right_number_of_artifacts()"})," poderia ser expresso da seguinte forma:"]}),"\n",(0,n.jsx)(a.p,{children:". Quando abrimos a p\xe1gina de busca"}),"\n",(0,n.jsx)(a.p,{children:". E pesquisamos por artefatos contendo a palavra 'Serenity'"}),"\n",(0,n.jsx)(a.p,{children:'. Ent\xe3o devemos ver uma lista de artefatos onde cada Group ID come\xe7a com "net.Serenity", cada Artifact ID \xe9 \xfanico, e que h\xe1 pelo menos 16 dessas entradas exibidas.'}),"\n",(0,n.jsx)(a.p,{children:"A implementa\xe7\xe3o desses passos \xe9 ilustrada aqui:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"...\nimport static net.thucydides.core.matchers.BeanMatcherAsserts.shouldMatch;\n\npublic class DeveloperSteps {\n\n    @Step\n    public void opens_the_search_page() {\n        onSearchPage().open();\n    }\n\n    @Step\n    public void searches_for(String search_terms) {\n        onSearchPage().enter_search_terms(search_terms);\n        onSearchPage().starts_search();\n    }\n\n    @Step\n    public void should_see_artifacts_where(BeanMatcher... matchers) {\n        shouldMatch(onSearchResultsPage().getSearchResults(), matchers);\n    }\n\n    private SearchPage onSearchPage() {\n        return getPages().get(SearchPage.class);\n    }\n\n    private SearchResultsPage onSearchResultsPage() {\n        return getPages().get(SearchResultsPage.class);\n    }\n}\n"})}),"\n",(0,n.jsx)(a.p,{children:"Os primeiros dois passos s\xe3o implementados por m\xe9todos relativamente simples. No entanto, o terceiro passo \xe9 mais interessante. Vamos olh\xe1-lo mais de perto:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"    @Step\n    public void should_see_artifacts_where(BeanMatcher... matchers) {\n        shouldMatch(onSearchResultsPage().getSearchResults(), matchers);\n    }\n"})}),"\n",(0,n.jsxs)(a.p,{children:["Aqui, estamos passando um n\xfamero arbitr\xe1rio de express\xf5es para o m\xe9todo. Essas express\xf5es s\xe3o na verdade 'matchers', inst\xe2ncias da classe BeanMatcher. N\xe3o que voc\xea normalmente precise se preocupar com esse n\xedvel de detalhe - voc\xea cria essas express\xf5es matcher usando um conjunto de m\xe9todos est\xe1ticos fornecidos na classe BeanMatchers. Ent\xe3o voc\xea normalmente passaria express\xf5es razoavelmente leg\xedveis como ",(0,n.jsx)(a.code,{children:'the("GroupId", startsWith("net.Serenity"))'})," ou ",(0,n.jsx)(a.code,{children:'each("ArtifactId").isDifferent()'}),"."]}),"\n",(0,n.jsxs)(a.p,{children:["O m\xe9todo ",(0,n.jsx)(a.code,{children:"shouldMatch()"})," da classe BeanMatcherAsserts recebe um \xfanico objeto Java, ou uma cole\xe7\xe3o de objetos Java, e verifica se pelo menos alguns dos objetos correspondem \xe0s restri\xe7\xf5es especificadas pelos matchers. No contexto de testes web, esses objetos s\xe3o tipicamente POJOs fornecidos pelo Page Object para representar o objeto ou objetos de dom\xednio exibidos em uma tela."]}),"\n",(0,n.jsx)(a.p,{children:"Existem v\xe1rias express\xf5es matcher diferentes para escolher. O matcher mais comumente usado apenas verifica o valor de um campo em um objeto. Por exemplo, suponha que voc\xea est\xe1 usando o objeto de dom\xednio mostrado aqui:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"     public class Person {\n        private final String firstName;\n        private final String lastName;\n\n        Person(String firstName, String lastName) {\n            this.firstName = firstName;\n            this.lastName = lastName;\n        }\n\n        public String getFirstName() {...}\n\n        public String getLastName() {...}\n    }\n"})}),"\n",(0,n.jsx)(a.p,{children:'Voc\xea poderia escrever um teste para garantir que uma lista de Persons contenha pelo menos uma pessoa chamada "Bill" usando o m\xe9todo est\xe1tico "the", como mostrado aqui:'}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'    List<Person> persons = Arrays.asList(new Person("Bill", "Oddie"), new Person("Tim", "Brooke-Taylor"));\n\n    shouldMatch(persons, the("firstName", is("Bill"))\n'})}),"\n",(0,n.jsx)(a.p,{children:"O segundo par\xe2metro no m\xe9todo the() \xe9 um matcher Hamcrest, o que lhe d\xe1 uma grande flexibilidade com suas express\xf5es. Por exemplo, voc\xea tamb\xe9m poderia escrever o seguinte:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'    List<Person> persons = Arrays.asList(new Person("Bill", "Oddie"), new Person("Tim", "Brooke-Taylor"));\n\n    shouldMatch(persons, the("firstName", is(not("Tim"))));\n    shouldMatch(persons, the("firstName", startsWith("B")));\n'})}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode passar m\xfaltiplas condi\xe7\xf5es:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'    List<Person> persons = Arrays.asList(new Person("Bill", "Oddie"), new Person("Tim", "Brooke-Taylor"));\n\n    shouldMatch(persons, the("firstName", is("Bill"), the("lastName", is("Oddie"));\n'})}),"\n",(0,n.jsxs)(a.p,{children:["O Serenity tamb\xe9m fornece a classe DateMatchers, que permite aplicar matches Hamcrest a Dates Java padr\xe3o e DateTimes do ",(0,n.jsx)(a.code,{children:"JodaTime"}),". Os seguintes exemplos de c\xf3digo ilustram como estes podem ser usados:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'    DateTime january1st2010 = new DateTime(2010,01,01,12,0).toDate();\n    DateTime may31st2010 = new DateTime(2010,05,31,12,0).toDate();\n\n    the("purchaseDate", isBefore(january1st2010))\n    the("purchaseDate", isAfter(january1st2010))\n    the("purchaseDate", isSameAs(january1st2010))\n    the("purchaseDate", isBetween(january1st2010, may31st2010))\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Voc\xea \xe0s vezes tamb\xe9m precisa verificar restri\xe7\xf5es que se aplicam a todos os elementos em considera\xe7\xe3o. A mais simples delas \xe9 verificar se todos os valores de campo para um campo espec\xedfico s\xe3o \xfanicos. Voc\xea pode fazer isso usando o m\xe9todo ",(0,n.jsx)(a.code,{children:"each()"}),":"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'    shouldMatch(persons, each("lastName").isDifferent())\n'})}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode verificar se o n\xfamero de elementos correspondentes corresponde ao que voc\xea est\xe1 esperando. Por exemplo, para verificar que h\xe1 apenas uma pessoa chamada Bill, voc\xea poderia fazer isso:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'     shouldMatch(persons, the("firstName", is("Bill"), the_count(is(1)));\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Voc\xea tamb\xe9m pode verificar os valores m\xednimo e m\xe1ximo usando os m\xe9todos max() e min(). Por exemplo, se a classe Person tivesse um m\xe9todo ",(0,n.jsx)(a.code,{children:"getAge()"}),", poder\xedamos garantir que toda pessoa tenha mais de 21 e menos de 65 anos fazendo o seguinte:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'     shouldMatch(persons, min("age", greaterThanOrEqualTo(21)),\n                          max("age", lessThanOrEqualTo(65)));\n'})}),"\n",(0,n.jsx)(a.p,{children:"Esses m\xe9todos funcionam com objetos Java normais, mas tamb\xe9m com Maps. Ent\xe3o o seguinte c\xf3digo tamb\xe9m funcionar\xe1:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'    Map<String, String> person = new HashMap<String, String>();\n    person.put("firstName", "Bill");\n    person.put("lastName", "Oddie");\n\n    List<Map<String,String>> persons = Arrays.asList(person);\n    shouldMatch(persons, the("firstName", is("Bill"))\n'})}),"\n",(0,n.jsx)(a.p,{children:"A outra coisa boa sobre esta abordagem \xe9 que os matchers funcionam bem com os relat\xf3rios do Serenity. Ent\xe3o, quando voc\xea usa a classe BeanMatcher como um par\xe2metro em seus passos de teste, as condi\xe7\xf5es expressas no passo ser\xe3o exibidas no relat\xf3rio de teste."}),"\n",(0,n.jsx)(a.p,{children:"Existem dois padr\xf5es de uso comuns ao construir Page Object e passos que usam este tipo de matcher. O primeiro \xe9 escrever um m\xe9todo de Page Object que retorna a lista de objetos de dom\xednio (por exemplo, Persons) exibidos na tabela. Por exemplo, o m\xe9todo getSearchResults() usado no passo should_see_artifacts_where() poderia ser implementado da seguinte forma:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'    public List<Artifact> getSearchResults() {\n        List<WebElement> rows = resultTable.findElements(By.xpath(".//tr[td]"));\n        List<Artifact> artifacts = new ArrayList<Artifact>();\n        for (WebElement row : rows) {\n            List<WebElement> cells = row.findElements(By.tagName("td"));\n            artifacts.add(new Artifact(cells.get(0).getText(),\n                                       cells.get(1).getText(),\n                                       cells.get(2).getText()));\n\n        }\n        return artifacts;\n    }\n'})}),"\n",(0,n.jsx)(a.p,{children:"O segundo \xe9 acessar o conte\xfado da tabela HTML diretamente, sem modelar explicitamente os dados contidos na tabela. Esta abordagem \xe9 mais r\xe1pida e mais eficaz se voc\xea n\xe3o espera reutilizar o objeto de dom\xednio em outras p\xe1ginas. Veremos como fazer isso a seguir."}),"\n",(0,n.jsx)(a.h3,{id:"trabalhando-com-tabelas-html",children:"Trabalhando com Tabelas HTML"}),"\n",(0,n.jsx)(a.p,{children:"Como tabelas HTML ainda s\xe3o amplamente usadas para representar conjuntos de dados em aplica\xe7\xf5es web, o Serenity vem com a classe HtmlTable, que fornece v\xe1rios m\xe9todos \xfateis que facilitam a escrita de Page Object que cont\xeam tabelas. Por exemplo, o m\xe9todo rowsFrom retorna o conte\xfado de uma tabela HTML como uma lista de Maps, onde cada mapa cont\xe9m os valores das c\xe9lulas para uma linha indexados pelo cabe\xe7alho correspondente, como mostrado aqui:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"...\nimport static net.thucydides.core.pages.components.HtmlTable.rowsFrom;\n\npublic class SearchResultsPage extends PageObject {\n\n    WebElement resultTable;\n\n    public SearchResultsPage(WebDriver driver) {\n        super(driver);\n    }\n\n    public List<Map<String, String>> getSearchResults() {\n        return rowsFrom(resultTable);\n    }\n\n}\n"})}),"\n",(0,n.jsxs)(a.p,{children:["Isso economiza muita digita\xe7\xe3o - nosso m\xe9todo ",(0,n.jsx)(a.code,{children:"getSearchResults()"})," agora fica assim:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"    public List<Map<String, String>> getSearchResults() {\n        return rowsFrom(resultTable);\n    }\n"})}),"\n",(0,n.jsx)(a.p,{children:"E como os matchers do Serenity funcionam tanto com objetos Java quanto com Maps, as express\xf5es matcher ser\xe3o muito semelhantes. A \xfanica diferen\xe7a \xe9 que os Maps retornados s\xe3o indexados pelos valores de texto contidos nos cabe\xe7alhos da tabela, em vez de por nomes de propriedade amig\xe1veis ao Java."}),"\n",(0,n.jsxs)(a.p,{children:["Voc\xea tamb\xe9m pode ler tabelas sem cabe\xe7alhos (ou seja, elementos ",(0,n.jsx)(a.code,{children:"<th>"}),") especificando seus pr\xf3prios cabe\xe7alhos usando o m\xe9todo ",(0,n.jsx)(a.code,{children:"withColumns"}),". Por exemplo:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'    List<Map<Object, String>> tableRows =\n                    HtmlTable.withColumns("First Name","Last Name", "Favorite Colour")\n                             .readRowsFrom(page.table_with_no_headings);\n'})}),"\n",(0,n.jsx)(a.p,{children:"Voc\xea tamb\xe9m pode usar a classe HtmlTable para selecionar linhas espec\xedficas dentro de uma tabela para trabalhar. Por exemplo, outro cen\xe1rio de teste para a p\xe1gina de Busca Maven envolve clicar em um artefato e exibir os detalhes para esse artefato. O teste para isso poderia parecer algo assim:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'    @Test\n    public void clicking_on_artifact_should_display_details_page() {\n        developer.opens_the_search_page();\n        developer.searches_for("Serenity");\n        developer.open_artifact_where(the("ArtifactId", is("Serenity")),\n                                      the("GroupId", is("net.Serenity")));\n\n        developer.should_see_artifact_details_where(the("artifactId", is("Serenity")),\n                                                    the("groupId", is("net.Serenity")));\n    }\n'})}),"\n",(0,n.jsx)(a.p,{children:"Agora o m\xe9todo open_artifact_where() precisa clicar em uma linha espec\xedfica na tabela. Este passo fica assim:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"    @Step\n    public void open_artifact_where(BeanMatcher... matchers) {\n        onSearchResultsPage().clickOnFirstRowMatching(matchers);\n    }\n"})}),"\n",(0,n.jsx)(a.p,{children:"Ent\xe3o estamos efetivamente delegando para o Page Object, que faz o trabalho real. O m\xe9todo correspondente do Page Object fica assim:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"import static net.thucydides.core.pages.components.HtmlTable.filterRows;\n...\n    public void clickOnFirstRowMatching(BeanMatcher... matchers) {\n        List<WebElement> matchingRows = filterRows(resultTable, matchers);\n        WebElement targetRow = matchingRows.get(0);\n        WebElement detailsLink = targetRow.findElement(By.xpath(\".//a[contains(@href,'artifactdetails')]\"));\n        detailsLink.click();\n    }\n"})}),"\n",(0,n.jsx)(a.p,{children:"A parte interessante aqui \xe9 a primeira linha do m\xe9todo, onde usamos o m\xe9todo filterRows(). Este m\xe9todo retornar\xe1 uma lista de WebElements que correspondem aos matchers que voc\xea passou. Este m\xe9todo torna relativamente f\xe1cil selecionar as linhas que voc\xea est\xe1 interessado para tratamento especial."}),"\n",(0,n.jsx)(a.h2,{id:"mudando-para-outra-p\xe1gina",children:"Mudando para outra p\xe1gina"}),"\n",(0,n.jsx)(a.p,{children:"Um m\xe9todo, switchToPage() \xe9 fornecido na classe PageObject para tornar conveniente retornar um novo PageObject ap\xf3s a navega\xe7\xe3o de dentro de um m\xe9todo de uma classe PageObject. Por exemplo,"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'@DefaultUrl("http://mail.acme.com/login.html")\npublic class EmailLoginPage extends PageObject {\n\n    ...\n    public void forgotPassword() {\n        ...\n        forgotPassword.click();\n        ForgotPasswordPage forgotPasswordPage = this.switchToPage(ForgotPasswordPage.class);\n        forgotPasswordPage.open();\n        ...\n    }\n    ...\n}\n'})}),"\n",(0,n.jsx)(a.h2,{id:"estrat\xe9gias-de-carregamento-de-cole\xe7\xe3o-de-webelement",children:"Estrat\xe9gias de carregamento de cole\xe7\xe3o de WebElement"}),"\n",(0,n.jsxs)(a.p,{children:["O Selenium permite que voc\xea use as anota\xe7\xf5es ",(0,n.jsx)(a.code,{children:"@FindBy"})," e ",(0,n.jsx)(a.code,{children:"@FindAll"})," para carregar cole\xe7\xf5es de elementos web, como ilustrado aqui:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"@FindBy(css='#colors a')\nList<WebElement> options\n"})}),"\n",(0,n.jsx)(a.p,{children:"Se voc\xea est\xe1 trabalhando com uma aplica\xe7\xe3o ass\xedncrona, essas listas podem levar tempo para carregar, ent\xe3o o Selenium pode lhe dar uma lista vazia porque os elementos ainda n\xe3o carregaram."}),"\n",(0,n.jsx)(a.p,{children:"O Serenity permite que voc\xea ajuste esse comportamento de duas maneiras. A primeira \xe9 usar o DSL de espera para carregar os elementos diretamente, por exemplo:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'withTimeoutOf(5, SECONDS).waitForPresenceOf(By.cssSelector("#colors a"))\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Alternativamente, voc\xea pode usar a propriedade ",(0,n.jsx)(a.code,{children:"serenity.webdriver.collection_loading_strategy"})," para definir como o Serenity carrega cole\xe7\xf5es de elementos web ao usar as anota\xe7\xf5es ",(0,n.jsx)(a.code,{children:"@FindBy"})," e ",(0,n.jsx)(a.code,{children:"@FindAll"}),". Existem tr\xeas op\xe7\xf5es:"]}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Optimistic"}),"\n",(0,n.jsx)(a.li,{children:"Pessimistic (padr\xe3o)"}),"\n",(0,n.jsx)(a.li,{children:"Paranoid"}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:"Optimistic s\xf3 esperar\xe1 at\xe9 que o campo seja definido. Este \xe9 o comportamento nativo do Selenium."}),"\n",(0,n.jsx)(a.p,{children:"Pessimistic esperar\xe1 at\xe9 que pelo menos o primeiro elemento seja exibido. Este \xe9 atualmente o padr\xe3o."}),"\n",(0,n.jsx)(a.p,{children:"Paranoid esperar\xe1 at\xe9 que todos os elementos sejam exibidos. Isso pode ser lento para listas longas."}),"\n",(0,n.jsx)(a.h2,{id:"trabalhando-com-m\xe9todos-de-fixture",children:"Trabalhando com m\xe9todos de fixture"}),"\n",(0,n.jsxs)(a.p,{children:["Quando um passo de UI falha em um teste Serenity, a inst\xe2ncia do WebDriver \xe9 desabilitada para o resto do teste. Isso evita esperas desnecess\xe1rias enquanto o teste percorre os passos subsequentes (o que ele precisa fazer para documentar os passos do teste). A exce\xe7\xe3o a esta regra \xe9 no caso de m\xe9todos de fixture, como m\xe9todos anotados com a anota\xe7\xe3o ",(0,n.jsx)(a.code,{children:"@AfterEach"})," no JUnit 5 (ou ",(0,n.jsx)(a.code,{children:"@After"})," no JUnit 4) ou Cucumber."]}),"\n",(0,n.jsxs)(a.p,{children:["Nesses m\xe9todos, a inst\xe2ncia do WebDriver pode ser usada normalmente. Al\xe9m das anota\xe7\xf5es conhecidas do JUnit e Cucumber, qualquer anota\xe7\xe3o come\xe7ando com a palavra ",(0,n.jsx)(a.code,{children:"After"})," ser\xe1 considerada um m\xe9todo de fixture."]}),"\n",(0,n.jsxs)(a.p,{children:["Por exemplo, suponha que voc\xea precise excluir as contas de cliente via UI no final de cada teste. Voc\xea j\xe1 tem uma biblioteca de passos ",(0,n.jsx)(a.code,{children:"AdminSteps"})," com um m\xe9todo ",(0,n.jsx)(a.code,{children:"deleteAllCustomerAccounts()"})," que realiza esta tarefa. Voc\xea poderia garantir que todas as contas de cliente sejam exclu\xeddas assim:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"@Steps\nAdminSteps asAdministrator;\n\n...\n\n@AfterEach\nvoid deleteUserAccounts() {\n    asAdministrator.deleteAllCustomerAccounts();\n}\n"})}),"\n",(0,n.jsx)(a.p,{children:"Isso torna f\xe1cil realizar opera\xe7\xf5es de teardown ou limpeza que usam a interface do usu\xe1rio, potencialmente reutilizando passos ou Task que s\xe3o usados em outros lugares nos testes."}),"\n",(0,n.jsxs)(a.p,{children:["Voc\xea tamb\xe9m pode sobrescrever esse comportamento a qualquer momento chamando o m\xe9todo ",(0,n.jsx)(a.code,{children:"reenableDrivers()"}),", como mostrado aqui:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"Serenity.webdriver().reenableDrivers();\n"})}),"\n",(0,n.jsx)(a.h2,{id:"estendendo-a-integra\xe7\xe3o-webdriver-do-serenity",children:"Estendendo a Integra\xe7\xe3o WebDriver do Serenity"}),"\n",(0,n.jsxs)(a.p,{children:["O Serenity oferece uma maneira simples de estender as capacidades padr\xe3o do WebDriver e personalizar as atividades de cria\xe7\xe3o e encerramento do driver. Simplesmente implemente as interfaces ",(0,n.jsx)(a.code,{children:"BeforeAWebdriverScenario"})," e/ou ",(0,n.jsx)(a.code,{children:"AfterAWebDriverScenario"})," (ambas est\xe3o no pacote ",(0,n.jsx)(a.code,{children:"net.serenitybdd.core.webdriver.enhancers"}),"). O Serenity executar\xe1 classes ",(0,n.jsx)(a.code,{children:"BeforeAWebdriverScenario"})," logo antes de uma inst\xe2ncia de driver ser criada, permitindo que voc\xea adicione op\xe7\xf5es personalizadas \xe0s capacidades do driver. Quaisquer ",(0,n.jsx)(a.code,{children:"AfterAWebDriverScenario"})," s\xe3o executadas no final de um teste, logo antes do driver ser fechado."]}),"\n",(0,n.jsx)(a.h3,{id:"a-interface-beforeawebdriverscenario",children:"A interface BeforeAWebdriverScenario"}),"\n",(0,n.jsxs)(a.p,{children:["O ",(0,n.jsx)(a.code,{children:"BeforeAWebdriverScenario"})," \xe9 usado para aprimorar o objeto ",(0,n.jsx)(a.code,{children:"Capabilities"})," que ser\xe1 passado para a inst\xe2ncia do WebDriver quando um novo driver for criado. A chamada do m\xe9todo passa o driver solicitado e o objeto ",(0,n.jsx)(a.code,{children:"TestOutcome"}),", que cont\xe9m informa\xe7\xf5es sobre o nome e as tags usadas para este teste. Tamb\xe9m passa as ",(0,n.jsx)(a.code,{children:"EnvironmentVariables"}),", que lhe d\xe3o acesso \xe0 configura\xe7\xe3o do ambiente atual. Um exemplo de um simples ",(0,n.jsx)(a.code,{children:"BeforeAWebdriverScenario"})," \xe9 mostrado abaixo:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'public class MyCapabilityEnhancer implements BeforeAWebdriverScenario {\n\n    @Override\n    public DesiredCapabilities apply(EnvironmentVariables environmentVariables,\n                                     SupportedWebDriver driver,\n                                     TestOutcome testOutcome,\n                                     MutableCapabilities capabilities) {\n        capabilities.setCapability("name", testOutcome.getStoryTitle() + " - " + testOutcome.getTitle());\n        return capabilities;\n    }\n}\n'})}),"\n",(0,n.jsx)(a.h3,{id:"a-interface-afterawebdriverscenario",children:"A interface AfterAWebdriverScenario"}),"\n",(0,n.jsxs)(a.p,{children:["O ",(0,n.jsx)(a.code,{children:"AfterAWebdriverScenario"})," \xe9 chamado no final de um teste, logo antes do driver ser fechado, e uma vez que o resultado do teste \xe9 conhecido. O resultado do teste (e outros detalhes) pode ser obtido do par\xe2metro ",(0,n.jsx)(a.code,{children:"TestOutcome"}),". Isso permite que quaisquer \xfaltimas manipula\xe7\xf5es ou verifica\xe7\xf5es sejam realizadas no driver, antes do final do teste. O seguinte exemplo verifica o resultado do teste que acabou de terminar e adiciona um cookie com um valor dependendo do resultado do teste:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'public class MyTestResultUpdater implements AfterAWebdriverScenario {\n    void apply(EnvironmentVariables environmentVariables,\n               TestOutcome testOutcome,\n               WebDriver driver) {\n       if ((driver == null) || (!RemoteDriver.isARemoteDriver(driver))) {\n           return;\n       }\n\n       Cookie cookie = new Cookie("testPassed",\n                                   testOutcome.isFailure() || testOutcome.isError() || testOutcome.isCompromised() ? "false" : "true");\n       driver.manage().addCookie(cookie);\n    }\n}\n'})}),"\n",(0,n.jsx)(a.h3,{id:"driver-enhancers",children:"Driver Enhancers"}),"\n",(0,n.jsxs)(a.p,{children:["Se voc\xea precisa realizar alguma a\xe7\xe3o na inst\xe2ncia do driver antes de cada teste, voc\xea pode implementar a classe ",(0,n.jsx)(a.code,{children:"CustomDriverEnhancer"}),". Note que isso ser\xe1 chamado imediatamente ap\xf3s o driver ser criado, e antes de qualquer p\xe1gina ser aberta, ent\xe3o o n\xfamero de a\xe7\xf5es \xe9 relativamente limitado."]}),"\n",(0,n.jsx)(a.h3,{id:"configurando-os-pacotes-de-extens\xe3o",children:"Configurando os pacotes de extens\xe3o"}),"\n",(0,n.jsxs)(a.p,{children:["A \xfaltima coisa que voc\xea precisa fazer \xe9 dizer ao Serenity em qual pacote ele precisa procurar suas classes de extens\xe3o. Adicione o pacote, ou um pacote pai, \xe0 sua configura\xe7\xe3o do Serenity usando o ",(0,n.jsx)(a.code,{children:"serenity.extension.packages"}),"."]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.code,{children:"serenity.extension.packages=com.acme.myserenityextensions"})}),"\n",(0,n.jsxs)(a.p,{children:["Voc\xea pode encontrar um exemplo de como essas classes s\xe3o implementadas em um caso de uso real no m\xf3dulo ",(0,n.jsx)(a.a,{href:"https://github.com/serenity-bdd/serenity-core/tree/master/serenity-browserstack/src/main/java/net/serenitybdd/browserstack",children:"serenity-browserstack"})," no Github."]}),"\n",(0,n.jsx)(a.h3,{id:"implementa\xe7\xf5es-personalizadas-de-webdriver",children:"Implementa\xe7\xf5es personalizadas de WebDriver"}),"\n",(0,n.jsxs)(a.p,{children:["Voc\xea pode adicionar seu pr\xf3prio provedor de WebDriver personalizado implementando a interface DriverSource. Primeiro, voc\xea precisa configurar as seguintes propriedades do sistema (por exemplo, no seu arquivo ",(0,n.jsx)(a.code,{children:"serenity.properties"}),"):"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"webdriver.driver = provided\nwebdriver.provided.type = mydriver\nwebdriver.provided.mydriver = com.acme.MyPhantomJSDriver\nthucydides.driver.capabilities = mydriver\n"})}),"\n",(0,n.jsx)(a.p,{children:"Seu driver personalizado deve implementar a interface DriverSource, como mostrado aqui:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"public class MyPhantomJSDriver implements DriverSource {\n\n    @Override\n    public WebDriver newDriver() {\n        try {\n            DesiredCapabilities capabilities = DesiredCapabilities.phantomjs();\n            // Adicionar\n            return new PhantomJSDriver(ResolvingPhantomJSDriverService.createDefaultService(), capabilities);\n        }\n        catch (IOException e) {\n            throw new Error(e);\n        }\n    }\n\n\t@Override\n    public boolean takesScreenshots() {\n        return true;\n    }\n}\n"})}),"\n",(0,n.jsxs)(a.p,{children:["Note que se voc\xea usar drivers personalizados voc\xea ser\xe1 totalmente respons\xe1vel por configurar e instanciar a inst\xe2ncia do navegador, e as op\xe7\xf5es de configura\xe7\xe3o do Serenity relacionadas ao driver n\xe3o ser\xe3o aplicadas. Geralmente recomendamos usar drivers personalizados apenas para circunst\xe2ncias muito excepcionais, e usar classes ",(0,n.jsx)(a.code,{children:"BeforeAWebdriverScenario"})," para a maioria dos requisitos de configura\xe7\xe3o personalizada."]}),"\n",(0,n.jsx)(a.h2,{id:"usando-a-interface-hasauthentication",children:"Usando a interface HasAuthentication"}),"\n",(0,n.jsxs)(a.p,{children:["O Selenium 4 suporta a interface ",(0,n.jsx)(a.code,{children:"HasAuthentication"}),", que indica que um driver suporta autentica\xe7\xe3o em um site de alguma forma. Os drivers do Serenity integram-se perfeitamente com a interface ",(0,n.jsx)(a.code,{children:"HasAuthentication"}),", ent\xe3o voc\xea pode us\xe1-la da mesma forma que usaria no Selenium 4. Por exemplo, para registrar um nome de usu\xe1rio e senha para usar em todas as p\xe1ginas, voc\xea poderia adicionar o seguinte c\xf3digo antes de abrir um site:"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'    getDriver().register(UsernameAndPassword.of("scott", "tiger")\n'})}),"\n",(0,n.jsx)(a.p,{children:"Se a autentica\xe7\xe3o \xe9 necess\xe1ria apenas em certas p\xe1ginas, voc\xea tamb\xe9m pode usar um predicado:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:'        Predicate<URI> onlyAuthenticateOnTheLoginPage = uri -> uri.getPath().endsWith("/login");\n        getDriver().register(onlyAuthenticateOnTheLoginPage, UsernameAndPassword.of("scott", "tiger"));\n'})})]})}function m(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453(e,a,s){s.d(a,{R:()=>i,x:()=>t});var o=s(6540);const n={},r=o.createContext(n);function i(e){const a=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),o.createElement(r.Provider,{value:a},e.children)}}}]);