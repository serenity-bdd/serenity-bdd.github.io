"use strict";(globalThis.webpackChunkserenity_users_guide=globalThis.webpackChunkserenity_users_guide||[]).push([[7853],{5402(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"tutorials/cicd-integration","title":"Integracao CI/CD com Serenity BDD","description":"Este guia mostra como integrar testes Serenity BDD em plataformas populares de CI/CD, incluindo GitHub Actions, Jenkins e GitLab CI. Aprenda como executar testes automaticamente, publicar relatorios e obter feedback rapido sobre suas alteracoes de codigo.","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/tutorials/cicd-integration.md","sourceDirName":"tutorials","slug":"/tutorials/cicd-integration","permalink":"/pt-BR/docs/tutorials/cicd-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/serenity-bdd/serenity-bdd.github.io/blob/master/docs/tutorials/cicd-integration.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"id":"cicd-integration","title":"Integracao CI/CD com Serenity BDD","sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Migrando do Serenity BDD 3.x para o Serenity BDD 4.x","permalink":"/pt-BR/docs/tutorials/migrating_to_serenity_4"},"next":{"title":"Como Fazer Execucao Paralela de Testes no Cucumber com Serenity","permalink":"/pt-BR/docs/tutorials/running_cucumber_scenarios_in_parallel"}}');var i=s(4848),t=s(8453);const r={id:"cicd-integration",title:"Integracao CI/CD com Serenity BDD",sidebar_position:6},o="Integracao CI/CD com Serenity BDD",l={},c=[{value:"Pre-requisitos",id:"pre-requisitos",level:2},{value:"Lista de Verificacao Rapida",id:"lista-de-verificacao-rapida",level:2},{value:"GitHub Actions",id:"github-actions",level:2},{value:"Configuracao Basica",id:"configuracao-basica",level:3},{value:"Versao Gradle",id:"versao-gradle",level:3},{value:"Publicando Relatorios no GitHub Pages",id:"publicando-relatorios-no-github-pages",level:3},{value:"Execucao Paralela no GitHub Actions",id:"execucao-paralela-no-github-actions",level:3},{value:"Configuracao Avancada com Variaveis de Ambiente",id:"configuracao-avancada-com-variaveis-de-ambiente",level:3},{value:"Notificacoes",id:"notificacoes",level:3},{value:"Jenkins",id:"jenkins",level:2},{value:"Pipeline Declarativo",id:"pipeline-declarativo",level:3},{value:"Pipeline Gradle",id:"pipeline-gradle",level:3},{value:"Execucao Paralela no Jenkins",id:"execucao-paralela-no-jenkins",level:3},{value:"Configuracao do Jenkins com Parametros",id:"configuracao-do-jenkins-com-parametros",level:3},{value:"Instalando Plugins do Jenkins",id:"instalando-plugins-do-jenkins",level:3},{value:"GitLab CI",id:"gitlab-ci",level:2},{value:"Configuracao Basica",id:"configuracao-basica-1",level:3},{value:"Versao Gradle",id:"versao-gradle-1",level:3},{value:"Multiplos Ambientes",id:"multiplos-ambientes",level:3},{value:"Jobs Paralelos",id:"jobs-paralelos",level:3},{value:"Azure Pipelines",id:"azure-pipelines",level:2},{value:"Integracao com Docker",id:"integracao-com-docker",level:2},{value:"Dockerfile para Testes",id:"dockerfile-para-testes",level:3},{value:"Docker Compose",id:"docker-compose",level:3},{value:"GitHub Actions com Docker",id:"github-actions-com-docker",level:3},{value:"Melhores Praticas",id:"melhores-praticas",level:2},{value:"1. Use Navegadores Headless",id:"1-use-navegadores-headless",level:3},{value:"2. Otimize os Tempos de Build",id:"2-otimize-os-tempos-de-build",level:3},{value:"3. Falhe Rapido",id:"3-falhe-rapido",level:3},{value:"4. Execucao Baseada em Tags",id:"4-execucao-baseada-em-tags",level:3},{value:"5. Separe os Estagios de Teste",id:"5-separe-os-estagios-de-teste",level:3},{value:"6. Gerencie Secrets com Seguranca",id:"6-gerencie-secrets-com-seguranca",level:3},{value:"7. Reexecute Testes Flakey",id:"7-reexecute-testes-flakey",level:3},{value:"8. Gere Badges de Build",id:"8-gere-badges-de-build",level:3},{value:"Solucao de Problemas",id:"solucao-de-problemas",level:2},{value:"Problema: Testes falham apenas no CI",id:"problema-testes-falham-apenas-no-ci",level:3},{value:"Problema: Relatorios nao publicando",id:"problema-relatorios-nao-publicando",level:3},{value:"Problema: Builds lentos",id:"problema-builds-lentos",level:3},{value:"Exemplo Completo: GitHub Actions com Todas as Funcionalidades",id:"exemplo-completo-github-actions-com-todas-as-funcionalidades",level:2},{value:"Proximos Passos",id:"proximos-passos",level:2},{value:"Recursos Adicionais",id:"recursos-adicionais",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"integracao-cicd-com-serenity-bdd",children:"Integracao CI/CD com Serenity BDD"})}),"\n",(0,i.jsx)(n.p,{children:"Este guia mostra como integrar testes Serenity BDD em plataformas populares de CI/CD, incluindo GitHub Actions, Jenkins e GitLab CI. Aprenda como executar testes automaticamente, publicar relatorios e obter feedback rapido sobre suas alteracoes de codigo."}),"\n",(0,i.jsx)(n.h2,{id:"pre-requisitos",children:"Pre-requisitos"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Projeto Serenity BDD configurado com Maven ou Gradle"}),"\n",(0,i.jsx)(n.li,{children:"Repositorio de controle de versao (Git)"}),"\n",(0,i.jsx)(n.li,{children:"Acesso a uma plataforma de CI/CD"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"lista-de-verificacao-rapida",children:"Lista de Verificacao Rapida"}),"\n",(0,i.jsx)(n.p,{children:"Antes de configurar o CI/CD, certifique-se de que seu projeto:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Executa com sucesso localmente com ",(0,i.jsx)(n.code,{children:"mvn clean verify"})," ou ",(0,i.jsx)(n.code,{children:"gradle clean test"})]}),"\n",(0,i.jsx)(n.li,{children:"Tem todas as dependencias configuradas corretamente"}),"\n",(0,i.jsx)(n.li,{children:"Usa modo headless do navegador para testes web"}),"\n",(0,i.jsx)(n.li,{children:"Tem timeouts de execucao de teste razoaveis"}),"\n",(0,i.jsxs)(n.li,{children:["Gera relatorios Serenity em ",(0,i.jsx)(n.code,{children:"target/site/serenity"})," (Maven) ou ",(0,i.jsx)(n.code,{children:"build/reports/serenity"})," (Gradle)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"github-actions",children:"GitHub Actions"}),"\n",(0,i.jsx)(n.p,{children:"O GitHub Actions e a maneira mais facil de configurar CI/CD para projetos hospedados no GitHub."}),"\n",(0,i.jsx)(n.h3,{id:"configuracao-basica",children:"Configuracao Basica"}),"\n",(0,i.jsxs)(n.p,{children:["Crie ",(0,i.jsx)(n.code,{children:".github/workflows/serenity-tests.yml"})," em seu repositorio:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"name: Serenity BDD Tests\n\non:\n  push:\n    branches: [ main, develop ]\n  pull_request:\n    branches: [ main, develop ]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n\n    steps:\n    - name: Checkout code\n      uses: actions/checkout@v4\n\n    - name: Set up JDK 17\n      uses: actions/setup-java@v4\n      with:\n        java-version: '17'\n        distribution: 'temurin'\n        cache: 'maven'\n\n    - name: Run Serenity tests\n      run: mvn clean verify\n\n    - name: Publish Serenity Report\n      if: always()\n      uses: actions/upload-artifact@v4\n      with:\n        name: serenity-report\n        path: target/site/serenity\n        retention-days: 30\n"})}),"\n",(0,i.jsx)(n.h3,{id:"versao-gradle",children:"Versao Gradle"}),"\n",(0,i.jsx)(n.p,{children:"Para projetos Gradle:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"name: Serenity BDD Tests\n\non:\n  push:\n    branches: [ main, develop ]\n  pull_request:\n    branches: [ main, develop ]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n\n    steps:\n    - name: Checkout code\n      uses: actions/checkout@v4\n\n    - name: Set up JDK 17\n      uses: actions/setup-java@v4\n      with:\n        java-version: '17'\n        distribution: 'temurin'\n        cache: 'gradle'\n\n    - name: Run Serenity tests\n      run: ./gradlew clean test aggregate\n\n    - name: Publish Serenity Report\n      if: always()\n      uses: actions/upload-artifact@v4\n      with:\n        name: serenity-report\n        path: build/reports/serenity\n        retention-days: 30\n"})}),"\n",(0,i.jsx)(n.h3,{id:"publicando-relatorios-no-github-pages",children:"Publicando Relatorios no GitHub Pages"}),"\n",(0,i.jsx)(n.p,{children:"Publique automaticamente relatorios Serenity como um website:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"name: Serenity Tests with GitHub Pages\n\non:\n  push:\n    branches: [ main ]\n\npermissions:\n  contents: write\n  pages: write\n  id-token: write\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n\n    steps:\n    - name: Checkout code\n      uses: actions/checkout@v4\n\n    - name: Set up JDK 17\n      uses: actions/setup-java@v4\n      with:\n        java-version: '17'\n        distribution: 'temurin'\n        cache: 'maven'\n\n    - name: Run Serenity tests\n      run: mvn clean verify\n\n    - name: Deploy to GitHub Pages\n      if: always()\n      uses: peaceiris/actions-gh-pages@v3\n      with:\n        github_token: ${{ secrets.GITHUB_TOKEN }}\n        publish_dir: ./target/site/serenity\n        destination_dir: reports/${{ github.run_number }}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Acesse seus relatorios em:"})," ",(0,i.jsx)(n.code,{children:"https://<username>.github.io/<repository>/reports/<run-number>"})]}),"\n",(0,i.jsx)(n.h3,{id:"execucao-paralela-no-github-actions",children:"Execucao Paralela no GitHub Actions"}),"\n",(0,i.jsx)(n.p,{children:"Execute testes em paralelo usando uma estrategia de matriz:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"name: Serenity Parallel Tests\n\non:\n  push:\n    branches: [ main ]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        browser: [chrome, firefox, edge]\n        test-suite: [smoke, regression]\n      fail-fast: false\n\n    steps:\n    - name: Checkout code\n      uses: actions/checkout@v4\n\n    - name: Set up JDK 17\n      uses: actions/setup-java@v4\n      with:\n        java-version: '17'\n        distribution: 'temurin'\n        cache: 'maven'\n\n    - name: Run tests\n      run: mvn verify -Dwebdriver.driver=${{ matrix.browser }} -Dtags=${{ matrix.test-suite }}\n\n    - name: Upload Report\n      if: always()\n      uses: actions/upload-artifact@v4\n      with:\n        name: report-${{ matrix.browser }}-${{ matrix.test-suite }}\n        path: target/site/serenity\n"})}),"\n",(0,i.jsx)(n.h3,{id:"configuracao-avancada-com-variaveis-de-ambiente",children:"Configuracao Avancada com Variaveis de Ambiente"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"name: Serenity Tests - All Environments\n\non:\n  push:\n    branches: [ main ]\n  workflow_dispatch:\n    inputs:\n      environment:\n        description: 'Environment to test'\n        required: true\n        type: choice\n        options:\n          - dev\n          - staging\n          - production\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n\n    steps:\n    - name: Checkout code\n      uses: actions/checkout@v4\n\n    - name: Set up JDK 17\n      uses: actions/setup-java@v4\n      with:\n        java-version: '17'\n        distribution: 'temurin'\n        cache: 'maven'\n\n    - name: Run tests\n      env:\n        BASE_URL: ${{ secrets[format('{0}_BASE_URL', github.event.inputs.environment || 'dev')] }}\n        API_KEY: ${{ secrets[format('{0}_API_KEY', github.event.inputs.environment || 'dev')] }}\n        TEST_USER: ${{ secrets.TEST_USER }}\n        TEST_PASSWORD: ${{ secrets.TEST_PASSWORD }}\n      run: |\n        mvn clean verify \\\n          -Dwebdriver.base.url=$BASE_URL \\\n          -Dapi.key=$API_KEY \\\n          -Dtest.user=$TEST_USER \\\n          -Dtest.password=$TEST_PASSWORD\n\n    - name: Upload Report\n      if: always()\n      uses: actions/upload-artifact@v4\n      with:\n        name: serenity-report-${{ github.event.inputs.environment || 'dev' }}\n        path: target/site/serenity\n"})}),"\n",(0,i.jsx)(n.h3,{id:"notificacoes",children:"Notificacoes"}),"\n",(0,i.jsx)(n.p,{children:"Envie notificacoes Slack sobre resultados de teste:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'    - name: Notify Slack on Success\n      if: success()\n      uses: slackapi/slack-github-action@v1\n      with:\n        webhook-url: ${{ secrets.SLACK_WEBHOOK }}\n        payload: |\n          {\n            "text": "Serenity Tests Passed - Build #${{ github.run_number }}"\n          }\n\n    - name: Notify Slack on Failure\n      if: failure()\n      uses: slackapi/slack-github-action@v1\n      with:\n        webhook-url: ${{ secrets.SLACK_WEBHOOK }}\n        payload: |\n          {\n            "text": "Serenity Tests Failed - Build #${{ github.run_number }}\\nView: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"\n          }\n'})}),"\n",(0,i.jsx)(n.h2,{id:"jenkins",children:"Jenkins"}),"\n",(0,i.jsx)(n.p,{children:"O Jenkins e uma plataforma popular de CI/CD auto-hospedada com amplo suporte a plugins."}),"\n",(0,i.jsx)(n.h3,{id:"pipeline-declarativo",children:"Pipeline Declarativo"}),"\n",(0,i.jsxs)(n.p,{children:["Crie um ",(0,i.jsx)(n.code,{children:"Jenkinsfile"})," na raiz do seu repositorio:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-groovy",children:"pipeline {\n    agent any\n\n    tools {\n        maven 'Maven-3.9'\n        jdk 'JDK-17'\n    }\n\n    stages {\n        stage('Checkout') {\n            steps {\n                checkout scm\n            }\n        }\n\n        stage('Build and Test') {\n            steps {\n                sh 'mvn clean verify'\n            }\n        }\n\n        stage('Publish Reports') {\n            steps {\n                publishHTML([\n                    reportDir: 'target/site/serenity',\n                    reportFiles: 'index.html',\n                    reportName: 'Serenity Report',\n                    keepAll: true,\n                    alwaysLinkToLastBuild: true,\n                    allowMissing: false\n                ])\n            }\n        }\n    }\n\n    post {\n        always {\n            junit '**/target/failsafe-reports/*.xml'\n            archiveArtifacts artifacts: 'target/site/serenity/**/*', allowEmptyArchive: true\n        }\n        failure {\n            emailext(\n                subject: \"Failed: ${currentBuild.fullDisplayName}\",\n                body: \"Test execution failed. Check console output at ${env.BUILD_URL}\",\n                to: 'team@example.com'\n            )\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"pipeline-gradle",children:"Pipeline Gradle"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-groovy",children:"pipeline {\n    agent any\n\n    tools {\n        gradle 'Gradle-8'\n        jdk 'JDK-17'\n    }\n\n    stages {\n        stage('Checkout') {\n            steps {\n                checkout scm\n            }\n        }\n\n        stage('Build and Test') {\n            steps {\n                sh './gradlew clean test aggregate'\n            }\n        }\n\n        stage('Publish Reports') {\n            steps {\n                publishHTML([\n                    reportDir: 'build/reports/serenity',\n                    reportFiles: 'index.html',\n                    reportName: 'Serenity Report',\n                    keepAll: true,\n                    alwaysLinkToLastBuild: true\n                ])\n            }\n        }\n    }\n\n    post {\n        always {\n            junit '**/build/test-results/test/*.xml'\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"execucao-paralela-no-jenkins",children:"Execucao Paralela no Jenkins"}),"\n",(0,i.jsx)(n.p,{children:"Execute testes em paralelo em multiplos nodes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-groovy",children:"pipeline {\n    agent none\n\n    stages {\n        stage('Parallel Tests') {\n            parallel {\n                stage('Chrome Tests') {\n                    agent { label 'chrome' }\n                    steps {\n                        sh 'mvn verify -Dwebdriver.driver=chrome'\n                    }\n                }\n                stage('Firefox Tests') {\n                    agent { label 'firefox' }\n                    steps {\n                        sh 'mvn verify -Dwebdriver.driver=firefox'\n                    }\n                }\n                stage('Edge Tests') {\n                    agent { label 'edge' }\n                    steps {\n                        sh 'mvn verify -Dwebdriver.driver=edge'\n                    }\n                }\n            }\n        }\n\n        stage('Aggregate Reports') {\n            agent any\n            steps {\n                publishHTML([\n                    reportDir: 'target/site/serenity',\n                    reportFiles: 'index.html',\n                    reportName: 'Consolidated Serenity Report'\n                ])\n            }\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"configuracao-do-jenkins-com-parametros",children:"Configuracao do Jenkins com Parametros"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-groovy",children:"pipeline {\n    agent any\n\n    parameters {\n        choice(\n            name: 'ENVIRONMENT',\n            choices: ['dev', 'staging', 'production'],\n            description: 'Environment to test'\n        )\n        choice(\n            name: 'BROWSER',\n            choices: ['chrome', 'firefox', 'edge'],\n            description: 'Browser to use'\n        )\n        string(\n            name: 'TAGS',\n            defaultValue: '',\n            description: 'Tags to filter tests (e.g., @smoke, @regression)'\n        )\n    }\n\n    stages {\n        stage('Test') {\n            steps {\n                script {\n                    def baseUrl = \"\"\n                    switch(params.ENVIRONMENT) {\n                        case 'dev':\n                            baseUrl = 'https://dev.example.com'\n                            break\n                        case 'staging':\n                            baseUrl = 'https://staging.example.com'\n                            break\n                        case 'production':\n                            baseUrl = 'https://www.example.com'\n                            break\n                    }\n\n                    sh \"\"\"\n                        mvn clean verify \\\n                        -Dwebdriver.driver=${params.BROWSER} \\\n                        -Dwebdriver.base.url=${baseUrl} \\\n                        -Dcucumber.filter.tags='${params.TAGS}'\n                    \"\"\"\n                }\n            }\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"instalando-plugins-do-jenkins",children:"Instalando Plugins do Jenkins"}),"\n",(0,i.jsx)(n.p,{children:"Plugins necessarios:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Instale via Jenkins CLI ou UI\n- HTML Publisher Plugin\n- JUnit Plugin\n- Pipeline Plugin\n- Git Plugin\n- Email Extension Plugin\n"})}),"\n",(0,i.jsx)(n.h2,{id:"gitlab-ci",children:"GitLab CI"}),"\n",(0,i.jsx)(n.p,{children:"O GitLab CI e integrado diretamente nos repositorios GitLab."}),"\n",(0,i.jsx)(n.h3,{id:"configuracao-basica-1",children:"Configuracao Basica"}),"\n",(0,i.jsxs)(n.p,{children:["Crie ",(0,i.jsx)(n.code,{children:".gitlab-ci.yml"})," na raiz do seu repositorio:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'image: maven:3.9-eclipse-temurin-17\n\nstages:\n  - test\n  - report\n\nvariables:\n  MAVEN_OPTS: "-Dmaven.repo.local=$CI_PROJECT_DIR/.m2/repository"\n\ncache:\n  paths:\n    - .m2/repository\n\ntest:\n  stage: test\n  script:\n    - mvn clean verify\n  artifacts:\n    when: always\n    paths:\n      - target/site/serenity\n    expire_in: 30 days\n    reports:\n      junit:\n        - target/failsafe-reports/TEST-*.xml\n\npages:\n  stage: report\n  script:\n    - mkdir -p public\n    - cp -r target/site/serenity/* public/\n  artifacts:\n    paths:\n      - public\n  only:\n    - main\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Os relatorios estarao disponiveis em:"})," ",(0,i.jsx)(n.code,{children:"https://<username>.gitlab.io/<project>/"})]}),"\n",(0,i.jsx)(n.h3,{id:"versao-gradle-1",children:"Versao Gradle"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'image: gradle:8-jdk17\n\nstages:\n  - test\n  - report\n\nvariables:\n  GRADLE_OPTS: "-Dorg.gradle.daemon=false"\n\ncache:\n  paths:\n    - .gradle\n\ntest:\n  stage: test\n  script:\n    - gradle clean test aggregate\n  artifacts:\n    when: always\n    paths:\n      - build/reports/serenity\n    expire_in: 30 days\n    reports:\n      junit:\n        - build/test-results/test/TEST-*.xml\n\npages:\n  stage: report\n  script:\n    - mkdir -p public\n    - cp -r build/reports/serenity/* public/\n  artifacts:\n    paths:\n      - public\n  only:\n    - main\n'})}),"\n",(0,i.jsx)(n.h3,{id:"multiplos-ambientes",children:"Multiplos Ambientes"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'stages:\n  - test\n\n.test_template:\n  image: maven:3.9-eclipse-temurin-17\n  script:\n    - mvn clean verify -Dwebdriver.base.url=$BASE_URL\n  artifacts:\n    when: always\n    paths:\n      - target/site/serenity\n    expire_in: 7 days\n\ntest:dev:\n  extends: .test_template\n  variables:\n    BASE_URL: "https://dev.example.com"\n  only:\n    - develop\n\ntest:staging:\n  extends: .test_template\n  variables:\n    BASE_URL: "https://staging.example.com"\n  only:\n    - staging\n\ntest:production:\n  extends: .test_template\n  variables:\n    BASE_URL: "https://www.example.com"\n  only:\n    - main\n  when: manual\n'})}),"\n",(0,i.jsx)(n.h3,{id:"jobs-paralelos",children:"Jobs Paralelos"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"test:\n  stage: test\n  parallel:\n    matrix:\n      - BROWSER: [chrome, firefox]\n        SUITE: [smoke, regression]\n  script:\n    - mvn verify -Dwebdriver.driver=$BROWSER -Dtags=@$SUITE\n  artifacts:\n    when: always\n    paths:\n      - target/site/serenity\n    reports:\n      junit:\n        - target/failsafe-reports/TEST-*.xml\n"})}),"\n",(0,i.jsx)(n.h2,{id:"azure-pipelines",children:"Azure Pipelines"}),"\n",(0,i.jsx)(n.p,{children:"Para projetos hospedados no Azure DevOps:"}),"\n",(0,i.jsxs)(n.p,{children:["Crie ",(0,i.jsx)(n.code,{children:"azure-pipelines.yml"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"trigger:\n  - main\n  - develop\n\npool:\n  vmImage: 'ubuntu-latest'\n\nvariables:\n  MAVEN_CACHE_FOLDER: $(Pipeline.Workspace)/.m2/repository\n  MAVEN_OPTS: '-Dmaven.repo.local=$(MAVEN_CACHE_FOLDER)'\n\nsteps:\n- task: JavaToolInstaller@0\n  inputs:\n    versionSpec: '17'\n    jdkArchitectureOption: 'x64'\n    jdkSourceOption: 'PreInstalled'\n\n- task: Cache@2\n  inputs:\n    key: 'maven | \"$(Agent.OS)\" | **/pom.xml'\n    path: $(MAVEN_CACHE_FOLDER)\n  displayName: Cache Maven packages\n\n- task: Maven@3\n  inputs:\n    mavenPomFile: 'pom.xml'\n    goals: 'clean verify'\n    options: '-B'\n  displayName: 'Run Serenity Tests'\n\n- task: PublishTestResults@2\n  condition: always()\n  inputs:\n    testResultsFormat: 'JUnit'\n    testResultsFiles: '**/target/failsafe-reports/TEST-*.xml'\n    testRunTitle: 'Serenity Test Results'\n\n- task: PublishBuildArtifacts@1\n  condition: always()\n  inputs:\n    PathtoPublish: 'target/site/serenity'\n    ArtifactName: 'serenity-report'\n  displayName: 'Publish Serenity Report'\n"})}),"\n",(0,i.jsx)(n.h2,{id:"integracao-com-docker",children:"Integracao com Docker"}),"\n",(0,i.jsx)(n.p,{children:"Execute testes em containers Docker para consistencia."}),"\n",(0,i.jsx)(n.h3,{id:"dockerfile-para-testes",children:"Dockerfile para Testes"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dockerfile",children:'FROM maven:3.9-eclipse-temurin-17\n\n# Install Chrome\nRUN wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add - \\\n    && echo "deb http://dl.google.com/linux/chrome/deb/ stable main" >> /etc/apt/sources.list.d/google.list \\\n    && apt-get update \\\n    && apt-get install -y google-chrome-stable \\\n    && rm -rf /var/lib/apt/lists/*\n\nWORKDIR /app\n\nCOPY pom.xml .\nRUN mvn dependency:go-offline\n\nCOPY src ./src\n\nCMD ["mvn", "clean", "verify"]\n'})}),"\n",(0,i.jsx)(n.h3,{id:"docker-compose",children:"Docker Compose"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"version: '3.8'\n\nservices:\n  serenity-tests:\n    build: .\n    volumes:\n      - ./target:/app/target\n    environment:\n      - WEBDRIVER_DRIVER=chrome\n      - WEBDRIVER_BASE_URL=https://example.com\n"})}),"\n",(0,i.jsx)(n.h3,{id:"github-actions-com-docker",children:"GitHub Actions com Docker"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- name: Build and run tests in Docker\n  run: |\n    docker build -t serenity-tests .\n    docker run --rm -v $PWD/target:/app/target serenity-tests\n"})}),"\n",(0,i.jsx)(n.h2,{id:"melhores-praticas",children:"Melhores Praticas"}),"\n",(0,i.jsx)(n.h3,{id:"1-use-navegadores-headless",children:"1. Use Navegadores Headless"}),"\n",(0,i.jsx)(n.p,{children:"Configure o modo headless para ambientes CI:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"serenity.conf:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hocon",children:'webdriver {\n  driver = chrome\n  capabilities {\n    browserName = "chrome"\n    "goog:chromeOptions" {\n      args = ["--headless", "--no-sandbox", "--disable-dev-shm-usage", "--disable-gpu"]\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"2-otimize-os-tempos-de-build",children:"2. Otimize os Tempos de Build"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Cache de dependencias:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# GitHub Actions\n- uses: actions/cache@v3\n  with:\n    path: ~/.m2/repository\n    key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}\n\n# GitLab CI\ncache:\n  paths:\n    - .m2/repository\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Pule fases desnecessarias:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mvn verify -DskipTests  # Pular execucao de testes\nmvn verify -Dmaven.test.skip=true  # Pular compilacao de testes\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-falhe-rapido",children:"3. Falhe Rapido"}),"\n",(0,i.jsx)(n.p,{children:"Configure builds para falhar rapidamente em erros criticos:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"strategy:\n  fail-fast: true  # Parar todos os jobs se um falhar\n"})}),"\n",(0,i.jsx)(n.h3,{id:"4-execucao-baseada-em-tags",children:"4. Execucao Baseada em Tags"}),"\n",(0,i.jsx)(n.p,{children:"Execute diferentes suites de teste em diferentes pipelines:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Testes smoke em cada commit\nmvn verify -Dcucumber.filter.tags="@smoke"\n\n# Regressao completa na branch main\nmvn verify -Dcucumber.filter.tags="@regression"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"5-separe-os-estagios-de-teste",children:"5. Separe os Estagios de Teste"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"stages:\n  - unit-tests\n  - integration-tests\n  - smoke-tests\n  - regression-tests\n"})}),"\n",(0,i.jsx)(n.h3,{id:"6-gerencie-secrets-com-seguranca",children:"6. Gerencie Secrets com Seguranca"}),"\n",(0,i.jsx)(n.p,{children:"Nunca commite credenciais:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# GitHub Actions\nenv:\n  API_KEY: ${{ secrets.API_KEY }}\n\n# GitLab CI\nvariables:\n  API_KEY: ${{ secrets.API_KEY }}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"7-reexecute-testes-flakey",children:"7. Reexecute Testes Flakey"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-groovy",children:"// Jenkins\nretry(3) {\n    sh 'mvn verify'\n}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# GitLab CI\ntest:\n  retry:\n    max: 2\n    when: runner_system_failure\n"})}),"\n",(0,i.jsx)(n.h3,{id:"8-gere-badges-de-build",children:"8. Gere Badges de Build"}),"\n",(0,i.jsx)(n.p,{children:"Adicione badges de status ao seu README:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"GitHub Actions:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-markdown",children:"![Tests](https://github.com/username/repo/actions/workflows/serenity-tests.yml/badge.svg)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"GitLab CI:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-markdown",children:"![pipeline status](https://gitlab.com/username/project/badges/main/pipeline.svg)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"solucao-de-problemas",children:"Solucao de Problemas"}),"\n",(0,i.jsx)(n.h3,{id:"problema-testes-falham-apenas-no-ci",children:"Problema: Testes falham apenas no CI"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Causas comuns:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Navegador nao instalado ou versao incompativel"}),"\n",(0,i.jsx)(n.li,{children:"Servidor de display ausente (X11)"}),"\n",(0,i.jsx)(n.li,{children:"Memoria insuficiente"}),"\n",(0,i.jsx)(n.li,{children:"Problemas de rede/firewall"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Solucoes:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# Adicionar servidor de display para Linux\nbefore_script:\n  - export DISPLAY=:99\n  - Xvfb :99 -screen 0 1920x1080x24 &\n\n# Aumentar memoria\nenv:\n  MAVEN_OPTS: "-Xmx2g"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"problema-relatorios-nao-publicando",children:"Problema: Relatorios nao publicando"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Verifique:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Caminho correto para o diretorio do relatorio"}),"\n",(0,i.jsxs)(n.li,{children:["Condicao ",(0,i.jsx)(n.code,{children:"if: always()"})," esta definida"]}),"\n",(0,i.jsx)(n.li,{children:"Permissoes suficientes"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"problema-builds-lentos",children:"Problema: Builds lentos"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Solucoes:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Cache de dependencias"}),"\n",(0,i.jsx)(n.li,{children:"Use execucao paralela"}),"\n",(0,i.jsx)(n.li,{children:"Execute subconjunto de testes (testes smoke primeiro)"}),"\n",(0,i.jsx)(n.li,{children:"Use cache de camadas Docker"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"exemplo-completo-github-actions-com-todas-as-funcionalidades",children:"Exemplo Completo: GitHub Actions com Todas as Funcionalidades"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"name: Serenity BDD - Production Ready\n\non:\n  push:\n    branches: [ main, develop ]\n  pull_request:\n    branches: [ main ]\n  schedule:\n    - cron: '0 2 * * *'  # Diariamente as 2 AM\n  workflow_dispatch:\n\nenv:\n  JAVA_VERSION: '17'\n  MAVEN_OPTS: '-Xmx2g'\n\njobs:\n  smoke-tests:\n    name: Smoke Tests\n    runs-on: ubuntu-latest\n\n    steps:\n    - uses: actions/checkout@v4\n\n    - name: Set up JDK\n      uses: actions/setup-java@v4\n      with:\n        java-version: ${{ env.JAVA_VERSION }}\n        distribution: 'temurin'\n        cache: 'maven'\n\n    - name: Run smoke tests\n      run: mvn verify -Dcucumber.filter.tags=\"@smoke\"\n\n    - name: Upload smoke test report\n      if: always()\n      uses: actions/upload-artifact@v4\n      with:\n        name: smoke-test-report\n        path: target/site/serenity\n\n  regression-tests:\n    name: Regression Tests\n    runs-on: ubuntu-latest\n    needs: smoke-tests\n    if: github.ref == 'refs/heads/main'\n\n    strategy:\n      matrix:\n        browser: [chrome, firefox]\n      fail-fast: false\n\n    steps:\n    - uses: actions/checkout@v4\n\n    - name: Set up JDK\n      uses: actions/setup-java@v4\n      with:\n        java-version: ${{ env.JAVA_VERSION }}\n        distribution: 'temurin'\n        cache: 'maven'\n\n    - name: Run regression tests\n      run: mvn verify -Dwebdriver.driver=${{ matrix.browser }}\n\n    - name: Upload report\n      if: always()\n      uses: actions/upload-artifact@v4\n      with:\n        name: report-${{ matrix.browser }}\n        path: target/site/serenity\n\n  publish-report:\n    name: Publish Report to GitHub Pages\n    runs-on: ubuntu-latest\n    needs: [smoke-tests, regression-tests]\n    if: always() && github.ref == 'refs/heads/main'\n\n    permissions:\n      contents: write\n      pages: write\n\n    steps:\n    - uses: actions/download-artifact@v4\n      with:\n        name: smoke-test-report\n        path: reports/smoke\n\n    - name: Deploy to GitHub Pages\n      uses: peaceiris/actions-gh-pages@v3\n      with:\n        github_token: ${{ secrets.GITHUB_TOKEN }}\n        publish_dir: ./reports\n"})}),"\n",(0,i.jsx)(n.h2,{id:"proximos-passos",children:"Proximos Passos"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Aprenda sobre ",(0,i.jsx)(n.a,{href:"/docs/junit5/parallel-execution",children:"Execucao Paralela"})," para acelerar builds de CI"]}),"\n",(0,i.jsxs)(n.li,{children:["Explore ",(0,i.jsx)(n.a,{href:"/docs/tutorials/data-driven-testing",children:"Testes Orientados a Dados"})," para cobertura de teste abrangente"]}),"\n",(0,i.jsxs)(n.li,{children:["Confira ",(0,i.jsx)(n.a,{href:"/docs/reference/serenity-properties",children:"Configuracao do Serenity"})," para otimizar o desempenho do CI"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"recursos-adicionais",children:"Recursos Adicionais"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.github.com/en/actions",children:"Documentacao do GitHub Actions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.jenkins.io/doc/book/pipeline/",children:"Documentacao do Jenkins Pipeline"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.gitlab.com/ee/ci/",children:"Documentacao do GitLab CI/CD"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://hub.docker.com/r/serenity",children:"Serenity BDD no Docker Hub"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>r,x:()=>o});var a=s(6540);const i={},t=a.createContext(i);function r(e){const n=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);