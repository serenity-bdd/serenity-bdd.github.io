"use strict";(globalThis.webpackChunkserenity_users_guide=globalThis.webpackChunkserenity_users_guide||[]).push([[5789],{3520(e,a,n){n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>t,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"guide/page_objects","title":"Interactuando con P\xe1ginas Web","description":"Serenity se integra suavemente con Selenium WebDriver y gestiona detalles como la configuraci\xf3n del driver y el mantenimiento de la instancia del driver. Tambi\xe9n proporciona una serie de mejoras al Selenium est\xe1ndar.","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/guide/page_objects.md","sourceDirName":"guide","slug":"/guide/page_objects","permalink":"/es/docs/guide/page_objects","draft":false,"unlisted":false,"editUrl":"https://github.com/serenity-bdd/serenity-bdd.github.io/blob/master/docs/guide/page_objects.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"id":"page_objects","title":"Interactuando con P\xe1ginas Web","sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Bibliotecas de Pasos","permalink":"/es/docs/guide/step_libraries"},"next":{"title":"Elementos de P\xe1gina de Serenity","permalink":"/es/docs/guide/page_elements"}}');var r=n(4848),i=n(8453);const o={id:"page_objects",title:"Interactuando con P\xe1ginas Web",sidebar_position:5},t="Interactuando con P\xe1ginas Web",l={},c=[{value:"Page Object",id:"page-object",level:2},{value:"Usando p\xe1ginas en una biblioteca de pasos",id:"usando-p\xe1ginas-en-una-biblioteca-de-pasos",level:2},{value:"Abriendo la p\xe1gina",id:"abriendo-la-p\xe1gina",level:2},{value:"Trabajando con elementos web",id:"trabajando-con-elementos-web",level:2},{value:"Verificando si los elementos son visibles",id:"verificando-si-los-elementos-son-visibles",level:3},{value:"Verificando si los elementos est\xe1n habilitados",id:"verificando-si-los-elementos-est\xe1n-habilitados",level:3},{value:"Manipulando listas desplegables",id:"manipulando-listas-desplegables",level:3},{value:"Determinando el foco",id:"determinando-el-foco",level:3},{value:"Usando selectores XPath y CSS directos",id:"usando-selectores-xpath-y-css-directos",level:3},{value:"Trabajando con P\xe1ginas As\xedncronas",id:"trabajando-con-p\xe1ginas-as\xedncronas",level:2},{value:"Verificando si un elemento es visible",id:"verificando-si-un-elemento-es-visible",level:3},{value:"Trabajando con elementos Shadow DOM",id:"trabajando-con-elementos-shadow-dom",level:3},{value:"Trabajando con timeouts",id:"trabajando-con-timeouts",level:2},{value:"Esperas Impl\xedcitas",id:"esperas-impl\xedcitas",level:3},{value:"Usando f\xe1bricas de localizadores personalizadas",id:"usando-f\xe1bricas-de-localizadores-personalizadas",level:3},{value:"Timeouts Expl\xedcitos",id:"timeouts-expl\xedcitos",level:3},{value:"Ejecutando Javascript",id:"ejecutando-javascript",level:2},{value:"Subiendo archivos",id:"subiendo-archivos",level:2},{value:"Usando expresiones Fluent Matcher",id:"usando-expresiones-fluent-matcher",level:2},{value:"Trabajando con Tablas HTML",id:"trabajando-con-tablas-html",level:3},{value:"Cambiando a otra p\xe1gina",id:"cambiando-a-otra-p\xe1gina",level:2},{value:"Estrategias de carga de colecciones de WebElement",id:"estrategias-de-carga-de-colecciones-de-webelement",level:2},{value:"Trabajando con m\xe9todos de fixture",id:"trabajando-con-m\xe9todos-de-fixture",level:2},{value:"Extendiendo la Integraci\xf3n de Serenity con WebDriver",id:"extendiendo-la-integraci\xf3n-de-serenity-con-webdriver",level:2},{value:"La interfaz BeforeAWebdriverScenario",id:"la-interfaz-beforeawebdriverscenario",level:3},{value:"La interfaz AfterAWebdriverScenario",id:"la-interfaz-afterawebdriverscenario",level:3},{value:"Driver Enhancers",id:"driver-enhancers",level:3},{value:"Configurando los paquetes de extensi\xf3n",id:"configurando-los-paquetes-de-extensi\xf3n",level:3},{value:"Implementaciones personalizadas de WebDriver",id:"implementaciones-personalizadas-de-webdriver",level:3},{value:"Usando la interfaz HasAuthentication",id:"usando-la-interfaz-hasauthentication",level:2}];function d(e){const a={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.header,{children:(0,r.jsx)(a.h1,{id:"interactuando-con-p\xe1ginas-web",children:"Interactuando con P\xe1ginas Web"})}),"\n",(0,r.jsx)(a.p,{children:"Serenity se integra suavemente con Selenium WebDriver y gestiona detalles como la configuraci\xf3n del driver y el mantenimiento de la instancia del driver. Tambi\xe9n proporciona una serie de mejoras al Selenium est\xe1ndar."}),"\n",(0,r.jsx)(a.h2,{id:"page-object",children:"Page Object"}),"\n",(0,r.jsx)(a.p,{children:"Si est\xe1s trabajando con pruebas web de WebDriver, estar\xe1s familiarizado con el concepto de Page Object. Los Page Object son una forma de aislar los detalles de implementaci\xf3n de una p\xe1gina web dentro de una clase, exponiendo solo m\xe9todos enfocados en el negocio relacionados con esa p\xe1gina. Son una excelente manera de hacer tus pruebas web m\xe1s mantenibles."}),"\n",(0,r.jsxs)(a.p,{children:["En Serenity, los Page Object son simplemente clases ordinarias que extienden la clase ",(0,r.jsx)(a.code,{children:"PageObject"}),". Serenity inyecta autom\xe1ticamente una instancia de WebDriver en el Page Object a la que puedes acceder a trav\xe9s del m\xe9todo ",(0,r.jsx)(a.code,{children:"getDriver()"}),", aunque raramente necesitas usar el WebDriver directamente. La clase ",(0,r.jsx)(a.code,{children:"PageObject"})," de Serenity proporciona una serie de m\xe9todos convenientes que hacen que acceder y manipular elementos web sea mucho m\xe1s f\xe1cil que con scripts de prueba convencionales de WebDriver."]}),"\n",(0,r.jsx)(a.p,{children:"Aqu\xed tienes un ejemplo simple:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'...\nimport net.serenitybdd.core.pages.WebElementFacade;\nimport net.thucydides.core.pages.PageObject;\n...\n\n@DefaultUrl("http://localhost:9000/somepage")\npublic class FindAJobPage extends PageObject {\n\n    WebElementFacade keywords;\n    WebElementFacade searchButton;\n\n    public void look_for_jobs_with_keywords(String values) {\n        typeInto(keywords, values);\n        searchButton.click();\n    }\n\n    public List<String> getJobTabs() {\n        return findAll("//div[@id=\'tabs\']//a").stream()\n            .map(WebElementFacade::getText)\n            .collect(Collectors.toList());\n    }\n}\n'})}),"\n",(0,r.jsxs)(a.p,{children:["El m\xe9todo ",(0,r.jsx)(a.code,{children:"typeInto"})," es un atajo que simplemente limpia un campo e ingresa el texto especificado.\nSi prefieres un estilo de API m\xe1s fluido, tambi\xe9n puedes hacer algo como esto:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@DefaultUrl("http://localhost:9000/somepage")\npublic class FindAJobPage extends PageObject {\n\tWebElementFacade keywordsField;\n\tWebElementFacade searchButton;\n\n\tpublic FindAJobPage(WebDriver driver) {\n\t    super(driver);\n\t}\n\n\tpublic void look_for_jobs_with_keywords(String values) {\n\t    enter(values).into(keywordsField);\n\t    searchButton.click();\n\t}\n\n\tpublic List<String> getJobTabs() {\n\t     return findAll("//div[@id=\'tabs\']//a").stream()\n            .map(WebElementFacade::getText)\n            .collect(Collectors.toList());\n\t}\n}\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Puedes usar un estilo a\xfan m\xe1s fluido para expresar los pasos de implementaci\xf3n usando m\xe9todos como ",(0,r.jsx)(a.code,{children:"find"}),", ",(0,r.jsx)(a.code,{children:"findBy"})," y ",(0,r.jsx)(a.code,{children:"then"}),"."]}),"\n",(0,r.jsxs)(a.p,{children:["Por ejemplo, puedes usar buscadores ",(0,r.jsx)(a.code,{children:"By"})," de webdriver con nombre de elemento, id, selector css o selector xpath de la siguiente manera:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'find(By.name("demo")).then(By.name("specialField")).getValue();\n\nfind(By.cssSelector(".foo")).getValue();\n\nfind(By.xpath("//th")).getValue();\n'})}),"\n",(0,r.jsxs)(a.p,{children:["El m\xe9todo ",(0,r.jsx)(a.code,{children:"findBy"})," te permite pasar el selector css o xpath directamente a WebDriver. Por ejemplo,"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'findBy("#demo").then("#specialField").getValue(); //selectores css\n\nfindBy("//div[@id=\'dataTable\']").getValue(); //selector xpath\n'})}),"\n",(0,r.jsx)(a.h2,{id:"usando-p\xe1ginas-en-una-biblioteca-de-pasos",children:"Usando p\xe1ginas en una biblioteca de pasos"}),"\n",(0,r.jsx)(a.p,{children:"Cuando necesitas usar un Page Object en uno de tus pasos, solo necesitas declarar una variable de tipo PageObject en tu biblioteca de pasos, por ejemplo:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"FindAJobPage page;\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Si quieres asegurarte de que est\xe1s en la p\xe1gina correcta, puedes usar el m\xe9todo ",(0,r.jsx)(a.code,{children:"currentPageAt()"}),". Este verificar\xe1 la clase de p\xe1gina para cualquier anotaci\xf3n ",(0,r.jsx)(a.code,{children:"@At"})," presente en la clase PageObject y, si est\xe1 presente, verificar\xe1 que la URL actual corresponda al patr\xf3n de URL especificado en la anotaci\xf3n. Por ejemplo, cuando lo invocas usando ",(0,r.jsx)(a.code,{children:"currentPageAt()"}),", el siguiente Page Object verificar\xe1 que la URL actual sea precisamente ",(0,r.jsx)(a.code,{children:"http://www.apache.org"}),"."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@At("http://www.apache.org")\npublic class ApacheHomePage extends PageObject {\n    ...\n}\n'})}),"\n",(0,r.jsxs)(a.p,{children:["La anotaci\xf3n ",(0,r.jsx)(a.code,{children:"@At"})," tambi\xe9n soporta comodines y expresiones regulares. El siguiente Page Object coincidir\xe1 con cualquier subdominio de Apache:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@At("http://.*.apache.org")\npublic class AnyApachePage extends PageObject {\n    ...\n}\n'})}),"\n",(0,r.jsxs)(a.p,{children:["M\xe1s generalmente, sin embargo, est\xe1s m\xe1s interesado en lo que viene despu\xe9s del nombre del host. Puedes usar el token especial ",(0,r.jsx)(a.code,{children:"#HOST"})," para coincidir con cualquier nombre de servidor. As\xed que el siguiente Page Object coincidir\xe1 tanto con ",(0,r.jsx)(a.code,{children:"http://localhost:8080/app/action/login.form"})," como con ",(0,r.jsx)(a.code,{children:"http://staging.acme.com/app/action/login.form"}),". Tambi\xe9n ignorar\xe1 par\xe1metros, as\xed que ",(0,r.jsx)(a.code,{children:"http://staging.acme.com/app/action/login.form?username=toto&password=oz"})," funcionar\xe1 bien tambi\xe9n."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@At(urls={"#HOST/app/action/login.form"})\npublic class LoginPage extends PageObject {\n   ...\n}\n'})}),"\n",(0,r.jsx)(a.h2,{id:"abriendo-la-p\xe1gina",children:"Abriendo la p\xe1gina"}),"\n",(0,r.jsxs)(a.p,{children:["Un Page Object est\xe1 normalmente dise\xf1ado para trabajar con una p\xe1gina web particular. Cuando se invoca el m\xe9todo ",(0,r.jsx)(a.code,{children:"open()"}),", el navegador se abrir\xe1 en la URL por defecto para la p\xe1gina."]}),"\n",(0,r.jsxs)(a.p,{children:["La anotaci\xf3n ",(0,r.jsx)(a.code,{children:"@DefaultUrl"})," indica la URL que esta prueba debe usar cuando se ejecuta de forma aislada (por ejemplo, desde dentro de tu IDE).\nGeneralmente, sin embargo, la parte del host de la URL por defecto ser\xe1 sobrescrita por la propiedad ",(0,r.jsx)(a.code,{children:"webdriver.base.url"}),", ya que esto te permite establecer la URL base para todas tus pruebas,\ny as\xed hace m\xe1s f\xe1cil ejecutar tus pruebas en diferentes entornos simplemente cambiando este valor de propiedad.\nPor ejemplo, en la clase de prueba anterior, establecer ",(0,r.jsx)(a.code,{children:"webdriver.base.url"})," a '",(0,r.jsx)(a.a,{href:"https://staging.mycompany.com",children:"https://staging.mycompany.com"}),"' resultar\xeda en que la p\xe1gina se abra en la URL '",(0,r.jsx)(a.a,{href:"https://staging.mycompany.com/somepage",children:"https://staging.mycompany.com/somepage"}),"'."]}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes definir URLs con nombre que se pueden usar para abrir la p\xe1gina web, opcionalmente con par\xe1metros. Por ejemplo, en el siguiente c\xf3digo, definimos una URL llamada 'open.issue', que acepta un solo par\xe1metro:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@DefaultUrl("http://jira.mycompany.org")\n@NamedUrls(\n  {\n    @NamedUrl(name = "open.issue", url = "http://jira.mycompany.org/issues/{1}")\n  }\n)\npublic class JiraIssuePage extends PageObject {\n    ...\n}\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Luego podr\xedas abrir esta p\xe1gina a la URL ",(0,r.jsx)(a.a,{href:"http://jira.mycompany.org/issues/ISSUE-1",children:"http://jira.mycompany.org/issues/ISSUE-1"})," como se muestra aqu\xed:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'page.open("open.issue", withParameters("ISSUE-1"));\n'})}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n podr\xedas prescindir completamente de la URL base en la definici\xf3n de URL con nombre, y confiar en los valores por defecto:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@DefaultUrl("http://jira.mycompany.org")\n@NamedUrls(\n  {\n    @NamedUrl(name = "open.issue", url = "/issues/{1}")\n  }\n)\npublic class JiraIssuePage extends PageObject {\n    ...\n}\n'})}),"\n",(0,r.jsx)(a.p,{children:"Y naturalmente puedes definir m\xe1s de una definici\xf3n:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@NamedUrls(\n  {\n          @NamedUrl(name = "open.issue", url = "/issues/{1}"),\n          @NamedUrl(name = "close.issue", url = "/issues/close/{1}")\n  }\n)\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Nunca debes intentar implementar el m\xe9todo ",(0,r.jsx)(a.code,{children:"open()"})," t\xfa mismo. De hecho, es final. Si necesitas que tu p\xe1gina haga algo al cargarse, como esperar a que aparezca un elemento din\xe1mico, puedes usar la anotaci\xf3n @WhenPageOpens.\nLos m\xe9todos en el PageObject con esta anotaci\xf3n ser\xe1n invocados (en un orden no especificado) despu\xe9s de que la URL haya sido abierta. En este ejemplo, el m\xe9todo ",(0,r.jsx)(a.code,{children:"open()"})," no retornar\xe1 hasta que\nel elemento web ",(0,r.jsx)(a.code,{children:"dataSection"})," sea visible:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@DefaultUrl("http://localhost:8080/client/list")\n    public class ClientList extends PageObject {\n\n     @FindBy(id="data-section");\n     WebElementFacade dataSection;\n     ...\n\n     @WhenPageOpens\n     public void waitUntilTitleAppears() {\n         element(dataSection).waitUntilVisible();\n     }\n}\n'})}),"\n",(0,r.jsx)(a.h2,{id:"trabajando-con-elementos-web",children:"Trabajando con elementos web"}),"\n",(0,r.jsx)(a.h3,{id:"verificando-si-los-elementos-son-visibles",children:"Verificando si los elementos son visibles"}),"\n",(0,r.jsxs)(a.p,{children:["La clase ",(0,r.jsx)(a.code,{children:"WebElementFacade"})," contiene una API fluida conveniente para tratar con elementos web, proporcionando algunas caracter\xedsticas extra com\xfanmente usadas que no se proporcionan de serie por la API de WebDriver.\nLos ",(0,r.jsx)(a.code,{children:"WebElementFacade"})," son en gran medida intercambiables con WebElements: simplemente declaras una variable de tipo ",(0,r.jsx)(a.code,{children:"WebElementFacade"})," en lugar de tipo ",(0,r.jsx)(a.code,{children:"WebElement"}),". Por ejemplo, puedes verificar que un elemento es visible como se muestra aqu\xed:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"public class FindAJobPage extends PageObject {\n\n    WebElementFacade searchButton;\n\n    public boolean searchButtonIsVisible() {\n        return searchButton.isVisible();\n    }\n    ...\n}\n"})}),"\n",(0,r.jsx)(a.p,{children:"Si el bot\xf3n no est\xe1 presente en la pantalla, la prueba esperar\xe1 un corto per\xedodo en caso de que aparezca debido a alguna magia Ajax. Si no quieres que la prueba haga esto, puedes usar la versi\xf3n m\xe1s r\xe1pida:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"public boolean searchButtonIsVisibleNow() {\n    return searchButton.isCurrentlyVisible();\n}\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Puedes convertir esto en una aserci\xf3n usando el m\xe9todo ",(0,r.jsx)(a.code,{children:"shouldBeVisible()"})," en su lugar:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"public void checkThatSearchButtonIsVisible() {\n    searchButton.shouldBeVisible();\n}\n"})}),"\n",(0,r.jsx)(a.p,{children:"Este m\xe9todo lanzar\xe1 un error de aserci\xf3n si el bot\xf3n de b\xfasqueda no es visible para el usuario final."}),"\n",(0,r.jsx)(a.h3,{id:"verificando-si-los-elementos-est\xe1n-habilitados",children:"Verificando si los elementos est\xe1n habilitados"}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes verificar si un elemento est\xe1 habilitado o no:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"searchButton.isEnabled()\nsearchButton.shouldBeEnabled()\n"})}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n hay m\xe9todos negativos equivalentes:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"searchButton.shouldNotBeVisible();\nsearchButton.shouldNotBeCurrentlyVisible();\nsearchButton.shouldNotBeEnabled()\n"})}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes verificar elementos que est\xe1n presentes en la p\xe1gina pero no visibles, por ejemplo:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"searchButton.isPresent();\nsearchButton.isNotPresent();\nsearchButton.shouldBePresent();\nsearchButton.shouldNotBePresent();\n"})}),"\n",(0,r.jsx)(a.h3,{id:"manipulando-listas-desplegables",children:"Manipulando listas desplegables"}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n hay m\xe9todos auxiliares disponibles para listas desplegables. Supongamos que tienes el siguiente desplegable en tu p\xe1gina:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-xml",children:'<select id="color">\n    <option value="red">Red</option>\n    <option value="blue">Blue</option>\n    <option value="green">Green</option>\n</select>\n'})}),"\n",(0,r.jsx)(a.p,{children:"Podr\xedas escribir un Page Object para manipular este desplegable como se muestra aqu\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'public class FindAJobPage extends PageObject {\n\n\t@FindBy(id="color")\n\tWebElementFacade colorDropdown;\n\n\tpublic selectDropdownValues() {\n\t    colorDropdown.selectByVisibleText("Blue");\n\t    assertThat(colorDropdown.getSelectedVisibleTextValue(), is("Blue"));\n\n\t    colorDropdown.selectByValue("blue");\n\t    assertThat(colorDropdown.getSelectedValue(), is("blue"));\n\n\t    colorDropdown.selectByIndex(2);\n\t    assertThat(colorDropdown.getSelectedValue(), is("green"));\n\n\t}\n\t...\n}\n'})}),"\n",(0,r.jsx)(a.h3,{id:"determinando-el-foco",children:"Determinando el foco"}),"\n",(0,r.jsx)(a.p,{children:"Puedes determinar si un campo dado tiene el foco de la siguiente manera:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"firstName.hasFocus()\n"})}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes esperar a que los elementos aparezcan, desaparezcan, o se habiliten o deshabiliten:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"button.waitUntilEnabled()\nbutton.waitUntilDisabled()\n"})}),"\n",(0,r.jsx)(a.p,{children:"o"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"field.waitUntilVisible()\nbutton.waitUntilNotVisible()\n"})}),"\n",(0,r.jsx)(a.h3,{id:"usando-selectores-xpath-y-css-directos",children:"Usando selectores XPath y CSS directos"}),"\n",(0,r.jsxs)(a.p,{children:["Otra forma de acceder a un elemento web es usar una expresi\xf3n XPath o CSS. Puedes usar el m\xe9todo ",(0,r.jsx)(a.code,{children:"$()"})," con una expresi\xf3n XPath para hacer esto m\xe1s simplemente. Por ejemplo, imagina que tu aplicaci\xf3n web necesita hacer clic en un elemento de lista que contiene un c\xf3digo postal dado. Una forma ser\xeda como se muestra aqu\xed:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'WebElement selectedSuburb = getDriver().findElement(By.xpath("//li/a[contains(.,\'" ` postcode ` "\')]"));\nselectedSuburb.click();\n'})}),"\n",(0,r.jsx)(a.p,{children:"Sin embargo, una opci\xf3n m\xe1s simple ser\xeda hacer esto:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'$("//li/a[contains(.,\'" ` postcode ` "\')]").click();\n'})}),"\n",(0,r.jsx)(a.h2,{id:"trabajando-con-p\xe1ginas-as\xedncronas",children:"Trabajando con P\xe1ginas As\xedncronas"}),"\n",(0,r.jsx)(a.p,{children:"Las p\xe1ginas as\xedncronas son aquellas cuyos campos o datos no se muestran todos cuando la p\xe1gina se carga. A veces, necesitas esperar a que ciertos elementos aparezcan, o desaparezcan, antes de poder continuar con tus pruebas. Serenity proporciona algunos m\xe9todos \xfatiles en la clase base PageObject para ayudar con estos escenarios. Est\xe1n principalmente dise\xf1ados para usarse como parte de tus m\xe9todos de negocio en tus Page Object, aunque en los ejemplos los mostraremos usados como llamadas externas a una instancia de PageObject para mayor claridad."}),"\n",(0,r.jsx)(a.h3,{id:"verificando-si-un-elemento-es-visible",children:"Verificando si un elemento es visible"}),"\n",(0,r.jsx)(a.p,{children:"En t\xe9rminos de WebDriver, hay una distinci\xf3n entre cuando un elemento est\xe1 presente en la pantalla (es decir, en el c\xf3digo fuente HTML), y cuando est\xe1 renderizado (es decir, visible para el usuario). Tambi\xe9n puedes necesitar verificar si un elemento es visible en la pantalla. Puedes hacer esto de dos maneras. Tu primera opci\xf3n es usar el m\xe9todo isElementVisible, que devuelve un valor booleano basado en si el elemento est\xe1 renderizado (visible para el usuario) o no:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"isElementVisible(By.xpath(\"//h2[.='A visible title']\"))\n"})}),"\n",(0,r.jsx)(a.p,{children:"Tu segunda opci\xf3n es afirmar activamente que el elemento debe ser visible:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"shouldBeVisible(By.xpath(\"//h2[.='An invisible title']\"));\n"})}),"\n",(0,r.jsx)(a.p,{children:"Si el elemento no aparece inmediatamente, puedes esperar a que aparezca:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"waitForRenderedElements(By.xpath(\"//h2[.='A title that is not immediately visible']\"));\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Una alternativa a la sintaxis anterior es usar el m\xe9todo m\xe1s fluido ",(0,r.jsx)(a.code,{children:"waitFor"})," que toma un selector css o xpath como argumento:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'waitFor("#popup"); //selector css\n\nwaitFor("//h2[.=\'A title that is not immediately visible\']"); //selector xpath\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Si solo quieres verificar si el elemento est\xe1 presente aunque no necesariamente visible, puedes usar ",(0,r.jsx)(a.code,{children:"waitForRenderedElementsToBePresent"}),":"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"waitForRenderedElementsToBePresent(By.xpath(\"//h2[.='A title that is not immediately visible']\"));\n"})}),"\n",(0,r.jsxs)(a.p,{children:["o su versi\xf3n m\xe1s expresiva, ",(0,r.jsx)(a.code,{children:"waitForPresenceOf"})," que toma un selector css o xpath como argumento."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'waitForPresenceOf("#popup"); //css\n\nwaitForPresenceOf("//h2[.=\'A title that is not immediately visible\']"); //xpath\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Tambi\xe9n puedes esperar a que un elemento desaparezca usando ",(0,r.jsx)(a.code,{children:"waitForRenderedElementsToDisappear"})," o ",(0,r.jsx)(a.code,{children:"waitForAbsenceOf"}),":"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'waitForRenderedElementsToDisappear(By.xpath("//h2[.=\'A title that will soon disappear\']"));\n\nwaitForAbsenceOf("#popup");\n\nwaitForAbsenceOf("//h2[.=\'A title that will soon disappear\']");\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Para simplificar, tambi\xe9n puedes usar los m\xe9todos ",(0,r.jsx)(a.code,{children:"waitForTextToAppear"})," y ",(0,r.jsx)(a.code,{children:"waitForTextToDisappear"}),":"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'waitForTextToDisappear("A visible bit of text");\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Si varios textos posibles pueden aparecer, puedes usar ",(0,r.jsx)(a.code,{children:"waitForAnyTextToAppear"})," o `waitForAllTextToAppear+:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'waitForAnyTextToAppear("this might appear","or this", "or even this");\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Si necesitas esperar a que aparezca uno de varios elementos posibles, tambi\xe9n puedes usar el m\xe9todo ",(0,r.jsx)(a.code,{children:"waitForAnyRenderedElementOf"}),":"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'waitForAnyRenderedElementOf(By.id("color"), By.id("taste"), By.id("sound"));\n'})}),"\n",(0,r.jsx)(a.h3,{id:"trabajando-con-elementos-shadow-dom",children:"Trabajando con elementos Shadow DOM"}),"\n",(0,r.jsx)(a.p,{children:"Selenium 4 introdujo soporte para elementos Shadow DOM, y Serenity BDD a\xf1ade soporte mejorado para estos elementos. Supongamos que tenemos la siguiente estructura HTML que contiene elementos shadow DOM."}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-html",children:'<pre>\n    <div id="shadow-host">\n      #shadow-root\n      <input id="shadowedInput"/>\n\n      <div id="nested-shadow-host">\n          #shadow-root\n          <input id="nestedShadowedInput"/>\n      </div>\n    </div>\n'})}),"\n",(0,r.jsx)(a.p,{children:"Para encontrar el primer elemento input dentro de un shadow DOM de un solo nivel, necesitas proporcionar el localizador para el elemento anidado y el localizador para el elemento host del shadow:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:' ByShadow.cssSelector("#shadowedInput","#shadow-host")\n'})}),"\n",(0,r.jsx)(a.p,{children:"Para encontrar el elemento input dentro del shadow DOM anidado, necesitas proporcionar el localizador para el elemento sombreado, as\xed como la lista de localizadores de shadow dom padre, de arriba hacia abajo:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'ByShadow.cssSelector("#nestedShadowedInput","#shadow-host", "#nested-shadow-host")\n'})}),"\n",(0,r.jsx)(a.h2,{id:"trabajando-con-timeouts",children:"Trabajando con timeouts"}),"\n",(0,r.jsx)(a.p,{children:"Las aplicaciones web modernas basadas en AJAX a\xf1aden una gran cantidad de complejidad a las pruebas web. El problema b\xe1sico es que, cuando accedes a un elemento web en una p\xe1gina, puede que a\xfan no est\xe9 disponible. As\xed que necesitas esperar un poco. De hecho, muchas pruebas contienen pausas codificadas de forma fija dispersas por el c\xf3digo para manejar este tipo de cosas."}),"\n",(0,r.jsx)(a.p,{children:"Pero las esperas codificadas de forma fija son malas. Ralentizan tu suite de pruebas, y las hacen fallar aleatoriamente si no son lo suficientemente largas. En cambio, necesitas esperar por un estado o evento particular. Selenium proporciona un gran soporte para esto, y Serenity construye sobre este soporte para hacerlo m\xe1s f\xe1cil de usar."}),"\n",(0,r.jsx)(a.h3,{id:"esperas-impl\xedcitas",children:"Esperas Impl\xedcitas"}),"\n",(0,r.jsxs)(a.p,{children:["La primera forma en que puedes gestionar c\xf3mo WebDriver maneja campos tard\xedos es usar la propiedad ",(0,r.jsx)(a.code,{children:"webdriver.timeouts.implicitlywait"}),". Esto determina cu\xe1nto tiempo, en milisegundos, WebDriver esperar\xe1 si un elemento al que intenta acceder no est\xe1 presente en la p\xe1gina. Para citar la documentaci\xf3n de WebDriver:"]}),"\n",(0,r.jsx)(a.p,{children:'"Una espera impl\xedcita es decirle a WebDriver que sondee el DOM durante cierto tiempo cuando intente encontrar un elemento o elementos si no est\xe1n inmediatamente disponibles."'}),"\n",(0,r.jsx)(a.p,{children:"El valor por defecto en Serenity para esta propiedad es actualmente 2 segundos. Esto es diferente del WebDriver est\xe1ndar, donde el valor por defecto es cero."}),"\n",(0,r.jsx)(a.p,{children:"Veamos un ejemplo. Supongamos que tenemos un PageObject con un campo definido as\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@FindBy(id="slow-loader")\npublic WebElementFacade slowLoadingField;\n'})}),"\n",(0,r.jsx)(a.p,{children:"Este campo tarda un poco en cargarse, as\xed que no estar\xe1 listo inmediatamente en la p\xe1gina."}),"\n",(0,r.jsxs)(a.p,{children:["Ahora supongamos que establecemos el valor de ",(0,r.jsx)(a.code,{children:"webdriver.timeouts.implicitlywait"})," a 5000, y que nuestra prueba usa el slowLoadingField:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"boolean loadingFinished = slowLoadingField.isDisplayed()\n"})}),"\n",(0,r.jsx)(a.p,{children:"Cuando accedemos a este campo, pueden ocurrir dos cosas. Si el campo tarda menos de 5 segundos en cargarse, todo estar\xe1 bien. Pero si tarda m\xe1s de 5 segundos, se lanzar\xe1 una NoSuchElementException (o algo similar)."}),"\n",(0,r.jsx)(a.p,{children:"Ten en cuenta que este timeout tambi\xe9n se aplica a las listas. Supongamos que hemos definido un campo as\xed, que tarda algo de tiempo en cargarse din\xe1micamente:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@FindBy(css="#elements option")\npublic List<WebElementFacade> elementItems;\n'})}),"\n",(0,r.jsx)(a.p,{children:"Ahora supongamos que contamos los valores del elemento as\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"int itemCount = elementItems.size()\n"})}),"\n",(0,r.jsxs)(a.p,{children:["El n\xfamero de elementos devueltos depender\xe1 del valor de espera impl\xedcita. Si establecemos el valor de ",(0,r.jsx)(a.code,{children:"webdriver.timeouts.implicitlywait"})," a un valor muy peque\xf1o, WebDriver puede cargar solo algunos de los valores. Pero si le damos a la lista suficiente tiempo para cargarse completamente, obtendremos la lista completa."]}),"\n",(0,r.jsx)(a.p,{children:"El valor de espera impl\xedcita se establece globalmente para cada instancia de WebDriver, pero puedes sobrescribir el valor t\xfa mismo. La forma m\xe1s simple de hacer esto desde dentro de un PageObject de Serenity es usar el m\xe9todo setImplicitTimeout():"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"setImplicitTimeout(5, SECONDS)\n"})}),"\n",(0,r.jsx)(a.p,{children:"Pero recuerda que esta es una configuraci\xf3n global, as\xed que tambi\xe9n afectar\xe1 a otros Page Object. As\xed que una vez que hayas terminado, siempre debes restablecer el timeout impl\xedcito a su valor anterior. Serenity te da un m\xe9todo pr\xe1ctico para hacer esto:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"resetImplicitTimeout()\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Consulta ",(0,r.jsx)(a.a,{href:"http://docs.seleniumhq.org/docs/04_webdriver_advanced.jsp#implicit-waits%5BDocumentaci%C3%B3n",children:"http://docs.seleniumhq.org/docs/04_webdriver_advanced.jsp#implicit-waits[Documentaci\xf3n"})," de Selenium] para m\xe1s detalles sobre c\xf3mo funcionan las esperas impl\xedcitas de WebDriver."]}),"\n",(0,r.jsx)(a.h3,{id:"usando-f\xe1bricas-de-localizadores-personalizadas",children:"Usando f\xe1bricas de localizadores personalizadas"}),"\n",(0,r.jsxs)(a.p,{children:["Internamente, Selenium usa el concepto de F\xe1bricas de Localizadores (Locator Factories).\nNormalmente, Serenity usa ",(0,r.jsx)(a.code,{children:"SmartElementLocatorFactory"}),", una extensi\xf3n del ",(0,r.jsx)(a.code,{children:"AjaxElementLocatorFactory"})," de WebDriver, cuando instancia Page Object. Entre otras cosas, esto ayuda a asegurar que los elementos web est\xe9n disponibles y utilizables antes de usarlos, permite timeouts por campo, y evita esperas innecesarias largas en elementos web despu\xe9s de que un paso ha fallado."]}),"\n",(0,r.jsxs)(a.p,{children:["El ",(0,r.jsx)(a.code,{children:"SmartElementLocatorFactory"})," usa la espera impl\xedcita por defecto, o el atributo ",(0,r.jsx)(a.code,{children:"timeoutInSeconds"})," de la anotaci\xf3n ",(0,r.jsx)(a.code,{children:"@FindBy"})," si este valor se ha especificado (ver abajo), o el valor de espera impl\xedcita por defecto especificado por la propiedad ",(0,r.jsx)(a.code,{children:"webdriver.timeouts.implicitlywait"}),"."]}),"\n",(0,r.jsxs)(a.p,{children:["En casos raros, puedes necesitar personalizar este comportamiento. Para hacer esto, puedes usar la propiedad ",(0,r.jsx)(a.code,{children:"serenity.locator.factory"})," para usar una de las siguientes f\xe1bricas de localizadores alternativas:"]}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.code,{children:"AjaxElementLocatorFactory"}),": Una f\xe1brica de localizadores de WebDriver m\xe1s adecuada para aplicaciones Ajax. Seg\xfan la documentaci\xf3n de WebDriver, esta f\xe1brica de localizadores devolver\xe1 ",(0,r.jsx)(a.em,{children:"un localizador de elementos que esperar\xe1 el n\xfamero especificado de segundos para que un elemento aparezca, en lugar de fallar instant\xe1neamente si no est\xe1 presente. Esto funciona sondeando la UI de forma regular. El elemento devuelto estar\xe1 presente en el DOM, pero puede que no sea realmente visible."})]}),"\n"]}),"\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.code,{children:"DefaultElementLocatorFactory"}),": la f\xe1brica de localizadores por defecto de WebDriver"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(a.p,{children:["Si usas ",(0,r.jsx)(a.code,{children:"AjaxElementLocatorFactory"}),", puedes usar el par\xe1metro ",(0,r.jsx)(a.code,{children:"webdriver.timeouts.implicitlywait"})," para especificar el n\xfamero de segundos a esperar. Si no se especifica ning\xfan valor, la espera por defecto ser\xe1 de 5 segundos."]}),"\n",(0,r.jsx)(a.h3,{id:"timeouts-expl\xedcitos",children:"Timeouts Expl\xedcitos"}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes esperar program\xe1ticamente hasta que un elemento est\xe9 en un estado particular. Esto es m\xe1s flexible y \xfatil cuando necesitas esperar tiempo extra en una situaci\xf3n espec\xedfica. Por ejemplo, podr\xedamos esperar hasta que un campo se vuelva visible:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"slowLoadingField.waitUntilVisible()\n"})}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes esperar condiciones m\xe1s arbitrarias, por ejemplo:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"waitFor(ExpectedConditions.alertIsPresent())\n"})}),"\n",(0,r.jsxs)(a.p,{children:["El tiempo por defecto que Serenity esperar\xe1 est\xe1 determinado por la propiedad ",(0,r.jsx)(a.code,{children:"webdriver.wait.for.timeout"}),". El valor por defecto para esta propiedad es 5 segundos."]}),"\n",(0,r.jsx)(a.p,{children:"A veces quieres darle a WebDriver m\xe1s tiempo para una operaci\xf3n espec\xedfica. Desde dentro de un PageObject, puedes sobrescribir o extender el timeout expl\xedcito usando el m\xe9todo withTimeoutOf(). Por ejemplo, podr\xedas esperar a que la lista #elements se cargue hasta 5 segundos as\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'withTimeoutOf(5, SECONDS).waitForPresenceOf(By.cssSelector("#elements option"))\n'})}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes especificar el timeout para un campo. Por ejemplo, si quisieras esperar hasta 5 segundos para que un bot\xf3n se vuelva clicable antes de hacer clic en \xe9l, podr\xedas hacer lo siguiente:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"someButton.withTimeoutOf(5, SECONDS).waitUntilClickable().click()\n"})}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes usar este enfoque para recuperar elementos:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'elements = withTimeoutOf(5, SECONDS).findAll("#elements option")\n'})}),"\n",(0,r.jsx)(a.p,{children:"Finalmente, si un elemento espec\xedfico en un PageObject necesita tener un poco m\xe1s de tiempo para cargarse, puedes usar el atributo timeoutInSeconds en la anotaci\xf3n @FindBy de Serenity, por ejemplo:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'import net.serenitybdd.core.annotations.findby.FindBy;\n...\n@FindBy(name = "country", timeoutInSeconds="10")\npublic WebElementFacade country;\n'})}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes esperar a que un elemento est\xe9 en un estado particular, y luego realizar una acci\xf3n en el elemento. Aqu\xed esperamos a que un elemento sea clicable antes de hacer clic en el elemento:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"addToCartButton.withTimeoutOf(5, SECONDS).waitUntilClickable().click()\n"})}),"\n",(0,r.jsx)(a.p,{children:"O puedes esperar directamente en un elemento web:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@FindBy(id="share1-fb-like")\nWebElementFacade facebookIcon;\n  ...\npublic WebElementState facebookIcon() {\n    return withTimeoutOf(5, TimeUnit.SECONDS).waitFor(facebookIcon);\n}\n'})}),"\n",(0,r.jsx)(a.p,{children:"O incluso:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'List<WebElementFacade> currencies = withTimeoutOf(5, TimeUnit.SECONDS)\n                              .waitFor(currencyTab)\n                              .thenFindAll(".currency-code");\n'})}),"\n",(0,r.jsx)(a.h2,{id:"ejecutando-javascript",children:"Ejecutando Javascript"}),"\n",(0,r.jsxs)(a.p,{children:["Hay momentos en que puede resultarte \xfatil ejecutar un poco de Javascript directamente dentro del navegador para hacer el trabajo. Puedes usar el m\xe9todo ",(0,r.jsx)(a.code,{children:"evaluateJavascript()"})," de la clase ",(0,r.jsx)(a.code,{children:"PageObject"})," para hacer esto. Por ejemplo, podr\xedas necesitar evaluar una expresi\xf3n y usar el resultado en tus pruebas. El siguiente comando evaluar\xe1 el t\xedtulo del documento y lo devolver\xe1 al c\xf3digo Java que lo llama:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'String result = (String) evaluateJavascript("return document.title");\n'})}),"\n",(0,r.jsx)(a.p,{children:"Alternativamente, podr\xedas simplemente querer ejecutar un comando Javascript localmente en el navegador. En el siguiente c\xf3digo, por ejemplo, establecemos el foco en el campo de entrada 'firstname':"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"\tevaluateJavascript(\"document.getElementById('firstname').focus()\");\n"})}),"\n",(0,r.jsx)(a.p,{children:"Y, si est\xe1s familiarizado con JQuery, tambi\xe9n puedes invocar expresiones JQuery:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"\tevaluateJavascript(\"$('#firstname').focus()\");\n"})}),"\n",(0,r.jsx)(a.p,{children:"Esta es a menudo una estrategia \xfatil si necesitas disparar eventos como mouse-overs que no est\xe1n actualmente soportados por la API de WebDriver."}),"\n",(0,r.jsx)(a.h2,{id:"subiendo-archivos",children:"Subiendo archivos"}),"\n",(0,r.jsx)(a.p,{children:"Subir archivos es f\xe1cil. Los archivos a subir pueden colocarse en una ubicaci\xf3n codificada de forma fija (malo) o almacenarse en el classpath (mejor). Aqu\xed tienes un ejemplo simple:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'public class NewCompanyPage extends PageObject {\n    ...\n    @FindBy(id="object_logo")\n    WebElementFacade logoField;\n\n    public NewCompanyPage(WebDriver driver) {\n        super(driver);\n    }\n\n    public void loadLogoFrom(String filename) {\n        upload(filename).to(logoField);\n    }\n}\n'})}),"\n",(0,r.jsx)(a.h2,{id:"usando-expresiones-fluent-matcher",children:"Usando expresiones Fluent Matcher"}),"\n",(0,r.jsx)(a.p,{children:"Cuando escribes pruebas de aceptaci\xf3n, a menudo te encuentras expresando expectativas sobre objetos de dominio individuales o colecciones de objetos de dominio. Por ejemplo, si est\xe1s probando una funci\xf3n de b\xfasqueda con m\xfaltiples criterios, querr\xe1s saber que la aplicaci\xf3n encuentra los registros que esperabas. Podr\xedas ser capaz de hacer esto de una manera muy precisa (por ejemplo, sabiendo exactamente qu\xe9 valores de campo esperas), o podr\xedas querer hacer tus pruebas m\xe1s flexibles expresando los rangos de valores que ser\xedan aceptables. Serenity proporciona algunas caracter\xedsticas que facilitan escribir pruebas de aceptaci\xf3n para este tipo de casos."}),"\n",(0,r.jsx)(a.p,{children:"En el resto de esta secci\xf3n, estudiaremos algunos ejemplos basados en pruebas para el sitio de b\xfasqueda Maven Central. Este sitio te permite buscar el repositorio Maven para artefactos Maven, y ver los detalles de un artefacto particular."}),"\n",(0,r.jsx)(a.p,{children:"Usaremos algunas pruebas de regresi\xf3n imaginarias para este sitio para ilustrar c\xf3mo los matchers de Serenity pueden usarse para escribir pruebas m\xe1s expresivas. El primer escenario que consideraremos es simplemente buscar un artefacto por nombre, y asegurarnos de que solo los artefactos que coinciden con este nombre aparezcan en la lista de resultados. Podr\xedamos expresar estos criterios de aceptaci\xf3n informalmente de la siguiente manera:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Dado que el desarrollador est\xe1 en la p\xe1gina de b\xfasqueda,"}),"\n",(0,r.jsx)(a.li,{children:"Y el desarrollador busca artefactos llamados 'Serenity'"}),"\n",(0,r.jsx)(a.li,{children:"Entonces el desarrollador deber\xeda ver al menos 16 artefactos de Serenity, cada uno con un Id de artefacto \xfanico"}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"En JUnit 5, una prueba de Serenity para este escenario podr\xeda verse as\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'...\nimport static net.thucydides.core.matchers.BeanMatchers.the_count;\nimport static net.thucydides.core.matchers.BeanMatchers.each;\nimport static net.thucydides.core.matchers.BeanMatchers.the;\nimport static org.hamcrest.Matchers.greaterThanOrEqualTo;\nimport static org.hamcrest.Matchers.is;\nimport static org.hamcrest.Matchers.startsWith;\n\n@ExtendWith(SerenityJUnit5Extension.class)\nclass WhenSearchingForArtifacts {\n\n    @Managed\n    WebDriver driver;\n\n    @Steps\n    DeveloperSteps developer;\n\n    @Test\n    void should_find_the_right_number_of_artifacts() {\n        developer.opens_the_search_page();\n        developer.searches_for("Serenity");\n        developer.should_see_artifacts_where(the("GroupId", startsWith("net.thucydides")),\n                                             each("ArtifactId").isDifferent(),\n                                             the_count(is(greaterThanOrEqualTo(16))));\n\n    }\n}\n'})}),"\n",(0,r.jsx)(a.admonition,{title:"JUnit 4 Obsoleto",type:"note",children:(0,r.jsxs)(a.p,{children:["Si a\xfan est\xe1s usando JUnit 4 con ",(0,r.jsx)(a.code,{children:"@RunWith(SerenityRunner.class)"}),", ten en cuenta que el soporte de JUnit 4 est\xe1 obsoleto a partir de Serenity 5.0.0 y ser\xe1 eliminado en Serenity 6.0.0. Por favor migra a JUnit 5 usando ",(0,r.jsx)(a.code,{children:"@ExtendWith(SerenityJUnit5Extension.class)"}),"."]})}),"\n",(0,r.jsxs)(a.p,{children:["Veamos c\xf3mo se implementa la prueba en esta clase. La prueba ",(0,r.jsx)(a.code,{children:"should_find_the_right_number_of_artifacts()"})," podr\xeda expresarse como sigue:"]}),"\n",(0,r.jsx)(a.p,{children:". Cuando abrimos la p\xe1gina de b\xfasqueda"}),"\n",(0,r.jsx)(a.p,{children:". Y buscamos artefactos que contengan la palabra 'Serenity'"}),"\n",(0,r.jsx)(a.p,{children:'. Entonces deber\xedamos ver una lista de artefactos donde cada Group ID comienza con "net.Serenity", cada Artifact ID es \xfanico, y que hay al menos 16 entradas mostradas.'}),"\n",(0,r.jsx)(a.p,{children:"La implementaci\xf3n de estos pasos se ilustra aqu\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"...\nimport static net.thucydides.core.matchers.BeanMatcherAsserts.shouldMatch;\n\npublic class DeveloperSteps {\n\n    @Step\n    public void opens_the_search_page() {\n        onSearchPage().open();\n    }\n\n    @Step\n    public void searches_for(String search_terms) {\n        onSearchPage().enter_search_terms(search_terms);\n        onSearchPage().starts_search();\n    }\n\n    @Step\n    public void should_see_artifacts_where(BeanMatcher... matchers) {\n        shouldMatch(onSearchResultsPage().getSearchResults(), matchers);\n    }\n\n    private SearchPage onSearchPage() {\n        return getPages().get(SearchPage.class);\n    }\n\n    private SearchResultsPage onSearchResultsPage() {\n        return getPages().get(SearchResultsPage.class);\n    }\n}\n"})}),"\n",(0,r.jsx)(a.p,{children:"Los dos primeros pasos se implementan con m\xe9todos relativamente simples. Sin embargo, el tercer paso es m\xe1s interesante. Ve\xe1moslo m\xe1s de cerca:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"    @Step\n    public void should_see_artifacts_where(BeanMatcher... matchers) {\n        shouldMatch(onSearchResultsPage().getSearchResults(), matchers);\n    }\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Aqu\xed, estamos pasando un n\xfamero arbitrario de expresiones al m\xe9todo. Estas expresiones son en realidad 'matchers', instancias de la clase BeanMatcher. No es que normalmente tengas que preocuparte por ese nivel de detalle - creas estas expresiones matcher usando un conjunto de m\xe9todos est\xe1ticos proporcionados en la clase BeanMatchers. As\xed que t\xedpicamente pasar\xedas expresiones bastante legibles como ",(0,r.jsx)(a.code,{children:'the("GroupId", startsWith("net.Serenity"))'}),' o `each("ArtifactId").isDifferent()+.']}),"\n",(0,r.jsxs)(a.p,{children:["El m\xe9todo ",(0,r.jsx)(a.code,{children:"shouldMatch()"})," de la clase BeanMatcherAsserts toma ya sea un solo objeto Java, o una colecci\xf3n de objetos Java, y verifica que al menos algunos de los objetos coincidan con las restricciones especificadas por los matchers. En el contexto de pruebas web, estos objetos son t\xedpicamente POJOs proporcionados por el Page Object para representar el objeto u objetos de dominio mostrados en una pantalla."]}),"\n",(0,r.jsx)(a.p,{children:"Hay varios tipos diferentes de expresiones matcher para elegir. El matcher m\xe1s com\xfanmente usado simplemente verifica el valor de un campo en un objeto. Por ejemplo, supongamos que est\xe1s usando el objeto de dominio mostrado aqu\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"     public class Person {\n        private final String firstName;\n        private final String lastName;\n\n        Person(String firstName, String lastName) {\n            this.firstName = firstName;\n            this.lastName = lastName;\n        }\n\n        public String getFirstName() {...}\n\n        public String getLastName() {...}\n    }\n"})}),"\n",(0,r.jsx)(a.p,{children:'Podr\xedas escribir una prueba para asegurar que una lista de Personas contiene al menos una persona llamada "Bill" usando el m\xe9todo est\xe1tico "the", como se muestra aqu\xed:'}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'    List<Person> persons = Arrays.asList(new Person("Bill", "Oddie"), new Person("Tim", "Brooke-Taylor"));\n\n    shouldMatch(persons, the("firstName", is("Bill"))\n'})}),"\n",(0,r.jsx)(a.p,{children:"El segundo par\xe1metro en el m\xe9todo the() es un matcher de Hamcrest, que te da una gran flexibilidad con tus expresiones. Por ejemplo, tambi\xe9n podr\xedas escribir lo siguiente:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'    List<Person> persons = Arrays.asList(new Person("Bill", "Oddie"), new Person("Tim", "Brooke-Taylor"));\n\n    shouldMatch(persons, the("firstName", is(not("Tim"))));\n    shouldMatch(persons, the("firstName", startsWith("B")));\n'})}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes pasar m\xfaltiples condiciones:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'    List<Person> persons = Arrays.asList(new Person("Bill", "Oddie"), new Person("Tim", "Brooke-Taylor"));\n\n    shouldMatch(persons, the("firstName", is("Bill"), the("lastName", is("Oddie"));\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Serenity tambi\xe9n proporciona la clase DateMatchers, que te permite aplicar matches de Hamcrest a Dates de Java est\xe1ndar y DateTimes de ",(0,r.jsx)(a.code,{children:"JodaTime"}),". Los siguientes ejemplos de c\xf3digo ilustran c\xf3mo podr\xedan usarse:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'    DateTime january1st2010 = new DateTime(2010,01,01,12,0).toDate();\n    DateTime may31st2010 = new DateTime(2010,05,31,12,0).toDate();\n\n    the("purchaseDate", isBefore(january1st2010))\n    the("purchaseDate", isAfter(january1st2010))\n    the("purchaseDate", isSameAs(january1st2010))\n    the("purchaseDate", isBetween(january1st2010, may31st2010))\n'})}),"\n",(0,r.jsxs)(a.p,{children:["A veces tambi\xe9n necesitas verificar restricciones que se aplican a todos los elementos bajo consideraci\xf3n. La m\xe1s simple de estas es verificar que todos los valores de campo para un campo particular son \xfanicos. Puedes hacer esto usando el m\xe9todo ",(0,r.jsx)(a.code,{children:"each()"}),":"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'    shouldMatch(persons, each("lastName").isDifferent())\n'})}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes verificar que el n\xfamero de elementos coincidentes corresponde a lo que esperas. Por ejemplo, para verificar que solo hay una persona llamada Bill, podr\xedas hacer esto:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'     shouldMatch(persons, the("firstName", is("Bill"), the_count(is(1)));\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Tambi\xe9n puedes verificar los valores m\xe1ximo y m\xednimo usando los m\xe9todos max() y min(). Por ejemplo, si la clase Person tuviera un m\xe9todo ",(0,r.jsx)(a.code,{children:"getAge()"}),", podr\xedamos asegurar que cada persona es mayor de 21 y menor de 65 haciendo lo siguiente:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'     shouldMatch(persons, min("age", greaterThanOrEqualTo(21)),\n                          max("age", lessThanOrEqualTo(65)));\n'})}),"\n",(0,r.jsx)(a.p,{children:"Estos m\xe9todos funcionan con objetos Java normales, pero tambi\xe9n con Maps. As\xed que el siguiente c\xf3digo tambi\xe9n funcionar\xe1:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'    Map<String, String> person = new HashMap<String, String>();\n    person.put("firstName", "Bill");\n    person.put("lastName", "Oddie");\n\n    List<Map<String,String>> persons = Arrays.asList(person);\n    shouldMatch(persons, the("firstName", is("Bill"))\n'})}),"\n",(0,r.jsx)(a.p,{children:"La otra cosa buena de este enfoque es que los matchers se integran bien con los reportes de Serenity. As\xed que cuando usas la clase BeanMatcher como par\xe1metro en tus pasos de prueba, las condiciones expresadas en el paso se mostrar\xe1n en el reporte de prueba."}),"\n",(0,r.jsx)(a.p,{children:"Hay dos patrones de uso comunes cuando se construyen Page Objects y pasos que usan este tipo de matcher. El primero es escribir un m\xe9todo del Page Object que devuelva la lista de objetos de dominio (por ejemplo, Personas) mostrados en la tabla. Por ejemplo, el m\xe9todo getSearchResults() usado en el paso should_see_artifacts_where() podr\xeda implementarse as\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'    public List<Artifact> getSearchResults() {\n        List<WebElement> rows = resultTable.findElements(By.xpath(".//tr[td]"));\n        List<Artifact> artifacts = new ArrayList<Artifact>();\n        for (WebElement row : rows) {\n            List<WebElement> cells = row.findElements(By.tagName("td"));\n            artifacts.add(new Artifact(cells.get(0).getText(),\n                                       cells.get(1).getText(),\n                                       cells.get(2).getText()));\n\n        }\n        return artifacts;\n    }\n'})}),"\n",(0,r.jsx)(a.p,{children:"El segundo es acceder al contenido de la tabla HTML directamente, sin modelar expl\xedcitamente los datos contenidos en la tabla. Este enfoque es m\xe1s r\xe1pido y m\xe1s efectivo si no esperas reutilizar el objeto de dominio en otras p\xe1ginas. Veremos c\xf3mo hacer esto a continuaci\xf3n."}),"\n",(0,r.jsx)(a.h3,{id:"trabajando-con-tablas-html",children:"Trabajando con Tablas HTML"}),"\n",(0,r.jsx)(a.p,{children:"Dado que las tablas HTML todav\xeda se usan ampliamente para representar conjuntos de datos en aplicaciones web, Serenity viene con la clase HtmlTable, que proporciona varios m\xe9todos \xfatiles que facilitan escribir Page Objects que contienen tablas. Por ejemplo, el m\xe9todo rowsFrom devuelve el contenido de una tabla HTML como una lista de Maps, donde cada map contiene los valores de celda para una fila indexados por el encabezado correspondiente, como se muestra aqu\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"...\nimport static net.thucydides.core.pages.components.HtmlTable.rowsFrom;\n\npublic class SearchResultsPage extends PageObject {\n\n    WebElement resultTable;\n\n    public SearchResultsPage(WebDriver driver) {\n        super(driver);\n    }\n\n    public List<Map<String, String>> getSearchResults() {\n        return rowsFrom(resultTable);\n    }\n\n}\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Esto ahorra mucho c\xf3digo - nuestro m\xe9todo ",(0,r.jsx)(a.code,{children:"getSearchResults()"})," ahora se ve as\xed:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"    public List<Map<String, String>> getSearchResults() {\n        return rowsFrom(resultTable);\n    }\n"})}),"\n",(0,r.jsx)(a.p,{children:"Y dado que los matchers de Serenity funcionan tanto con objetos Java como con Maps, las expresiones matcher ser\xe1n muy similares. La \xfanica diferencia es que los Maps devueltos est\xe1n indexados por los valores de texto contenidos en los encabezados de la tabla, en lugar de por nombres de propiedades amigables con Java."}),"\n",(0,r.jsxs)(a.p,{children:["Tambi\xe9n puedes leer tablas sin encabezados (es decir, elementos ",(0,r.jsx)(a.code,{children:"<th>"}),") especificando tus propios encabezados usando el m\xe9todo ",(0,r.jsx)(a.code,{children:"withColumns"}),". Por ejemplo:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'    List<Map<Object, String>> tableRows =\n                    HtmlTable.withColumns("First Name","Last Name", "Favorite Colour")\n                             .readRowsFrom(page.table_with_no_headings);\n'})}),"\n",(0,r.jsx)(a.p,{children:"Tambi\xe9n puedes usar la clase HtmlTable para seleccionar filas particulares dentro de una tabla para trabajar con ellas. Por ejemplo, otro escenario de prueba para la p\xe1gina de b\xfasqueda de Maven implica hacer clic en un artefacto y mostrar los detalles de ese artefacto. La prueba para esto podr\xeda verse algo as\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'    @Test\n    public void clicking_on_artifact_should_display_details_page() {\n        developer.opens_the_search_page();\n        developer.searches_for("Serenity");\n        developer.open_artifact_where(the("ArtifactId", is("Serenity")),\n                                      the("GroupId", is("net.Serenity")));\n\n        developer.should_see_artifact_details_where(the("artifactId", is("Serenity")),\n                                                    the("groupId", is("net.Serenity")));\n    }\n'})}),"\n",(0,r.jsx)(a.p,{children:"Ahora el m\xe9todo open_artifact_where() necesita hacer clic en una fila particular de la tabla. Este paso se ve as\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"    @Step\n    public void open_artifact_where(BeanMatcher... matchers) {\n        onSearchResultsPage().clickOnFirstRowMatching(matchers);\n    }\n"})}),"\n",(0,r.jsx)(a.p,{children:"As\xed que efectivamente estamos delegando al Page Object, que hace el trabajo real. El m\xe9todo correspondiente del Page Object se ve as\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"import static net.thucydides.core.pages.components.HtmlTable.filterRows;\n...\n    public void clickOnFirstRowMatching(BeanMatcher... matchers) {\n        List<WebElement> matchingRows = filterRows(resultTable, matchers);\n        WebElement targetRow = matchingRows.get(0);\n        WebElement detailsLink = targetRow.findElement(By.xpath(\".//a[contains(@href,'artifactdetails')]\"));\n        detailsLink.click();\n    }\n"})}),"\n",(0,r.jsx)(a.p,{children:"La parte interesante aqu\xed es la primera l\xednea del m\xe9todo, donde usamos el m\xe9todo filterRows(). Este m\xe9todo devolver\xe1 una lista de WebElements que coinciden con los matchers que has pasado. Este m\xe9todo hace bastante f\xe1cil seleccionar las filas en las que est\xe1s interesado para un tratamiento especial."}),"\n",(0,r.jsx)(a.h2,{id:"cambiando-a-otra-p\xe1gina",children:"Cambiando a otra p\xe1gina"}),"\n",(0,r.jsx)(a.p,{children:"Se proporciona un m\xe9todo, switchToPage() en la clase PageObject para facilitar devolver un nuevo PageObject despu\xe9s de la navegaci\xf3n desde dentro de un m\xe9todo de una clase PageObject. Por ejemplo,"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@DefaultUrl("http://mail.acme.com/login.html")\npublic class EmailLoginPage extends PageObject {\n\n    ...\n    public void forgotPassword() {\n        ...\n        forgotPassword.click();\n        ForgotPasswordPage forgotPasswordPage = this.switchToPage(ForgotPasswordPage.class);\n        forgotPasswordPage.open();\n        ...\n    }\n    ...\n}\n'})}),"\n",(0,r.jsx)(a.h2,{id:"estrategias-de-carga-de-colecciones-de-webelement",children:"Estrategias de carga de colecciones de WebElement"}),"\n",(0,r.jsxs)(a.p,{children:["Selenium te permite usar las anotaciones ",(0,r.jsx)(a.code,{children:"@FindBy"})," y ",(0,r.jsx)(a.code,{children:"@FindAll"})," para cargar colecciones de elementos web, como se ilustra aqu\xed:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"@FindBy(css='#colors a')\nList<WebElement> options\n"})}),"\n",(0,r.jsx)(a.p,{children:"Si est\xe1s trabajando con una aplicaci\xf3n as\xedncrona, estas listas pueden tardar en cargarse, as\xed que Selenium puede darte una lista vac\xeda porque los elementos a\xfan no se han cargado."}),"\n",(0,r.jsx)(a.p,{children:"Serenity te permite ajustar este comportamiento de dos maneras. La primera es usar el DSL de espera para cargar los elementos directamente, por ejemplo:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'withTimeoutOf(5, SECONDS).waitForPresenceOf(By.cssSelector("#colors a"))\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Alternativamente, puedes usar la propiedad ",(0,r.jsx)(a.code,{children:"serenity.webdriver.collection_loading_strategy"})," para definir c\xf3mo Serenity carga colecciones de elementos web cuando se usan las anotaciones ",(0,r.jsx)(a.code,{children:"@FindBy"})," y ",(0,r.jsx)(a.code,{children:"@FindAll"}),". Hay tres opciones:"]}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Optimistic"}),"\n",(0,r.jsx)(a.li,{children:"Pessimistic (por defecto)"}),"\n",(0,r.jsx)(a.li,{children:"Paranoid"}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"Optimistic solo esperar\xe1 hasta que el campo est\xe9 definido. Este es el comportamiento nativo de Selenium."}),"\n",(0,r.jsx)(a.p,{children:"Pessimistic esperar\xe1 hasta que al menos el primer elemento se muestre. Este es actualmente el valor por defecto."}),"\n",(0,r.jsx)(a.p,{children:"Paranoid esperar\xe1 hasta que todos los elementos se muestren. Esto puede ser lento para listas largas."}),"\n",(0,r.jsx)(a.h2,{id:"trabajando-con-m\xe9todos-de-fixture",children:"Trabajando con m\xe9todos de fixture"}),"\n",(0,r.jsxs)(a.p,{children:["Cuando un paso de UI falla en una prueba de Serenity, la instancia de WebDriver se deshabilita para el resto de la prueba. Esto evita esperas innecesarias mientras la prueba pasa por los pasos subsiguientes (lo que necesita hacer para documentar los pasos de prueba). La excepci\xf3n a esta regla es en el caso de m\xe9todos de fixture, como m\xe9todos anotados con la anotaci\xf3n ",(0,r.jsx)(a.code,{children:"@AfterEach"})," en JUnit 5 (o ",(0,r.jsx)(a.code,{children:"@After"})," en JUnit 4) o Cucumber."]}),"\n",(0,r.jsxs)(a.p,{children:["En estos m\xe9todos, la instancia de WebDriver puede usarse normalmente. Adem\xe1s de las anotaciones conocidas de JUnit y Cucumber, cualquier anotaci\xf3n que comience con la palabra ",(0,r.jsx)(a.code,{children:"After"})," ser\xe1 considerada un m\xe9todo de fixture."]}),"\n",(0,r.jsxs)(a.p,{children:["Por ejemplo, supongamos que necesitas eliminar las cuentas de cliente a trav\xe9s de la UI al final de cada prueba. Ya tienes una biblioteca de pasos ",(0,r.jsx)(a.code,{children:"AdminSteps"})," con un m\xe9todo ",(0,r.jsx)(a.code,{children:"deleteAllCustomerAccounts()"})," que realiza esta tarea. Podr\xedas asegurarte de que todas las cuentas de cliente se eliminen as\xed:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"@Steps\nAdminSteps asAdministrator;\n\n...\n\n@AfterEach\nvoid deleteUserAccounts() {\n    asAdministrator.deleteAllCustomerAccounts();\n}\n"})}),"\n",(0,r.jsx)(a.p,{children:"Esto facilita realizar operaciones de limpieza o desmontaje que usan la interfaz de usuario, potencialmente reutilizando pasos o Task que se usan en otras partes de las pruebas."}),"\n",(0,r.jsxs)(a.p,{children:["Tambi\xe9n puedes sobrescribir este comportamiento en cualquier momento llamando al m\xe9todo ",(0,r.jsx)(a.code,{children:"reenableDrivers()"}),", como se muestra aqu\xed:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"Serenity.webdriver().reenableDrivers();\n"})}),"\n",(0,r.jsx)(a.h2,{id:"extendiendo-la-integraci\xf3n-de-serenity-con-webdriver",children:"Extendiendo la Integraci\xf3n de Serenity con WebDriver"}),"\n",(0,r.jsxs)(a.p,{children:["Serenity ofrece una forma simple de extender las capacidades por defecto de WebDriver y personalizar las actividades de creaci\xf3n y cierre del driver. Simplemente implementa las interfaces ",(0,r.jsx)(a.code,{children:"BeforeAWebdriverScenario"})," y/o ",(0,r.jsx)(a.code,{children:"AfterAWebDriverScenario"})," (ambas est\xe1n en el paquete ",(0,r.jsx)(a.code,{children:"net.serenitybdd.core.webdriver.enhancers"}),"). Serenity ejecutar\xe1 las clases ",(0,r.jsx)(a.code,{children:"BeforeAWebdriverScenario"})," justo antes de crear una instancia de driver, permiti\xe9ndote a\xf1adir opciones personalizadas a las capacidades del driver. Cualquier ",(0,r.jsx)(a.code,{children:"AfterAWebDriverScenario"})," se ejecuta al final de una prueba, justo antes de cerrar el driver."]}),"\n",(0,r.jsx)(a.h3,{id:"la-interfaz-beforeawebdriverscenario",children:"La interfaz BeforeAWebdriverScenario"}),"\n",(0,r.jsxs)(a.p,{children:["La interfaz ",(0,r.jsx)(a.code,{children:"BeforeAWebdriverScenario"})," se usa para mejorar el objeto ",(0,r.jsx)(a.code,{children:"Capabilities"})," que se pasar\xe1 a la instancia de WebDriver cuando se cree un nuevo driver. La llamada al m\xe9todo pasa el driver solicitado y el objeto ",(0,r.jsx)(a.code,{children:"TestOutcome"}),", que contiene informaci\xf3n sobre el nombre y las etiquetas usadas para esta prueba. Tambi\xe9n pasa las ",(0,r.jsx)(a.code,{children:"EnvironmentVariables"}),", que te dan acceso a la configuraci\xf3n actual del entorno. Un ejemplo de una simple ",(0,r.jsx)(a.code,{children:"BeforeAWebdriverScenario"})," se muestra a continuaci\xf3n:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'public class MyCapabilityEnhancer implements BeforeAWebdriverScenario {\n\n    @Override\n    public DesiredCapabilities apply(EnvironmentVariables environmentVariables,\n                                     SupportedWebDriver driver,\n                                     TestOutcome testOutcome,\n                                     MutableCapabilities capabilities) {\n        capabilities.setCapability("name", testOutcome.getStoryTitle() + " - " + testOutcome.getTitle());\n        return capabilities;\n    }\n}\n'})}),"\n",(0,r.jsx)(a.h3,{id:"la-interfaz-afterawebdriverscenario",children:"La interfaz AfterAWebdriverScenario"}),"\n",(0,r.jsxs)(a.p,{children:["La interfaz ",(0,r.jsx)(a.code,{children:"AfterAWebdriverScenario"})," se llama al final de una prueba, justo antes de cerrar el driver, y una vez que el resultado de la prueba es conocido. El resultado de la prueba (y otros detalles) se pueden obtener del par\xe1metro ",(0,r.jsx)(a.code,{children:"TestOutcome"}),". Esto permite que se realicen cualquier manipulaci\xf3n o verificaci\xf3n final en el driver, antes del final de la prueba. El siguiente ejemplo verifica el resultado de la prueba que acaba de terminar, y a\xf1ade una cookie con un valor dependiendo del resultado de la prueba:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'public class MyTestResultUpdater implements AfterAWebdriverScenario {\n    void apply(EnvironmentVariables environmentVariables,\n               TestOutcome testOutcome,\n               WebDriver driver) {\n       if ((driver == null) || (!RemoteDriver.isARemoteDriver(driver))) {\n           return;\n       }\n\n       Cookie cookie = new Cookie("testPassed",\n                                   testOutcome.isFailure() || testOutcome.isError() || testOutcome.isCompromised() ? "false" : "true");\n       driver.manage().addCookie(cookie);\n    }\n}\n'})}),"\n",(0,r.jsx)(a.h3,{id:"driver-enhancers",children:"Driver Enhancers"}),"\n",(0,r.jsxs)(a.p,{children:["Si necesitas realizar alguna acci\xf3n en la instancia del driver antes de cada prueba, puedes implementar la clase ",(0,r.jsx)(a.code,{children:"CustomDriverEnhancer"}),". Ten en cuenta que esto se llamar\xe1 inmediatamente despu\xe9s de que el driver sea creado, y antes de que se abra ninguna p\xe1gina, as\xed que el n\xfamero de acciones es relativamente limitado."]}),"\n",(0,r.jsx)(a.h3,{id:"configurando-los-paquetes-de-extensi\xf3n",children:"Configurando los paquetes de extensi\xf3n"}),"\n",(0,r.jsxs)(a.p,{children:["Lo \xfaltimo que necesitas hacer es decirle a Serenity qu\xe9 paquete necesita buscar para tus clases de extensi\xf3n. A\xf1ade el paquete, o un paquete padre a tu configuraci\xf3n de Serenity usando ",(0,r.jsx)(a.code,{children:"serenity.extension.packages"}),"."]}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.code,{children:"serenity.extension.packages=com.acme.myserenityextensions"})}),"\n",(0,r.jsxs)(a.p,{children:["Puedes encontrar un ejemplo de c\xf3mo estas clases se implementan en un caso de uso del mundo real en el m\xf3dulo ",(0,r.jsx)(a.a,{href:"https://github.com/serenity-bdd/serenity-core/tree/master/serenity-browserstack/src/main/java/net/serenitybdd/browserstack",children:"serenity-browserstack"})," en Github."]}),"\n",(0,r.jsx)(a.h3,{id:"implementaciones-personalizadas-de-webdriver",children:"Implementaciones personalizadas de WebDriver"}),"\n",(0,r.jsxs)(a.p,{children:["Puedes a\xf1adir tu propio proveedor personalizado de WebDriver implementando la interfaz DriverSource. Primero, necesitas configurar las siguientes propiedades del sistema (por ejemplo, en tu archivo ",(0,r.jsx)(a.code,{children:"serenity.properties"}),"):"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"webdriver.driver = provided\nwebdriver.provided.type = mydriver\nwebdriver.provided.mydriver = com.acme.MyPhantomJSDriver\nthucydides.driver.capabilities = mydriver\n"})}),"\n",(0,r.jsx)(a.p,{children:"Tu driver personalizado debe implementar la interfaz DriverSource, como se muestra aqu\xed:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"public class MyPhantomJSDriver implements DriverSource {\n\n    @Override\n    public WebDriver newDriver() {\n        try {\n            DesiredCapabilities capabilities = DesiredCapabilities.phantomjs();\n            // Add\n            return new PhantomJSDriver(ResolvingPhantomJSDriverService.createDefaultService(), capabilities);\n        }\n        catch (IOException e) {\n            throw new Error(e);\n        }\n    }\n\n\t@Override\n    public boolean takesScreenshots() {\n        return true;\n    }\n}\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Ten en cuenta que si usas drivers personalizados ser\xe1s totalmente responsable de configurar e instanciar la instancia del navegador, y las opciones de configuraci\xf3n de Serenity relacionadas con el driver no se aplicar\xe1n. Generalmente recomendamos usar drivers personalizados solo para circunstancias muy excepcionales, y usar clases ",(0,r.jsx)(a.code,{children:"BeforeAWebdriverScenario"})," para la mayor\xeda de los requisitos de configuraci\xf3n personalizada."]}),"\n",(0,r.jsx)(a.h2,{id:"usando-la-interfaz-hasauthentication",children:"Usando la interfaz HasAuthentication"}),"\n",(0,r.jsxs)(a.p,{children:["Selenium 4 soporta la interfaz ",(0,r.jsx)(a.code,{children:"HasAuthentication"}),", que indica que un driver soporta autenticaci\xf3n en un sitio web de alguna manera. Los drivers de Serenity se integran perfectamente con la interfaz ",(0,r.jsx)(a.code,{children:"HasAuthentication"}),", as\xed que puedes usarla de la misma manera que lo har\xedas en Selenium 4. Por ejemplo, para registrar un nombre de usuario y contrase\xf1a para usar en todas las p\xe1ginas, podr\xedas a\xf1adir el siguiente c\xf3digo antes de abrir un sitio:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'    getDriver().register(UsernameAndPassword.of("scott", "tiger")\n'})}),"\n",(0,r.jsx)(a.p,{children:"Si la autenticaci\xf3n solo es requerida en ciertas p\xe1ginas, tambi\xe9n puedes usar un predicado:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'        Predicate<URI> onlyAuthenticateOnTheLoginPage = uri -> uri.getPath().endsWith("/login");\n        getDriver().register(onlyAuthenticateOnTheLoginPage, UsernameAndPassword.of("scott", "tiger"));\n'})})]})}function u(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,a,n){n.d(a,{R:()=>o,x:()=>t});var s=n(6540);const r={},i=s.createContext(r);function o(e){const a=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:a},e.children)}}}]);