"use strict";(globalThis.webpackChunkserenity_users_guide=globalThis.webpackChunkserenity_users_guide||[]).push([[1840],{8453(e,n,a){a.d(n,{R:()=>l,x:()=>o});var i=a(6540);const r={},s=i.createContext(r);function l(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(s.Provider,{value:n},e.children)}},9016(e,n,a){a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"junit5/parallel-execution","title":"Ejecutando pruebas de JUnit 5 en paralelo","description":"Ejecutar pruebas de JUnit 5 en paralelo puede reducir significativamente el tiempo de ejecucion de las pruebas. Esta guia explica como configurar y optimizar la ejecucion paralela para pruebas de Serenity BDD usando JUnit 5.","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/junit5/parallel-execution.md","sourceDirName":"junit5","slug":"/junit5/parallel-execution","permalink":"/es/docs/junit5/parallel-execution","draft":false,"unlisted":false,"editUrl":"https://github.com/serenity-bdd/serenity-bdd.github.io/blob/master/docs/junit5/parallel-execution.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"parallel-execution","title":"Ejecutando pruebas de JUnit 5 en paralelo","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"JUnit 5 con Serenity BDD","permalink":"/es/docs/junit5/junit5-tests"},"next":{"title":"Cucumber con JUnit 5","permalink":"/es/docs/cucumber/cucumber-junit5"}}');var r=a(4848),s=a(8453);const l={id:"parallel-execution",title:"Ejecutando pruebas de JUnit 5 en paralelo",sidebar_position:2},o="Ejecutando pruebas de Serenity con JUnit 5 en paralelo",c={},t=[{value:"Descripcion general",id:"descripcion-general",level:2},{value:"Prerrequisitos",id:"prerrequisitos",level:2},{value:"Configuracion basica",id:"configuracion-basica",level:2},{value:"Paso 1: Habilitar la ejecucion paralela",id:"paso-1-habilitar-la-ejecucion-paralela",level:3},{value:"Paso 2: Configurar el modo de ejecucion",id:"paso-2-configurar-el-modo-de-ejecucion",level:3},{value:"Paso 3: Configurar la estrategia de ejecucion",id:"paso-3-configurar-la-estrategia-de-ejecucion",level:3},{value:"Modos de ejecucion",id:"modos-de-ejecucion",level:2},{value:"Modo concurrente",id:"modo-concurrente",level:3},{value:"Modo mismo hilo",id:"modo-mismo-hilo",level:3},{value:"Modo mixto",id:"modo-mixto",level:3},{value:"Estrategias de ejecucion",id:"estrategias-de-ejecucion",level:2},{value:"Estrategia dinamica (Recomendada)",id:"estrategia-dinamica-recomendada",level:3},{value:"Estrategia fija",id:"estrategia-fija",level:3},{value:"Estrategia personalizada",id:"estrategia-personalizada",level:3},{value:"Controlando el paralelismo a nivel de clase/metodo",id:"controlando-el-paralelismo-a-nivel-de-clasemetodo",level:2},{value:"Configuracion por clase",id:"configuracion-por-clase",level:3},{value:"Forzar ejecucion secuencial",id:"forzar-ejecucion-secuencial",level:3},{value:"Control a nivel de metodo",id:"control-a-nivel-de-metodo",level:3},{value:"Bloqueos de recursos",id:"bloqueos-de-recursos",level:2},{value:"Bloqueos de recursos comunes",id:"bloqueos-de-recursos-comunes",level:3},{value:"Seguridad de hilos con Serenity",id:"seguridad-de-hilos-con-serenity",level:2},{value:"Gestion de WebDriver",id:"gestion-de-webdriver",level:3},{value:"Bibliotecas de pasos",id:"bibliotecas-de-pasos",level:3},{value:"Evitar estado mutable compartido",id:"evitar-estado-mutable-compartido",level:3},{value:"Ejemplo de configuracion completa",id:"ejemplo-de-configuracion-completa",level:2},{value:"junit-platform.properties completo",id:"junit-platformproperties-completo",level:3},{value:"Configuracion de Maven",id:"configuracion-de-maven",level:2},{value:"Plugin Failsafe",id:"plugin-failsafe",level:3},{value:"Ejecutar desde la linea de comandos",id:"ejecutar-desde-la-linea-de-comandos",level:3},{value:"Configuracion de Gradle",id:"configuracion-de-gradle",level:2},{value:"Optimizacion del rendimiento",id:"optimizacion-del-rendimiento",level:2},{value:"1. Elegir la estrategia correcta",id:"1-elegir-la-estrategia-correcta",level:3},{value:"2. Monitorear el uso de recursos",id:"2-monitorear-el-uso-de-recursos",level:3},{value:"3. Optimizar el diseno de pruebas",id:"3-optimizar-el-diseno-de-pruebas",level:3},{value:"4. Balancear el numero de hilos",id:"4-balancear-el-numero-de-hilos",level:3},{value:"Depurando pruebas paralelas",id:"depurando-pruebas-paralelas",level:2},{value:"Deshabilitar temporalmente el paralelismo",id:"deshabilitar-temporalmente-el-paralelismo",level:3},{value:"Ejecutar una sola clase de prueba",id:"ejecutar-una-sola-clase-de-prueba",level:3},{value:"Habilitar registro detallado",id:"habilitar-registro-detallado",level:3},{value:"Problemas comunes y soluciones",id:"problemas-comunes-y-soluciones",level:2},{value:"Problema 1: Pruebas inestables (flaky)",id:"problema-1-pruebas-inestables-flaky",level:3},{value:"Problema 2: Agotamiento de recursos",id:"problema-2-agotamiento-de-recursos",level:3},{value:"Problema 3: Problemas con WebDriver",id:"problema-3-problemas-con-webdriver",level:3},{value:"Problema 4: Bloqueos de base de datos",id:"problema-4-bloqueos-de-base-de-datos",level:3},{value:"Mejores practicas",id:"mejores-practicas",level:2},{value:"1. Empezar pequeno",id:"1-empezar-pequeno",level:3},{value:"2. Aislar datos de prueba",id:"2-aislar-datos-de-prueba",level:3},{value:"3. Usar etiquetas para paralelismo selectivo",id:"3-usar-etiquetas-para-paralelismo-selectivo",level:3},{value:"4. Limpiar recursos",id:"4-limpiar-recursos",level:3},{value:"5. Documentar la seguridad de hilos",id:"5-documentar-la-seguridad-de-hilos",level:3},{value:"Midiendo el rendimiento",id:"midiendo-el-rendimiento",level:2},{value:"Antes de la ejecucion paralela",id:"antes-de-la-ejecucion-paralela",level:3},{value:"Despues de la ejecucion paralela (8 hilos)",id:"despues-de-la-ejecucion-paralela-8-hilos",level:3},{value:"Proximos pasos",id:"proximos-pasos",level:2},{value:"Recursos adicionales",id:"recursos-adicionales",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"ejecutando-pruebas-de-serenity-con-junit-5-en-paralelo",children:"Ejecutando pruebas de Serenity con JUnit 5 en paralelo"})}),"\n",(0,r.jsx)(n.p,{children:"Ejecutar pruebas de JUnit 5 en paralelo puede reducir significativamente el tiempo de ejecucion de las pruebas. Esta guia explica como configurar y optimizar la ejecucion paralela para pruebas de Serenity BDD usando JUnit 5."}),"\n",(0,r.jsx)(n.h2,{id:"descripcion-general",children:"Descripcion general"}),"\n",(0,r.jsx)(n.p,{children:"JUnit 5 (Jupiter) tiene soporte integrado para la ejecucion paralela de pruebas. Cuando se combina con Serenity BDD, puedes ejecutar metodos y clases de prueba concurrentemente, aprovechando los procesadores multinucleo."}),"\n",(0,r.jsx)(n.admonition,{title:"Beneficios de la ejecucion paralela",type:"tip",children:(0,r.jsx)(n.p,{children:"En una maquina con 8 nucleos, la ejecucion paralela puede reducir el tiempo de prueba de 30 minutos a 5-8 minutos o menos."})}),"\n",(0,r.jsx)(n.h2,{id:"prerrequisitos",children:"Prerrequisitos"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"JUnit 5 (Jupiter)"}),"\n",(0,r.jsx)(n.li,{children:"Serenity BDD 3.6.0 o superior"}),"\n",(0,r.jsx)(n.li,{children:"Codigo de prueba seguro para hilos (thread-safe)"}),"\n",(0,r.jsx)(n.li,{children:"Recursos de sistema suficientes (CPU, RAM)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"configuracion-basica",children:"Configuracion basica"}),"\n",(0,r.jsx)(n.h3,{id:"paso-1-habilitar-la-ejecucion-paralela",children:"Paso 1: Habilitar la ejecucion paralela"}),"\n",(0,r.jsxs)(n.p,{children:["Crea o actualiza ",(0,r.jsx)(n.code,{children:"junit-platform.properties"})," en ",(0,r.jsx)(n.code,{children:"src/test/resources"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# Habilitar ejecucion paralela\njunit.jupiter.execution.parallel.enabled=true\n"})}),"\n",(0,r.jsx)(n.h3,{id:"paso-2-configurar-el-modo-de-ejecucion",children:"Paso 2: Configurar el modo de ejecucion"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# Ejecutar clases de prueba en paralelo\njunit.jupiter.execution.parallel.mode.default=concurrent\n\n# Ejecutar clases de prueba en paralelo\njunit.jupiter.execution.parallel.mode.classes.default=concurrent\n"})}),"\n",(0,r.jsx)(n.h3,{id:"paso-3-configurar-la-estrategia-de-ejecucion",children:"Paso 3: Configurar la estrategia de ejecucion"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# Usar estrategia dinamica (recomendado)\njunit.jupiter.execution.parallel.config.strategy=dynamic\njunit.jupiter.execution.parallel.config.dynamic.factor=1.0\n"})}),"\n",(0,r.jsx)(n.h2,{id:"modos-de-ejecucion",children:"Modos de ejecucion"}),"\n",(0,r.jsx)(n.h3,{id:"modo-concurrente",children:"Modo concurrente"}),"\n",(0,r.jsx)(n.p,{children:"Las pruebas se ejecutan en paralelo:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"junit.jupiter.execution.parallel.mode.default=concurrent\njunit.jupiter.execution.parallel.mode.classes.default=concurrent\n"})}),"\n",(0,r.jsx)(n.h3,{id:"modo-mismo-hilo",children:"Modo mismo hilo"}),"\n",(0,r.jsx)(n.p,{children:"Las pruebas se ejecutan secuencialmente:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"junit.jupiter.execution.parallel.mode.default=same_thread\njunit.jupiter.execution.parallel.mode.classes.default=same_thread\n"})}),"\n",(0,r.jsx)(n.h3,{id:"modo-mixto",children:"Modo mixto"}),"\n",(0,r.jsx)(n.p,{children:"Ejecuta clases en paralelo pero los metodos dentro de una clase secuencialmente:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# Clases en paralelo\njunit.jupiter.execution.parallel.mode.classes.default=concurrent\n\n# Metodos en la misma clase se ejecutan secuencialmente\njunit.jupiter.execution.parallel.mode.default=same_thread\n"})}),"\n",(0,r.jsx)(n.h2,{id:"estrategias-de-ejecucion",children:"Estrategias de ejecucion"}),"\n",(0,r.jsx)(n.h3,{id:"estrategia-dinamica-recomendada",children:"Estrategia dinamica (Recomendada)"}),"\n",(0,r.jsx)(n.p,{children:"Determina automaticamente el numero de hilos basandose en los procesadores disponibles:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"junit.jupiter.execution.parallel.config.strategy=dynamic\njunit.jupiter.execution.parallel.config.dynamic.factor=1.0\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Calculo del factor:"})," ",(0,r.jsx)(n.code,{children:"hilos = procesadores x factor"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Ejemplos"})," (en una maquina de 8 nucleos):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Factor ",(0,r.jsx)(n.code,{children:"1.0"})," = 8 hilos (recomendado)"]}),"\n",(0,r.jsxs)(n.li,{children:["Factor ",(0,r.jsx)(n.code,{children:"0.5"})," = 4 hilos"]}),"\n",(0,r.jsxs)(n.li,{children:["Factor ",(0,r.jsx)(n.code,{children:"2.0"})," = 16 hilos"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"estrategia-fija",children:"Estrategia fija"}),"\n",(0,r.jsx)(n.p,{children:"Usa un numero especificado de hilos:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"junit.jupiter.execution.parallel.config.strategy=fixed\njunit.jupiter.execution.parallel.config.fixed.parallelism=4\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Usar cuando:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Necesitas conteos de hilos consistentes"}),"\n",(0,r.jsx)(n.li,{children:"Ejecutas en infraestructura CI/CD compartida"}),"\n",(0,r.jsx)(n.li,{children:"Depuras problemas de ejecucion paralela"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"estrategia-personalizada",children:"Estrategia personalizada"}),"\n",(0,r.jsx)(n.p,{children:"Implementa tu propia estrategia:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"junit.jupiter.execution.parallel.config.strategy=custom\njunit.jupiter.execution.parallel.config.custom.class=com.example.MyParallelStrategy\n"})}),"\n",(0,r.jsx)(n.h2,{id:"controlando-el-paralelismo-a-nivel-de-clasemetodo",children:"Controlando el paralelismo a nivel de clase/metodo"}),"\n",(0,r.jsx)(n.h3,{id:"configuracion-por-clase",children:"Configuracion por clase"}),"\n",(0,r.jsxs)(n.p,{children:["Usa la anotacion ",(0,r.jsx)(n.code,{children:"@Execution"})," para controlar el paralelismo:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"import org.junit.jupiter.api.parallel.Execution;\nimport org.junit.jupiter.api.parallel.ExecutionMode;\n\n@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.CONCURRENT)  // Ejecutar los metodos de esta clase en paralelo\nclass FastTests {\n\n    @Test\n    void test1() { }\n\n    @Test\n    void test2() { }\n\n    @Test\n    void test3() { }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"forzar-ejecucion-secuencial",children:"Forzar ejecucion secuencial"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.SAME_THREAD)  // Ejecutar secuencialmente\nclass DatabaseMigrationTests {\n\n    @Test\n    void migration1() { }\n\n    @Test\n    void migration2() { }  // Debe ejecutarse despues de migration1\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"control-a-nivel-de-metodo",children:"Control a nivel de metodo"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"@ExtendWith(SerenityJUnit5Extension.class)\nclass MixedTests {\n\n    @Test\n    @Execution(ExecutionMode.CONCURRENT)\n    void canRunInParallel() { }\n\n    @Test\n    @Execution(ExecutionMode.SAME_THREAD)\n    void mustRunSequentially() { }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"bloqueos-de-recursos",children:"Bloqueos de recursos"}),"\n",(0,r.jsx)(n.p,{children:"Previene el acceso concurrente a recursos compartidos:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'import org.junit.jupiter.api.parallel.ResourceLock;\n\n@ExtendWith(SerenityJUnit5Extension.class)\nclass SharedResourceTests {\n\n    @Test\n    @ResourceLock("database")\n    void accessDatabase1() {\n        // Acceso exclusivo a la base de datos\n    }\n\n    @Test\n    @ResourceLock("database")\n    void accessDatabase2() {\n        // Esperara a que accessDatabase1 complete\n    }\n\n    @Test\n    @ResourceLock(value = "database", mode = READ)\n    void readFromDatabase() {\n        // Acceso de solo lectura - puede ejecutarse concurrentemente con otras lecturas\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"bloqueos-de-recursos-comunes",children:"Bloqueos de recursos comunes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'import static org.junit.jupiter.api.parallel.Resources.*;\n\n@Test\n@ResourceLock(SYSTEM_PROPERTIES)\nvoid modifiesSystemProperties() { }\n\n@Test\n@ResourceLock(SYSTEM_OUT)\nvoid writesToSystemOut() { }\n\n@Test\n@ResourceLock("my-custom-resource")\nvoid accessesCustomResource() { }\n'})}),"\n",(0,r.jsx)(n.h2,{id:"seguridad-de-hilos-con-serenity",children:"Seguridad de hilos con Serenity"}),"\n",(0,r.jsx)(n.h3,{id:"gestion-de-webdriver",children:"Gestion de WebDriver"}),"\n",(0,r.jsxs)(n.p,{children:["El WebDriver ",(0,r.jsx)(n.code,{children:"@Managed"})," de Serenity es automaticamente seguro para hilos:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.CONCURRENT)\nclass WebTests {\n\n    @Managed(driver = "chrome", options = "headless")\n    WebDriver driver;  // Cada hilo obtiene su propia instancia\n\n    @Test\n    void test1() {\n        driver.get("https://example.com");\n        // Seguro para hilos\n    }\n\n    @Test\n    void test2() {\n        driver.get("https://example.com/other");\n        // Instancia de WebDriver independiente\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"bibliotecas-de-pasos",children:"Bibliotecas de pasos"}),"\n",(0,r.jsx)(n.p,{children:"Las bibliotecas de pasos son seguras para hilos cuando se usan correctamente:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.CONCURRENT)\nclass CheckoutTests {\n\n    @Steps\n    CartSteps cart;  // Seguro para hilos - instancia por hilo\n\n    @Test\n    void addToCart() {\n        cart.addProduct("Product1");\n    }\n\n    @Test\n    void removeFromCart() {\n        cart.addProduct("Product2");\n        cart.removeProduct("Product2");\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"evitar-estado-mutable-compartido",children:"Evitar estado mutable compartido"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// MAL - No es seguro para hilos\n@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.CONCURRENT)\nclass BadTests {\n\n    private String sharedData;  // Estado mutable compartido!\n\n    @Test\n    void test1() {\n        sharedData = "test1";  // Condicion de carrera!\n    }\n\n    @Test\n    void test2() {\n        sharedData = "test2";  // Condicion de carrera!\n    }\n}\n\n// BIEN - Seguro para hilos\n@ExtendWith(SerenityJUnit5Extension.class)\n@Execution(ExecutionMode.CONCURRENT)\nclass GoodTests {\n\n    @Test\n    void test1() {\n        String localData = "test1";  // Variable local - segura para hilos\n        // Usar localData\n    }\n\n    @Test\n    void test2() {\n        String localData = "test2";  // Independiente\n        // Usar localData\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"ejemplo-de-configuracion-completa",children:"Ejemplo de configuracion completa"}),"\n",(0,r.jsx)(n.h3,{id:"junit-platformproperties-completo",children:"junit-platform.properties completo"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# ==========================================\n# Ejecucion paralela\n# ==========================================\njunit.jupiter.execution.parallel.enabled=true\njunit.jupiter.execution.parallel.mode.default=concurrent\njunit.jupiter.execution.parallel.mode.classes.default=concurrent\n\n# ==========================================\n# Estrategia de ejecucion\n# ==========================================\njunit.jupiter.execution.parallel.config.strategy=dynamic\njunit.jupiter.execution.parallel.config.dynamic.factor=1.0\n\n# Alternativa: Estrategia fija\n# junit.jupiter.execution.parallel.config.strategy=fixed\n# junit.jupiter.execution.parallel.config.fixed.parallelism=4\n# junit.jupiter.execution.parallel.config.fixed.max-pool-size=8\n\n# ==========================================\n# Ciclo de vida de instancia de prueba\n# ==========================================\njunit.jupiter.testinstance.lifecycle.default=per_method\n\n# ==========================================\n# Descubrimiento de pruebas\n# ==========================================\njunit.jupiter.testclass.order.default=org.junit.jupiter.api.ClassOrderer$Random\n\n# ==========================================\n# Nombres de visualizacion\n# ==========================================\njunit.jupiter.displayname.generator.default=org.junit.jupiter.api.DisplayNameGenerator$ReplaceUnderscores\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configuracion-de-maven",children:"Configuracion de Maven"}),"\n",(0,r.jsx)(n.h3,{id:"plugin-failsafe",children:"Plugin Failsafe"}),"\n",(0,r.jsx)(n.p,{children:"Configura el plugin Maven Failsafe para la ejecucion paralela:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<plugin>\n    <groupId>org.apache.maven.plugins</groupId>\n    <artifactId>maven-failsafe-plugin</artifactId>\n    <version>3.0.0</version>\n    <configuration>\n        \x3c!-- Habilitar JUnit 5 --\x3e\n        <includes>\n            <include>**/*Test.java</include>\n            <include>**/*Tests.java</include>\n        </includes>\n\n        \x3c!-- Propiedades del sistema --\x3e\n        <systemPropertyVariables>\n            <webdriver.driver>${webdriver.driver}</webdriver.driver>\n            <environment>${environment}</environment>\n        </systemPropertyVariables>\n\n        \x3c!-- Incrementar memoria para ejecucion paralela --\x3e\n        <argLine>-Xmx2g</argLine>\n    </configuration>\n    <executions>\n        <execution>\n            <goals>\n                <goal>integration-test</goal>\n                <goal>verify</goal>\n            </goals>\n        </execution>\n    </executions>\n</plugin>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"ejecutar-desde-la-linea-de-comandos",children:"Ejecutar desde la linea de comandos"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Ejecutar todas las pruebas en paralelo\nmvn clean verify\n\n# Sobrescribir paralelismo\nmvn clean verify -Djunit.jupiter.execution.parallel.config.fixed.parallelism=8\n\n# Deshabilitar ejecucion paralela\nmvn clean verify -Djunit.jupiter.execution.parallel.enabled=false\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configuracion-de-gradle",children:"Configuracion de Gradle"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-groovy",children:"test {\n    useJUnitPlatform()\n\n    // Habilitar ejecucion paralela\n    maxParallelForks = Runtime.runtime.availableProcessors()\n\n    // Incrementar memoria\n    minHeapSize = \"512m\"\n    maxHeapSize = \"2g\"\n\n    // Propiedades del sistema\n    systemProperty 'junit.jupiter.execution.parallel.enabled', 'true'\n    systemProperty 'junit.jupiter.execution.parallel.config.strategy', 'dynamic'\n    systemProperty 'junit.jupiter.execution.parallel.config.dynamic.factor', '1.0'\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"optimizacion-del-rendimiento",children:"Optimizacion del rendimiento"}),"\n",(0,r.jsx)(n.h3,{id:"1-elegir-la-estrategia-correcta",children:"1. Elegir la estrategia correcta"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Suites de pruebas pequenas"})," (<30 pruebas):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"junit.jupiter.execution.parallel.config.strategy=fixed\njunit.jupiter.execution.parallel.config.fixed.parallelism=2\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Suites de pruebas medianas"})," (30-100 pruebas):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"junit.jupiter.execution.parallel.config.strategy=dynamic\njunit.jupiter.execution.parallel.config.dynamic.factor=1.0\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Suites de pruebas grandes"})," (>100 pruebas):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"junit.jupiter.execution.parallel.config.strategy=dynamic\njunit.jupiter.execution.parallel.config.dynamic.factor=0.75\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-monitorear-el-uso-de-recursos",children:"2. Monitorear el uso de recursos"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Monitorear mientras se ejecutan las pruebas\ntop\nhtop\njconsole\n"})}),"\n",(0,r.jsx)(n.p,{children:"Observa:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CPU"}),": Deberia estar cerca del 100% de utilizacion"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Memoria"}),": Cada instancia del navegador usa ~200-500MB de RAM"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Hilos"}),": Deberian coincidir con tu configuracion de paralelismo"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-optimizar-el-diseno-de-pruebas",children:"3. Optimizar el diseno de pruebas"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// BIEN - Pruebas rapidas y enfocadas\n@Test\nvoid shouldCalculateTotal() {\n    // Sin dependencias externas, se ejecuta rapidamente\n    assertThat(calculator.add(2, 3)).isEqualTo(5);\n}\n\n// LENTO - Considerar optimizacion\n@Test\nvoid shouldProcessLargeDataset() {\n    // Procesa 10000 registros - considerar usar un conjunto de datos mas pequeno\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-balancear-el-numero-de-hilos",children:"4. Balancear el numero de hilos"}),"\n",(0,r.jsx)(n.p,{children:"Muy pocos hilos:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# Subutilizando CPU\njunit.jupiter.execution.parallel.config.dynamic.factor=0.25\n"})}),"\n",(0,r.jsx)(n.p,{children:"Demasiados hilos:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# Puede causar agotamiento de recursos\njunit.jupiter.execution.parallel.config.dynamic.factor=4.0\n"})}),"\n",(0,r.jsx)(n.p,{children:"Optimo:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# Coincide con los nucleos de CPU\njunit.jupiter.execution.parallel.config.dynamic.factor=1.0\n"})}),"\n",(0,r.jsx)(n.h2,{id:"depurando-pruebas-paralelas",children:"Depurando pruebas paralelas"}),"\n",(0,r.jsx)(n.h3,{id:"deshabilitar-temporalmente-el-paralelismo",children:"Deshabilitar temporalmente el paralelismo"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"junit.jupiter.execution.parallel.enabled=false\n"})}),"\n",(0,r.jsx)(n.p,{children:"O via linea de comandos:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"mvn verify -Djunit.jupiter.execution.parallel.enabled=false\n"})}),"\n",(0,r.jsx)(n.h3,{id:"ejecutar-una-sola-clase-de-prueba",children:"Ejecutar una sola clase de prueba"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"mvn test -Dtest=MyTestClass\n"})}),"\n",(0,r.jsx)(n.h3,{id:"habilitar-registro-detallado",children:"Habilitar registro detallado"}),"\n",(0,r.jsxs)(n.p,{children:["Agregar a ",(0,r.jsx)(n.code,{children:"junit-platform.properties"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# Mostrar que hilo ejecuta cada prueba\njunit.platform.output.capture.stdout=true\njunit.platform.output.capture.stderr=true\n"})}),"\n",(0,r.jsx)(n.p,{children:"En tu prueba:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@BeforeEach\nvoid logThread() {\n    System.out.println("Running on: " + Thread.currentThread().getName());\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"problemas-comunes-y-soluciones",children:"Problemas comunes y soluciones"}),"\n",(0,r.jsx)(n.h3,{id:"problema-1-pruebas-inestables-flaky",children:"Problema 1: Pruebas inestables (flaky)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Sintomas:"})," Las pruebas pasan individualmente pero fallan en paralelo"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Soluciones:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Verifica si hay estado mutable compartido"}),"\n",(0,r.jsx)(n.li,{children:"Verifica el aislamiento de datos de prueba"}),"\n",(0,r.jsx)(n.li,{children:"Revisa los bloqueos de recursos"}),"\n",(0,r.jsx)(n.li,{children:"Agrega sincronizacion adecuada"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// Problema: Estado compartido\nprivate static int counter = 0;  // No es seguro para hilos\n\n@Test\nvoid incrementCounter() {\n    counter++;  // Condicion de carrera\n}\n\n// Solucion: Usar tipos atomicos o variables locales\nprivate static AtomicInteger counter = new AtomicInteger(0);  // Seguro para hilos\n\n@Test\nvoid incrementCounter() {\n    counter.incrementAndGet();\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"problema-2-agotamiento-de-recursos",children:"Problema 2: Agotamiento de recursos"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Sintomas:"})," Las pruebas se ralentizan o fallan despues de algun tiempo"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Soluciones:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reducir el numero de hilos"}),"\n",(0,r.jsx)(n.li,{children:"Incrementar el tamano del heap de la JVM"}),"\n",(0,r.jsx)(n.li,{children:"Verificar fugas de recursos"}),"\n",(0,r.jsx)(n.li,{children:"Monitorear los recursos del sistema"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"\x3c!-- Incrementar tamano del heap --\x3e\n<argLine>-Xmx4g</argLine>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"problema-3-problemas-con-webdriver",children:"Problema 3: Problemas con WebDriver"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Sintomas:"})," Las instancias del navegador se multiplican o no se cierran"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Soluciones:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Usar WebDriver ",(0,r.jsx)(n.code,{children:"@Managed"})," (Serenity gestiona el ciclo de vida)"]}),"\n",(0,r.jsxs)(n.li,{children:["Asegurar limpieza adecuada en ",(0,r.jsx)(n.code,{children:"@AfterEach"})]}),"\n",(0,r.jsx)(n.li,{children:"Limitar las instancias concurrentes del navegador"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// Serenity gestiona el ciclo de vida\n@Managed\nWebDriver driver;\n\n// No gestionar manualmente en pruebas paralelas\nWebDriver driver = new ChromeDriver();  // Riesgo de fuga de memoria\n"})}),"\n",(0,r.jsx)(n.h3,{id:"problema-4-bloqueos-de-base-de-datos",children:"Problema 4: Bloqueos de base de datos"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Sintomas:"})," Las pruebas agotan el tiempo de espera esperando la base de datos"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Soluciones:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Usar bloqueos de recursos"}),"\n",(0,r.jsx)(n.li,{children:"Aislar los datos de prueba"}),"\n",(0,r.jsx)(n.li,{children:"Usar base de datos en memoria para pruebas"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Test\n@ResourceLock("database")\nvoid modifiesDatabase() {\n    // Acceso exclusivo a la base de datos\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"mejores-practicas",children:"Mejores practicas"}),"\n",(0,r.jsx)(n.h3,{id:"1-empezar-pequeno",children:"1. Empezar pequeno"}),"\n",(0,r.jsx)(n.p,{children:"Comienza con 2-4 hilos e incrementa gradualmente:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"junit.jupiter.execution.parallel.config.strategy=fixed\njunit.jupiter.execution.parallel.config.fixed.parallelism=2\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-aislar-datos-de-prueba",children:"2. Aislar datos de prueba"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@ExtendWith(SerenityJUnit5Extension.class)\nclass UserTests {\n\n    @Test\n    void createUser() {\n        String uniqueId = UUID.randomUUID().toString();\n        User user = createTestUser("user_" + uniqueId);\n        // Prueba con usuario unico\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"3-usar-etiquetas-para-paralelismo-selectivo",children:"3. Usar etiquetas para paralelismo selectivo"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Test\n@Tag("parallel")\nvoid canRunInParallel() { }\n\n@Test\n@Tag("serial")\n@Execution(ExecutionMode.SAME_THREAD)\nvoid mustRunSequentially() { }\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# Ejecutar solo pruebas paralelas\njunit.jupiter.includeTags=parallel\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-limpiar-recursos",children:"4. Limpiar recursos"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"@AfterEach\nvoid cleanup() {\n    // Limpiar datos de prueba\n    testDataService.deleteTestData(testId);\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"5-documentar-la-seguridad-de-hilos",children:"5. Documentar la seguridad de hilos"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"/**\n * Las pruebas en esta clase modifican el estado global de la aplicacion\n * y deben ejecutarse secuencialmente.\n */\n@Execution(ExecutionMode.SAME_THREAD)\nclass GlobalStateTests {\n    // ...\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"midiendo-el-rendimiento",children:"Midiendo el rendimiento"}),"\n",(0,r.jsx)(n.h3,{id:"antes-de-la-ejecucion-paralela",children:"Antes de la ejecucion paralela"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Total de pruebas: 150\nTiempo de ejecucion: 25 minutos\n"})}),"\n",(0,r.jsx)(n.h3,{id:"despues-de-la-ejecucion-paralela-8-hilos",children:"Despues de la ejecucion paralela (8 hilos)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Total de pruebas: 150\nTiempo de ejecucion: 4 minutos\nAceleracion: 6.25x\nEficiencia: 78%\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Calcular metricas:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Aceleracion = Tiempo secuencial / Tiempo paralelo\nEficiencia = Aceleracion / Numero de hilos x 100%\n"})}),"\n",(0,r.jsx)(n.h2,{id:"proximos-pasos",children:"Proximos pasos"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Regresa a la guia principal de ",(0,r.jsx)(n.a,{href:"junit5-tests",children:"JUnit 5"})]}),"\n",(0,r.jsxs)(n.li,{children:["Aprende sobre ",(0,r.jsx)(n.a,{href:"junit5-tests#nombres-de-visualizacion-y-organizacion",children:"Organizacion de pruebas"})]}),"\n",(0,r.jsxs)(n.li,{children:["Revisa las ",(0,r.jsx)(n.a,{href:"junit5-tests#mejores-practicas",children:"Mejores practicas"})]}),"\n",(0,r.jsxs)(n.li,{children:["Explora los ",(0,r.jsx)(n.a,{href:"/docs/reporting/the_serenity_reports",children:"Reportes de Serenity"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"recursos-adicionales",children:"Recursos adicionales"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://junit.org/junit5/docs/current/user-guide/#writing-tests-parallel-execution",children:"Documentacion de ejecucion paralela de JUnit 5"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://serenity-bdd.info",children:"Consejos de rendimiento de Serenity BDD"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://jcip.net/",children:"Java Concurrency in Practice"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);