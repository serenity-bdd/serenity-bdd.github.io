<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Serenity BDD User Manual Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Serenity BDD User Manual Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Serenity BDD User Manual" href="/opensearch.xml"><title data-react-helmet="true">Step Libraries | Serenity BDD User Manual</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://serenity-bdd.github.io/docs/guide/step_libraries"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Step Libraries | Serenity BDD User Manual"><meta data-react-helmet="true" name="description" content="In Serenity, tests are broken down into reusable steps. An important principle behind Serenity is the idea that it is easier to maintain a test that uses several layers of abstraction to hide the complexity behind different parts of a test."><meta data-react-helmet="true" property="og:description" content="In Serenity, tests are broken down into reusable steps. An important principle behind Serenity is the idea that it is easier to maintain a test that uses several layers of abstraction to hide the complexity behind different parts of a test."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://serenity-bdd.github.io/docs/guide/step_libraries"><link data-react-helmet="true" rel="alternate" href="https://serenity-bdd.github.io/docs/guide/step_libraries" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://serenity-bdd.github.io/docs/guide/step_libraries" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://V10PILA8X2-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.2ac391e8.css">
<link rel="preload" href="/assets/js/runtime~main.cbe41caf.js" as="script">
<link rel="preload" href="/assets/js/main.5e51d6ba.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/serenity-bdd-small.png" alt="Serenity BDD Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/serenity-bdd-small.png" alt="Serenity BDD Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Home</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/tutorials/first_test">Tutorials</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/guide/user_guide_intro">User Manual</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://www.serenitydojo.academy/serenity-bdd-support-packages" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Get Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">Learn Serenity BDD</a><ul class="dropdown__menu"><li><a href="https://expansion.serenity-dojo.com/courses/testing-web-applications-with-serenity-bdd" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Serenity BDD Online Training<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://expansion.serenity-dojo.com/courses/testing-web-applications-with-serenity-bdd" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>BDD and Requirements Discovery Training<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.serenity-dojo.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>BDD And Test Automation Coaching<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_NKBi"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Your First Steps with Serenity BDD</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Serenity Fundamentals</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/user_guide_intro">Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/getting_started">Creating A New Project</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/maven">Using Maven with Serenity</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/guide/step_libraries">Step Libraries</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/page_objects">Interacting With Web Pages</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/page_elements">Serenity Page Elements</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/driver_config">Configuring Selenium WebDriver</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/cucumber">Running Cucumber scenarios with Serenity</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">The Screenplay Pattern</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Integrating in Spring</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reporting and Living Documentation</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Scaling Serenity</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Mobile Testing with Serenity</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Serenity Step Libraries</h1></header><p>In Serenity, tests are broken down into reusable steps. An important principle behind Serenity is the idea that it is easier to maintain a test that uses several layers of abstraction to hide the complexity behind different parts of a test.</p><p>In an automated acceptance test, test steps represent the level of abstraction between the code that interacts with your application (for example, Page Component Objects in an automated web test, which model parts of the user interface, or API endpoints for web services you need to interact with) and higher-level stories (sequences of more business-focused actions that illustrate how a given user story has been implemented). If your automated test is not UI-oriented (for example, if it calls a web service), steps orchestrate other more technical components such as REST clients. Steps can contain other steps, and are included in the Serenity reports. Whenever a UI step is executed, a screenshot is stored and displayed in the report.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="breaking-down-tests-into-steps"></a>Breaking down tests into steps<a class="hash-link" href="#breaking-down-tests-into-steps" title="Direct link to heading">#</a></h2><p>Suppose we are testing a Frequent Flyer programme, and need to illustrate the following business rules:</p><ul><li>Members should start with Bronze status</li><li>Members should earn Silver status after flying 10,000 km.</li></ul><p>Each of these can be broken down further into business tasks and verifications. For example, the first rule could be broken into two steps:</p><ul><li>Create a new Frequent Flyer member</li><li>Check that the member has a status of Bronze</li></ul><p>And the second can be broken into three steps:</p><ul><li>Create a new Frequent Flyer member</li><li>Make the member fly 10000 km</li><li>Check that the member has a status of Silver</li></ul><p>We could express these tests using Serenity in JUnit as follows:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">package flyer;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import net.serenitybdd.junit.runners.SerenityRunner;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import net.thucydides.core.annotations.Steps;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.junit.Test;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.junit.runner.RunWith;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import flyer.steps.TravellerEarningStatusPoints;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import static flyer.Status.Bronze;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import static flyer.Status.Silver;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@ExtendWith(SerenityJUnit5Extension.class)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WhenEarningFrequentFlyerPoints {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Steps</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    TravellerEarningStatusPoints tracy;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void members_should_start_with_Bronze_status() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // GIVEN</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        tracy.joins_the_frequent_flyer_program();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // THEN</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        tracy.should_have_a_status_of(Bronze);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void earn_silver_after_10000_kilometers() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // GIVEN</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        tracy.joins_the_frequent_flyer_program();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // WHEN</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        tracy.flies(10000);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // THEN</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        tracy.should_have_a_status_of(Silver);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Notice how the second test reuses step methods used in the first to perform a slightly different test. This is a typical example of the way we reuse steps in similar tests, in order to avoid duplicated code and make the code easier to maintain.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="implementing-simple-step-libraries"></a>Implementing Simple Step Libraries<a class="hash-link" href="#implementing-simple-step-libraries" title="Direct link to heading">#</a></h2><p>The <code>TravellerEarningStatusPoints</code> class is what we call a step library. We use the <code>@Steps</code> class as shown above to indicate a step library in our test code: this annotation tells Serenity to instantiate and instrument this field, so that methods you call in this library also appear in the test reports.</p><p>Step libraries contain the business tasks or actions that a user performs during a test. There are many ways to organise your step libraries, but a convenient way is to group methods in slices of business behaviour for a given type of user. In this case a traveller who is earning status points.</p><p>Notice that it was not necessary to explicitly instantiate the Steps class <code>TravellerEarningStatusPoints</code>. When you annotated a member variable of this class with the <code>@Steps</code> annotation, Serenity BDD will automatically instantiate it for you.</p><p>You should never create instances of step libraries using the <code>new</code> keyword, as Serenity will not be able to instrument the step library correctly, and the methods called will not appear in the reports.</p><p>For example, suppose we want to test a simple calculator UI. In this class, we use the <code>CalculatorSteps</code> step library, which we annotate with the <code>@Steps</code> annotation:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">@ExtendWith(SerenityJUnit5Extension.class)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">class WhenDoingSums {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Steps</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    CalculatorSteps calulate;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Nested</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    class ABasicCalculator {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        @BeforeEach</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        void openTheCalculator() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            calulate.openTheCalculatorApp();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Test</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        void shouldCalculateAdditions() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            int result = calulate.theAnswerTo(&quot;1&quot;,&quot;+&quot;,&quot;2&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            assertThat(result).isEqualTo(3);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Test</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        void shouldCalculateSubtractions() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            int result = calulate.theAnswerTo(&quot;7&quot;,&quot;-&quot;,&quot;3&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            assertThat(result).isEqualTo(4);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Test</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        void shouldCalculateMultiplications() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            int result = calulate.theAnswerTo(&quot;3&quot;,&quot;*&quot;,&quot;2&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            assertThat(result).isEqualTo(6);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Test</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        void shouldCalculateDivisions() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            int result = calulate.theAnswerTo(&quot;10&quot;,&quot;/&quot;,&quot;2&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            assertThat(result).isEqualTo(5);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <code>CalculatorSteps</code> class defines the steps a user needs to perform - in this case, perform a calculation on the calculator app:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">public class CalculatorSteps {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Step(&quot;Calculate the answer to {0} {1} {2}&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int theAnswerTo(String a, String operator, String b) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Interact with the the calculator to perform the calculation</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Step methods are annotated with the <code>@Step</code> annotation, which tells Serenity to include this method in the Serenity test reports. The value we include in the <code>@Step</code> annotation is the text that will appear in the Serenity reports when this step is executed. The numbers in curly brackets (<code>{0}</code>,<code>{1}</code> and <code>{2}</code>) represent placeholders the method parameters, if we want them to appear in the reports.</p><p>When we run this test case, Serenity will document the steps that get executed during each test, producing a living documentation of the test execution:</p><p><img src="/assets/images/calculator-steps-5da4a36b105ab6c58ccc74f377dab106.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="ui-interaction-classes"></a>UI Interaction Classes<a class="hash-link" href="#ui-interaction-classes" title="Direct link to heading">#</a></h3><p>Suppose our calculator test needs to interact with a web UI, such as the one on <a href="https://juliemr.github.io/protractor-demo/" target="_blank" rel="noopener noreferrer">https://juliemr.github.io/protractor-demo/</a> shown here:</p><p><img src="/assets/images/calculator-app-15faebe39eed240aa4b761e9f492c763.png"></p><p>We can access the powerful Serenity BDD Selenium integration in our step libraries by extending the <code>net.serenitybdd.core.steps.UIInteractions</code> class. A very simple implementation might look like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">public class CalculatorSteps extends UIInteractions {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     @Step</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void openTheCalculatorApp() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        openUrl(&quot;https://juliemr.github.io/protractor-demo/&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   @Step(&quot;Calculate the answer to {0} {1} {2}&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int theAnswerTo(String firstValue, String operator, String secondValue) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        $(&quot;[ng-model=first]&quot;).sendKeys(firstValue);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        $(&quot;[ng-model=operator]&quot;).selectByVisibleText(operator);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        $(&quot;[ng-model=second]&quot;).sendKeys(secondValue);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        $(&quot;#gobutton&quot;).click();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        waitForAngularRequestsToFinish();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Integer.parseInt($(&quot;css:h2&quot;).getText());</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>A more readable, refactored implementation might look like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">public class CalculatorSteps extends UIInteractions {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final By FIRST_VALUE_FIELD = By.cssSelector(&quot;[ng-model=first]&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final By SECOND_VALUE_FIELD = By.cssSelector(&quot;[ng-model=second]&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final By OPERATOR_DROPDOWN = By.cssSelector(&quot;[ng-model=operator]&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final By GO_BUTTON = By.id(&quot;gobutton&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final By RESULT_FIELD = By.tagName(&quot;h2&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final Pattern A_VALID_NUMBER = Pattern.compile(&quot;-?\\d\\.?d*&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Step</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void openTheCalculatorApp() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        openUrl(&quot;https://juliemr.github.io/protractor-demo/&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Step(&quot;Calculate the answer to {0} {1} {2}&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int theAnswerTo(String firstValue, String operator, String secondValue) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        $(FIRST_VALUE_FIELD).sendKeys(firstValue);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        $(OPERATOR_DROPDOWN).selectByVisibleText(operator);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        $(SECOND_VALUE_FIELD).sendKeys(secondValue);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        $(GO_BUTTON).click();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        waitFor(ExpectedConditions.textMatches(RESULT_FIELD,A_VALID_NUMBER));</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Integer.parseInt($(RESULT_FIELD).getText());</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The tests will now interact with the user interface, report on both the steps executed, and (if configured to do so) record screenshots for each step:</p><p><img src="/assets/images/calculator-step-screenshots-f155907793e985d481afe765cc342085.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="persona-step-libraries"></a>Persona Step Libraries<a class="hash-link" href="#persona-step-libraries" title="Direct link to heading">#</a></h3><p>Another approach to modeling step libraries revolves around actors and roles. Let&#x27;s return to our original example: Tracy, the traveller, who earns points when she travels.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">public class TravellerEarningStatusPoints {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String actor;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private FrequentFlyer frequentFlyer;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Step(&quot;#actor joins the frequent flyer program&quot;)   </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void joins_the_frequent_flyer_program() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        frequentFlyer = FrequentFlyer.withInitialBalanceOf(0);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Step(&quot;#actor flies {0} km&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void flies(int distance) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        frequentFlyer.recordFlightDistanceInKilometers(distance);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Step(&quot;#actor should have a status of {0}&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void should_have_a_status_of(Status expectedStatus) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertThat(frequentFlyer.getStatus()).isEqualTo(expectedStatus);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Step(&quot;#actor transfers {0} points to {1}&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void transfers_points(int points, TravellerEarningStatusPoints otherFrequentFlier) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Left as an exercise</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String toString() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return actor;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Step(&quot;#actor should have {0} points&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void should_have_points(int expectedPoints) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Left as an exercise</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This approach uses the concept of <em>persona</em> step libraries, where a step library represents the actions of a specific user performing a specific task (Tracy the traveller who is earning points.) In this case, Serenity will automatically instantiate the <em>actor</em> field with the name of the step library variable (<code>tracy</code>), allowing it to appear in the test reports to make them more readable:</p><p><img src="/assets/images/persona-steps-e3e5d126e535bceb61d05022b43ca6a7.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="shared-instances-of-step-libraries"></a>Shared Instances of Step Libraries<a class="hash-link" href="#shared-instances-of-step-libraries" title="Direct link to heading">#</a></h2><p>There are some cases where we want to reuse the same step library instance in different places across a test. For example, suppose we have a step library that interacts with a backend API, and that maintains some internal state and caching to improve performance. We might want to reuse a single instance of this step library, rather than having a separate instance for each variable.</p><p>We can do this by declaring the step library to be shared, like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">@Steps(shared = true)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CustomerAPIStepLibrary customerAPI;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Now, any other step libraries of type <code>CustomerAPIStepLibrary</code>, that have the shared attribute set to true will refer to the same instance.</p><p>In older versions of Serenity, sharing instances was the default behaviour, and you used the uniqueInstance attribute to indicate that a step library should not be shared. If you need to force this behaviour for legacy test suites, set the step.creation.strategy property to legacy in your serenity.properties file:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">step</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">creation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">strategy</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> legacy</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/serenity-bdd/serenity-bdd.github.io/blob/master/docs/guide/steps.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/guide/maven"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Using Maven with Serenity</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/guide/page_objects"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Interacting With Web Pages Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#breaking-down-tests-into-steps" class="table-of-contents__link">Breaking down tests into steps</a></li><li><a href="#implementing-simple-step-libraries" class="table-of-contents__link">Implementing Simple Step Libraries</a><ul><li><a href="#ui-interaction-classes" class="table-of-contents__link">UI Interaction Classes</a></li><li><a href="#persona-step-libraries" class="table-of-contents__link">Persona Step Libraries</a></li></ul></li><li><a href="#shared-instances-of-step-libraries" class="table-of-contents__link">Shared Instances of Step Libraries</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials/first_test">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://gitter.im/serenity-bdd/serenity-core" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Gitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/serenity-bdd" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Learn Serenity BDD</div><ul class="footer__items"><li class="footer__item"><a href="http://expansion.serenity-dojo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>The Serenity Dojo Training Library<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.serenity-dojo.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Personalised Serenity BDD Coaching<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/serenity-bdd/serenity-core" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 Serenity Dojo Ltd.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.cbe41caf.js"></script>
<script src="/assets/js/main.5e51d6ba.js"></script>
</body>
</html>